
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../Settings/">
      
      
        <link rel="next" href="../PayloadTypes/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.18">
    
    
      
        <title>Objects - Elysia API</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
      
        <meta  property="og:type"  content="website" >
      
        <meta  property="og:title"  content="Objects - Elysia API" >
      
        <meta  property="og:description"  content="None" >
      
        <meta  property="og:image"  content="./assets/images/social/Reference/Objects.png" >
      
        <meta  property="og:image:type"  content="image/png" >
      
        <meta  property="og:image:width"  content="1200" >
      
        <meta  property="og:image:height"  content="630" >
      
        <meta  property="og:url"  content="None" >
      
        <meta  name="twitter:card"  content="summary_large_image" >
      
        <meta  name="twitter:title"  content="Objects - Elysia API" >
      
        <meta  name="twitter:description"  content="None" >
      
        <meta  name="twitter:image"  content="./assets/images/social/Reference/Objects.png" >
      
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="purple">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#elysia.objects" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Elysia API" class="md-header__button md-logo" aria-label="Elysia API" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Elysia API
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Objects
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="purple"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="lime"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Getting Started

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../setting_up/" class="md-tabs__link">
        
  
  
    
  
  Setting Up

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../basic/" class="md-tabs__link">
        
  
  
    
  
  Basic Usage

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../advanced_usage/" class="md-tabs__link">
        
  
  
    
  
  Customising Elysia

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../creating_tools/" class="md-tabs__link">
        
  
  
    
  
  Creating a Tool

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../Advanced/" class="md-tabs__link">
          
  
  
  Advanced

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../API/" class="md-tabs__link">
          
  
  
  API

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../Examples/" class="md-tabs__link">
          
  
  
  Examples

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../Preprocessor/" class="md-tabs__link">
          
  
  
  Reference

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Elysia API" class="md-nav__button md-logo" aria-label="Elysia API" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Elysia API
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../setting_up/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Setting Up
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Basic Usage
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../advanced_usage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Customising Elysia
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../creating_tools/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Creating a Tool
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Advanced
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Advanced
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Advanced/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Advanced/technical_overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Technical Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Advanced/advanced_tool_construction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tool Construction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Advanced/custom_objects/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Custom Objects
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Advanced/environment/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Environment
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    API
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../API/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../API/user_and_tree_managers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    User Management
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../API/payload_formats/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Payload Formats
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Examples
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Examples/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Index
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Examples/query_weaviate/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Querying Weaviate
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Examples/data_analysis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Basic Linear Regression
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" checked>
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Preprocessor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Preprocessor
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Tree/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tree
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Client/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    WeaviateClient
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Managers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Managers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Settings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Settings
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Objects
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Objects
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#elysia.objects" class="md-nav__link">
    <span class="md-ellipsis">
      objects
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#elysia.objects.Completed" class="md-nav__link">
    <span class="md-ellipsis">
      Completed
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#elysia.objects.Error" class="md-nav__link">
    <span class="md-ellipsis">
      Error
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Error">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#elysia.objects.Error.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#elysia.objects.Result" class="md-nav__link">
    <span class="md-ellipsis">
      Result
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Result">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#elysia.objects.Result.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#elysia.objects.Result.format_llm_message" class="md-nav__link">
    <span class="md-ellipsis">
      format_llm_message
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#elysia.objects.Result.llm_parse" class="md-nav__link">
    <span class="md-ellipsis">
      llm_parse
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#elysia.objects.Result.to_frontend" class="md-nav__link">
    <span class="md-ellipsis">
      to_frontend
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#elysia.objects.Result.to_json" class="md-nav__link">
    <span class="md-ellipsis">
      to_json
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#elysia.objects.Retrieval" class="md-nav__link">
    <span class="md-ellipsis">
      Retrieval
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#elysia.objects.Return" class="md-nav__link">
    <span class="md-ellipsis">
      Return
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#elysia.objects.Status" class="md-nav__link">
    <span class="md-ellipsis">
      Status
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#elysia.objects.Text" class="md-nav__link">
    <span class="md-ellipsis">
      Text
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#elysia.objects.Tool" class="md-nav__link">
    <span class="md-ellipsis">
      Tool
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Tool">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#elysia.objects.Tool.__call__" class="md-nav__link">
    <span class="md-ellipsis">
      __call__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#elysia.objects.Tool.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#elysia.objects.Tool.get_metadata" class="md-nav__link">
    <span class="md-ellipsis">
      get_metadata
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#elysia.objects.Tool.is_tool_available" class="md-nav__link">
    <span class="md-ellipsis">
      is_tool_available
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#elysia.objects.Tool.run_if_true" class="md-nav__link">
    <span class="md-ellipsis">
      run_if_true
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#elysia.objects.ToolMeta" class="md-nav__link">
    <span class="md-ellipsis">
      ToolMeta
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#elysia.objects.Update" class="md-nav__link">
    <span class="md-ellipsis">
      Update
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#elysia.objects.Warning" class="md-nav__link">
    <span class="md-ellipsis">
      Warning
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#elysia.objects.tool" class="md-nav__link">
    <span class="md-ellipsis">
      tool
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#elysia.tree.objects" class="md-nav__link">
    <span class="md-ellipsis">
      objects
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#elysia.tree.objects.CollectionData" class="md-nav__link">
    <span class="md-ellipsis">
      CollectionData
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#elysia.tree.objects.Environment" class="md-nav__link">
    <span class="md-ellipsis">
      Environment
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Environment">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#elysia.tree.objects.Environment.add" class="md-nav__link">
    <span class="md-ellipsis">
      add
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#elysia.tree.objects.Environment.add_objects" class="md-nav__link">
    <span class="md-ellipsis">
      add_objects
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#elysia.tree.objects.Environment.find" class="md-nav__link">
    <span class="md-ellipsis">
      find
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#elysia.tree.objects.Environment.is_empty" class="md-nav__link">
    <span class="md-ellipsis">
      is_empty
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#elysia.tree.objects.Environment.remove" class="md-nav__link">
    <span class="md-ellipsis">
      remove
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#elysia.tree.objects.Environment.replace" class="md-nav__link">
    <span class="md-ellipsis">
      replace
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#elysia.tree.objects.Environment.to_json" class="md-nav__link">
    <span class="md-ellipsis">
      to_json
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#elysia.tree.objects.TreeData" class="md-nav__link">
    <span class="md-ellipsis">
      TreeData
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TreeData">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#elysia.tree.objects.TreeData.output_collection_metadata" class="md-nav__link">
    <span class="md-ellipsis">
      output_collection_metadata
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#elysia.tree.objects.TreeData.output_collection_return_types" class="md-nav__link">
    <span class="md-ellipsis">
      output_collection_return_types
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#elysia.tree.objects.TreeData.tasks_completed_string" class="md-nav__link">
    <span class="md-ellipsis">
      tasks_completed_string
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../PayloadTypes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Payload Types
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Util/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Util
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



  <h1>Objects</h1>

<div class="doc doc-object doc-module">



<a id="elysia.objects"></a>
    <div class="doc doc-contents first">










  <div class="doc doc-children">









<div class="doc doc-object doc-class">



<h2 id="elysia.objects.Completed" class="doc doc-heading">
            <code>Completed</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="Update (elysia.objects.Update)" href="#elysia.objects.Update">Update</a></code></p>


        <p>Completed message to be sent to the frontend (tree is complete all recursions).</p>








              <details class="quote">
                <summary>Source code in <code>elysia/objects.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-597">597</a></span>
<span class="normal"><a href="#__codelineno-0-598">598</a></span>
<span class="normal"><a href="#__codelineno-0-599">599</a></span>
<span class="normal"><a href="#__codelineno-0-600">600</a></span>
<span class="normal"><a href="#__codelineno-0-601">601</a></span>
<span class="normal"><a href="#__codelineno-0-602">602</a></span>
<span class="normal"><a href="#__codelineno-0-603">603</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-597" name="__codelineno-0-597"></a><span class="k">class</span><span class="w"> </span><span class="nc">Completed</span><span class="p">(</span><span class="n">Update</span><span class="p">):</span>
<a id="__codelineno-0-598" name="__codelineno-0-598"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-599" name="__codelineno-0-599"></a><span class="sd">    Completed message to be sent to the frontend (tree is complete all recursions).</span>
<a id="__codelineno-0-600" name="__codelineno-0-600"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-601" name="__codelineno-0-601"></a>
<a id="__codelineno-0-602" name="__codelineno-0-602"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-603" name="__codelineno-0-603"></a>        <span class="n">Update</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;completed&quot;</span><span class="p">,</span> <span class="p">{})</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="elysia.objects.Error" class="doc doc-heading">
            <code>Error</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="Update (elysia.objects.Update)" href="#elysia.objects.Update">Update</a></code></p>


        <p>Error objects are used to communicate errors to the decision agent/tool calls.
When yielded, Error objects are automatically saved inside the TreeData object.
When calling the same tool again, the saved Error object is automatically loaded into any tool calls made with the same tool name.
All errors are shown to the decision agent to help decide whether the tool should be called again (retried), or a different tool should be called.</p>








              <details class="quote">
                <summary>Source code in <code>elysia/objects.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-914">914</a></span>
<span class="normal"><a href="#__codelineno-0-915">915</a></span>
<span class="normal"><a href="#__codelineno-0-916">916</a></span>
<span class="normal"><a href="#__codelineno-0-917">917</a></span>
<span class="normal"><a href="#__codelineno-0-918">918</a></span>
<span class="normal"><a href="#__codelineno-0-919">919</a></span>
<span class="normal"><a href="#__codelineno-0-920">920</a></span>
<span class="normal"><a href="#__codelineno-0-921">921</a></span>
<span class="normal"><a href="#__codelineno-0-922">922</a></span>
<span class="normal"><a href="#__codelineno-0-923">923</a></span>
<span class="normal"><a href="#__codelineno-0-924">924</a></span>
<span class="normal"><a href="#__codelineno-0-925">925</a></span>
<span class="normal"><a href="#__codelineno-0-926">926</a></span>
<span class="normal"><a href="#__codelineno-0-927">927</a></span>
<span class="normal"><a href="#__codelineno-0-928">928</a></span>
<span class="normal"><a href="#__codelineno-0-929">929</a></span>
<span class="normal"><a href="#__codelineno-0-930">930</a></span>
<span class="normal"><a href="#__codelineno-0-931">931</a></span>
<span class="normal"><a href="#__codelineno-0-932">932</a></span>
<span class="normal"><a href="#__codelineno-0-933">933</a></span>
<span class="normal"><a href="#__codelineno-0-934">934</a></span>
<span class="normal"><a href="#__codelineno-0-935">935</a></span>
<span class="normal"><a href="#__codelineno-0-936">936</a></span>
<span class="normal"><a href="#__codelineno-0-937">937</a></span>
<span class="normal"><a href="#__codelineno-0-938">938</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-914" name="__codelineno-0-914"></a><span class="k">class</span><span class="w"> </span><span class="nc">Error</span><span class="p">(</span><span class="n">Update</span><span class="p">):</span>
<a id="__codelineno-0-915" name="__codelineno-0-915"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-916" name="__codelineno-0-916"></a><span class="sd">    Error objects are used to communicate errors to the decision agent/tool calls.</span>
<a id="__codelineno-0-917" name="__codelineno-0-917"></a><span class="sd">    When yielded, Error objects are automatically saved inside the TreeData object.</span>
<a id="__codelineno-0-918" name="__codelineno-0-918"></a><span class="sd">    When calling the same tool again, the saved Error object is automatically loaded into any tool calls made with the same tool name.</span>
<a id="__codelineno-0-919" name="__codelineno-0-919"></a><span class="sd">    All errors are shown to the decision agent to help decide whether the tool should be called again (retried), or a different tool should be called.</span>
<a id="__codelineno-0-920" name="__codelineno-0-920"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-921" name="__codelineno-0-921"></a>
<a id="__codelineno-0-922" name="__codelineno-0-922"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">feedback</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">error_message</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
<a id="__codelineno-0-923" name="__codelineno-0-923"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-924" name="__codelineno-0-924"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-925" name="__codelineno-0-925"></a><span class="sd">            feedback (str): The feedback to display to the decision agent.</span>
<a id="__codelineno-0-926" name="__codelineno-0-926"></a><span class="sd">                Usually this will be the error message, but it could be formatted more specifically.</span>
<a id="__codelineno-0-927" name="__codelineno-0-927"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-928" name="__codelineno-0-928"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">feedback</span> <span class="o">=</span> <span class="n">feedback</span>
<a id="__codelineno-0-929" name="__codelineno-0-929"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">error_message</span> <span class="o">=</span> <span class="n">error_message</span>
<a id="__codelineno-0-930" name="__codelineno-0-930"></a>
<a id="__codelineno-0-931" name="__codelineno-0-931"></a>        <span class="k">if</span> <span class="n">feedback</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
<a id="__codelineno-0-932" name="__codelineno-0-932"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">feedback</span> <span class="o">=</span> <span class="s2">&quot;An unknown issue occurred.&quot;</span>
<a id="__codelineno-0-933" name="__codelineno-0-933"></a>
<a id="__codelineno-0-934" name="__codelineno-0-934"></a>        <span class="n">Update</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-935" name="__codelineno-0-935"></a>            <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-936" name="__codelineno-0-936"></a>            <span class="s2">&quot;self_healing_error&quot;</span><span class="p">,</span>
<a id="__codelineno-0-937" name="__codelineno-0-937"></a>            <span class="p">{</span><span class="s2">&quot;feedback&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">feedback</span><span class="p">,</span> <span class="s2">&quot;error_message&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">error_message</span><span class="p">},</span>
<a id="__codelineno-0-938" name="__codelineno-0-938"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="elysia.objects.Error.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">feedback</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">error_message</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">



<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>feedback</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The feedback to display to the decision agent.
Usually this will be the error message, but it could be formatted more specifically.</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>elysia/objects.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-922">922</a></span>
<span class="normal"><a href="#__codelineno-0-923">923</a></span>
<span class="normal"><a href="#__codelineno-0-924">924</a></span>
<span class="normal"><a href="#__codelineno-0-925">925</a></span>
<span class="normal"><a href="#__codelineno-0-926">926</a></span>
<span class="normal"><a href="#__codelineno-0-927">927</a></span>
<span class="normal"><a href="#__codelineno-0-928">928</a></span>
<span class="normal"><a href="#__codelineno-0-929">929</a></span>
<span class="normal"><a href="#__codelineno-0-930">930</a></span>
<span class="normal"><a href="#__codelineno-0-931">931</a></span>
<span class="normal"><a href="#__codelineno-0-932">932</a></span>
<span class="normal"><a href="#__codelineno-0-933">933</a></span>
<span class="normal"><a href="#__codelineno-0-934">934</a></span>
<span class="normal"><a href="#__codelineno-0-935">935</a></span>
<span class="normal"><a href="#__codelineno-0-936">936</a></span>
<span class="normal"><a href="#__codelineno-0-937">937</a></span>
<span class="normal"><a href="#__codelineno-0-938">938</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-922" name="__codelineno-0-922"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">feedback</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">error_message</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
<a id="__codelineno-0-923" name="__codelineno-0-923"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-924" name="__codelineno-0-924"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-925" name="__codelineno-0-925"></a><span class="sd">        feedback (str): The feedback to display to the decision agent.</span>
<a id="__codelineno-0-926" name="__codelineno-0-926"></a><span class="sd">            Usually this will be the error message, but it could be formatted more specifically.</span>
<a id="__codelineno-0-927" name="__codelineno-0-927"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-928" name="__codelineno-0-928"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">feedback</span> <span class="o">=</span> <span class="n">feedback</span>
<a id="__codelineno-0-929" name="__codelineno-0-929"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">error_message</span> <span class="o">=</span> <span class="n">error_message</span>
<a id="__codelineno-0-930" name="__codelineno-0-930"></a>
<a id="__codelineno-0-931" name="__codelineno-0-931"></a>    <span class="k">if</span> <span class="n">feedback</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
<a id="__codelineno-0-932" name="__codelineno-0-932"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">feedback</span> <span class="o">=</span> <span class="s2">&quot;An unknown issue occurred.&quot;</span>
<a id="__codelineno-0-933" name="__codelineno-0-933"></a>
<a id="__codelineno-0-934" name="__codelineno-0-934"></a>    <span class="n">Update</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-935" name="__codelineno-0-935"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-936" name="__codelineno-0-936"></a>        <span class="s2">&quot;self_healing_error&quot;</span><span class="p">,</span>
<a id="__codelineno-0-937" name="__codelineno-0-937"></a>        <span class="p">{</span><span class="s2">&quot;feedback&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">feedback</span><span class="p">,</span> <span class="s2">&quot;error_message&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">error_message</span><span class="p">},</span>
<a id="__codelineno-0-938" name="__codelineno-0-938"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="elysia.objects.Result" class="doc doc-heading">
            <code>Result</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="Return (elysia.objects.Return)" href="#elysia.objects.Return">Return</a></code></p>


        <p>Result objects are returned to the frontend.
These are displayed on the frontend.
E.g. a table, a chart, a text response, etc.</p>
<p>You can yield a <code>Result</code> directly, and specify the <code>type</code> and <code>name</code> of the result.</p>








              <details class="quote">
                <summary>Source code in <code>elysia/objects.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-606">606</a></span>
<span class="normal"><a href="#__codelineno-0-607">607</a></span>
<span class="normal"><a href="#__codelineno-0-608">608</a></span>
<span class="normal"><a href="#__codelineno-0-609">609</a></span>
<span class="normal"><a href="#__codelineno-0-610">610</a></span>
<span class="normal"><a href="#__codelineno-0-611">611</a></span>
<span class="normal"><a href="#__codelineno-0-612">612</a></span>
<span class="normal"><a href="#__codelineno-0-613">613</a></span>
<span class="normal"><a href="#__codelineno-0-614">614</a></span>
<span class="normal"><a href="#__codelineno-0-615">615</a></span>
<span class="normal"><a href="#__codelineno-0-616">616</a></span>
<span class="normal"><a href="#__codelineno-0-617">617</a></span>
<span class="normal"><a href="#__codelineno-0-618">618</a></span>
<span class="normal"><a href="#__codelineno-0-619">619</a></span>
<span class="normal"><a href="#__codelineno-0-620">620</a></span>
<span class="normal"><a href="#__codelineno-0-621">621</a></span>
<span class="normal"><a href="#__codelineno-0-622">622</a></span>
<span class="normal"><a href="#__codelineno-0-623">623</a></span>
<span class="normal"><a href="#__codelineno-0-624">624</a></span>
<span class="normal"><a href="#__codelineno-0-625">625</a></span>
<span class="normal"><a href="#__codelineno-0-626">626</a></span>
<span class="normal"><a href="#__codelineno-0-627">627</a></span>
<span class="normal"><a href="#__codelineno-0-628">628</a></span>
<span class="normal"><a href="#__codelineno-0-629">629</a></span>
<span class="normal"><a href="#__codelineno-0-630">630</a></span>
<span class="normal"><a href="#__codelineno-0-631">631</a></span>
<span class="normal"><a href="#__codelineno-0-632">632</a></span>
<span class="normal"><a href="#__codelineno-0-633">633</a></span>
<span class="normal"><a href="#__codelineno-0-634">634</a></span>
<span class="normal"><a href="#__codelineno-0-635">635</a></span>
<span class="normal"><a href="#__codelineno-0-636">636</a></span>
<span class="normal"><a href="#__codelineno-0-637">637</a></span>
<span class="normal"><a href="#__codelineno-0-638">638</a></span>
<span class="normal"><a href="#__codelineno-0-639">639</a></span>
<span class="normal"><a href="#__codelineno-0-640">640</a></span>
<span class="normal"><a href="#__codelineno-0-641">641</a></span>
<span class="normal"><a href="#__codelineno-0-642">642</a></span>
<span class="normal"><a href="#__codelineno-0-643">643</a></span>
<span class="normal"><a href="#__codelineno-0-644">644</a></span>
<span class="normal"><a href="#__codelineno-0-645">645</a></span>
<span class="normal"><a href="#__codelineno-0-646">646</a></span>
<span class="normal"><a href="#__codelineno-0-647">647</a></span>
<span class="normal"><a href="#__codelineno-0-648">648</a></span>
<span class="normal"><a href="#__codelineno-0-649">649</a></span>
<span class="normal"><a href="#__codelineno-0-650">650</a></span>
<span class="normal"><a href="#__codelineno-0-651">651</a></span>
<span class="normal"><a href="#__codelineno-0-652">652</a></span>
<span class="normal"><a href="#__codelineno-0-653">653</a></span>
<span class="normal"><a href="#__codelineno-0-654">654</a></span>
<span class="normal"><a href="#__codelineno-0-655">655</a></span>
<span class="normal"><a href="#__codelineno-0-656">656</a></span>
<span class="normal"><a href="#__codelineno-0-657">657</a></span>
<span class="normal"><a href="#__codelineno-0-658">658</a></span>
<span class="normal"><a href="#__codelineno-0-659">659</a></span>
<span class="normal"><a href="#__codelineno-0-660">660</a></span>
<span class="normal"><a href="#__codelineno-0-661">661</a></span>
<span class="normal"><a href="#__codelineno-0-662">662</a></span>
<span class="normal"><a href="#__codelineno-0-663">663</a></span>
<span class="normal"><a href="#__codelineno-0-664">664</a></span>
<span class="normal"><a href="#__codelineno-0-665">665</a></span>
<span class="normal"><a href="#__codelineno-0-666">666</a></span>
<span class="normal"><a href="#__codelineno-0-667">667</a></span>
<span class="normal"><a href="#__codelineno-0-668">668</a></span>
<span class="normal"><a href="#__codelineno-0-669">669</a></span>
<span class="normal"><a href="#__codelineno-0-670">670</a></span>
<span class="normal"><a href="#__codelineno-0-671">671</a></span>
<span class="normal"><a href="#__codelineno-0-672">672</a></span>
<span class="normal"><a href="#__codelineno-0-673">673</a></span>
<span class="normal"><a href="#__codelineno-0-674">674</a></span>
<span class="normal"><a href="#__codelineno-0-675">675</a></span>
<span class="normal"><a href="#__codelineno-0-676">676</a></span>
<span class="normal"><a href="#__codelineno-0-677">677</a></span>
<span class="normal"><a href="#__codelineno-0-678">678</a></span>
<span class="normal"><a href="#__codelineno-0-679">679</a></span>
<span class="normal"><a href="#__codelineno-0-680">680</a></span>
<span class="normal"><a href="#__codelineno-0-681">681</a></span>
<span class="normal"><a href="#__codelineno-0-682">682</a></span>
<span class="normal"><a href="#__codelineno-0-683">683</a></span>
<span class="normal"><a href="#__codelineno-0-684">684</a></span>
<span class="normal"><a href="#__codelineno-0-685">685</a></span>
<span class="normal"><a href="#__codelineno-0-686">686</a></span>
<span class="normal"><a href="#__codelineno-0-687">687</a></span>
<span class="normal"><a href="#__codelineno-0-688">688</a></span>
<span class="normal"><a href="#__codelineno-0-689">689</a></span>
<span class="normal"><a href="#__codelineno-0-690">690</a></span>
<span class="normal"><a href="#__codelineno-0-691">691</a></span>
<span class="normal"><a href="#__codelineno-0-692">692</a></span>
<span class="normal"><a href="#__codelineno-0-693">693</a></span>
<span class="normal"><a href="#__codelineno-0-694">694</a></span>
<span class="normal"><a href="#__codelineno-0-695">695</a></span>
<span class="normal"><a href="#__codelineno-0-696">696</a></span>
<span class="normal"><a href="#__codelineno-0-697">697</a></span>
<span class="normal"><a href="#__codelineno-0-698">698</a></span>
<span class="normal"><a href="#__codelineno-0-699">699</a></span>
<span class="normal"><a href="#__codelineno-0-700">700</a></span>
<span class="normal"><a href="#__codelineno-0-701">701</a></span>
<span class="normal"><a href="#__codelineno-0-702">702</a></span>
<span class="normal"><a href="#__codelineno-0-703">703</a></span>
<span class="normal"><a href="#__codelineno-0-704">704</a></span>
<span class="normal"><a href="#__codelineno-0-705">705</a></span>
<span class="normal"><a href="#__codelineno-0-706">706</a></span>
<span class="normal"><a href="#__codelineno-0-707">707</a></span>
<span class="normal"><a href="#__codelineno-0-708">708</a></span>
<span class="normal"><a href="#__codelineno-0-709">709</a></span>
<span class="normal"><a href="#__codelineno-0-710">710</a></span>
<span class="normal"><a href="#__codelineno-0-711">711</a></span>
<span class="normal"><a href="#__codelineno-0-712">712</a></span>
<span class="normal"><a href="#__codelineno-0-713">713</a></span>
<span class="normal"><a href="#__codelineno-0-714">714</a></span>
<span class="normal"><a href="#__codelineno-0-715">715</a></span>
<span class="normal"><a href="#__codelineno-0-716">716</a></span>
<span class="normal"><a href="#__codelineno-0-717">717</a></span>
<span class="normal"><a href="#__codelineno-0-718">718</a></span>
<span class="normal"><a href="#__codelineno-0-719">719</a></span>
<span class="normal"><a href="#__codelineno-0-720">720</a></span>
<span class="normal"><a href="#__codelineno-0-721">721</a></span>
<span class="normal"><a href="#__codelineno-0-722">722</a></span>
<span class="normal"><a href="#__codelineno-0-723">723</a></span>
<span class="normal"><a href="#__codelineno-0-724">724</a></span>
<span class="normal"><a href="#__codelineno-0-725">725</a></span>
<span class="normal"><a href="#__codelineno-0-726">726</a></span>
<span class="normal"><a href="#__codelineno-0-727">727</a></span>
<span class="normal"><a href="#__codelineno-0-728">728</a></span>
<span class="normal"><a href="#__codelineno-0-729">729</a></span>
<span class="normal"><a href="#__codelineno-0-730">730</a></span>
<span class="normal"><a href="#__codelineno-0-731">731</a></span>
<span class="normal"><a href="#__codelineno-0-732">732</a></span>
<span class="normal"><a href="#__codelineno-0-733">733</a></span>
<span class="normal"><a href="#__codelineno-0-734">734</a></span>
<span class="normal"><a href="#__codelineno-0-735">735</a></span>
<span class="normal"><a href="#__codelineno-0-736">736</a></span>
<span class="normal"><a href="#__codelineno-0-737">737</a></span>
<span class="normal"><a href="#__codelineno-0-738">738</a></span>
<span class="normal"><a href="#__codelineno-0-739">739</a></span>
<span class="normal"><a href="#__codelineno-0-740">740</a></span>
<span class="normal"><a href="#__codelineno-0-741">741</a></span>
<span class="normal"><a href="#__codelineno-0-742">742</a></span>
<span class="normal"><a href="#__codelineno-0-743">743</a></span>
<span class="normal"><a href="#__codelineno-0-744">744</a></span>
<span class="normal"><a href="#__codelineno-0-745">745</a></span>
<span class="normal"><a href="#__codelineno-0-746">746</a></span>
<span class="normal"><a href="#__codelineno-0-747">747</a></span>
<span class="normal"><a href="#__codelineno-0-748">748</a></span>
<span class="normal"><a href="#__codelineno-0-749">749</a></span>
<span class="normal"><a href="#__codelineno-0-750">750</a></span>
<span class="normal"><a href="#__codelineno-0-751">751</a></span>
<span class="normal"><a href="#__codelineno-0-752">752</a></span>
<span class="normal"><a href="#__codelineno-0-753">753</a></span>
<span class="normal"><a href="#__codelineno-0-754">754</a></span>
<span class="normal"><a href="#__codelineno-0-755">755</a></span>
<span class="normal"><a href="#__codelineno-0-756">756</a></span>
<span class="normal"><a href="#__codelineno-0-757">757</a></span>
<span class="normal"><a href="#__codelineno-0-758">758</a></span>
<span class="normal"><a href="#__codelineno-0-759">759</a></span>
<span class="normal"><a href="#__codelineno-0-760">760</a></span>
<span class="normal"><a href="#__codelineno-0-761">761</a></span>
<span class="normal"><a href="#__codelineno-0-762">762</a></span>
<span class="normal"><a href="#__codelineno-0-763">763</a></span>
<span class="normal"><a href="#__codelineno-0-764">764</a></span>
<span class="normal"><a href="#__codelineno-0-765">765</a></span>
<span class="normal"><a href="#__codelineno-0-766">766</a></span>
<span class="normal"><a href="#__codelineno-0-767">767</a></span>
<span class="normal"><a href="#__codelineno-0-768">768</a></span>
<span class="normal"><a href="#__codelineno-0-769">769</a></span>
<span class="normal"><a href="#__codelineno-0-770">770</a></span>
<span class="normal"><a href="#__codelineno-0-771">771</a></span>
<span class="normal"><a href="#__codelineno-0-772">772</a></span>
<span class="normal"><a href="#__codelineno-0-773">773</a></span>
<span class="normal"><a href="#__codelineno-0-774">774</a></span>
<span class="normal"><a href="#__codelineno-0-775">775</a></span>
<span class="normal"><a href="#__codelineno-0-776">776</a></span>
<span class="normal"><a href="#__codelineno-0-777">777</a></span>
<span class="normal"><a href="#__codelineno-0-778">778</a></span>
<span class="normal"><a href="#__codelineno-0-779">779</a></span>
<span class="normal"><a href="#__codelineno-0-780">780</a></span>
<span class="normal"><a href="#__codelineno-0-781">781</a></span>
<span class="normal"><a href="#__codelineno-0-782">782</a></span>
<span class="normal"><a href="#__codelineno-0-783">783</a></span>
<span class="normal"><a href="#__codelineno-0-784">784</a></span>
<span class="normal"><a href="#__codelineno-0-785">785</a></span>
<span class="normal"><a href="#__codelineno-0-786">786</a></span>
<span class="normal"><a href="#__codelineno-0-787">787</a></span>
<span class="normal"><a href="#__codelineno-0-788">788</a></span>
<span class="normal"><a href="#__codelineno-0-789">789</a></span>
<span class="normal"><a href="#__codelineno-0-790">790</a></span>
<span class="normal"><a href="#__codelineno-0-791">791</a></span>
<span class="normal"><a href="#__codelineno-0-792">792</a></span>
<span class="normal"><a href="#__codelineno-0-793">793</a></span>
<span class="normal"><a href="#__codelineno-0-794">794</a></span>
<span class="normal"><a href="#__codelineno-0-795">795</a></span>
<span class="normal"><a href="#__codelineno-0-796">796</a></span>
<span class="normal"><a href="#__codelineno-0-797">797</a></span>
<span class="normal"><a href="#__codelineno-0-798">798</a></span>
<span class="normal"><a href="#__codelineno-0-799">799</a></span>
<span class="normal"><a href="#__codelineno-0-800">800</a></span>
<span class="normal"><a href="#__codelineno-0-801">801</a></span>
<span class="normal"><a href="#__codelineno-0-802">802</a></span>
<span class="normal"><a href="#__codelineno-0-803">803</a></span>
<span class="normal"><a href="#__codelineno-0-804">804</a></span>
<span class="normal"><a href="#__codelineno-0-805">805</a></span>
<span class="normal"><a href="#__codelineno-0-806">806</a></span>
<span class="normal"><a href="#__codelineno-0-807">807</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-606" name="__codelineno-0-606"></a><span class="k">class</span><span class="w"> </span><span class="nc">Result</span><span class="p">(</span><span class="n">Return</span><span class="p">):</span>
<a id="__codelineno-0-607" name="__codelineno-0-607"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-608" name="__codelineno-0-608"></a><span class="sd">    Result objects are returned to the frontend.</span>
<a id="__codelineno-0-609" name="__codelineno-0-609"></a><span class="sd">    These are displayed on the frontend.</span>
<a id="__codelineno-0-610" name="__codelineno-0-610"></a><span class="sd">    E.g. a table, a chart, a text response, etc.</span>
<a id="__codelineno-0-611" name="__codelineno-0-611"></a>
<a id="__codelineno-0-612" name="__codelineno-0-612"></a><span class="sd">    You can yield a `Result` directly, and specify the `type` and `name` of the result.</span>
<a id="__codelineno-0-613" name="__codelineno-0-613"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-614" name="__codelineno-0-614"></a>
<a id="__codelineno-0-615" name="__codelineno-0-615"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-616" name="__codelineno-0-616"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-617" name="__codelineno-0-617"></a>        <span class="n">objects</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">],</span>
<a id="__codelineno-0-618" name="__codelineno-0-618"></a>        <span class="n">metadata</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
<a id="__codelineno-0-619" name="__codelineno-0-619"></a>        <span class="n">payload_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;default&quot;</span><span class="p">,</span>
<a id="__codelineno-0-620" name="__codelineno-0-620"></a>        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;default&quot;</span><span class="p">,</span>
<a id="__codelineno-0-621" name="__codelineno-0-621"></a>        <span class="n">mapping</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-622" name="__codelineno-0-622"></a>        <span class="n">llm_message</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-623" name="__codelineno-0-623"></a>        <span class="n">unmapped_keys</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;_REF_ID&quot;</span><span class="p">],</span>
<a id="__codelineno-0-624" name="__codelineno-0-624"></a>        <span class="n">display</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-625" name="__codelineno-0-625"></a>    <span class="p">):</span>
<a id="__codelineno-0-626" name="__codelineno-0-626"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-627" name="__codelineno-0-627"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-628" name="__codelineno-0-628"></a><span class="sd">            objects (list[dict]): The objects attached to this result.</span>
<a id="__codelineno-0-629" name="__codelineno-0-629"></a><span class="sd">            payload_type: (str): Identifier for the type of result.</span>
<a id="__codelineno-0-630" name="__codelineno-0-630"></a><span class="sd">            metadata (dict): The metadata attached to this result,</span>
<a id="__codelineno-0-631" name="__codelineno-0-631"></a><span class="sd">                for example, query used, time taken, any other information not directly within the objects</span>
<a id="__codelineno-0-632" name="__codelineno-0-632"></a><span class="sd">            name (str): The name of the result, e.g. this could be the name of the collection queried.</span>
<a id="__codelineno-0-633" name="__codelineno-0-633"></a><span class="sd">                Used to index the result in the environment.</span>
<a id="__codelineno-0-634" name="__codelineno-0-634"></a><span class="sd">            mapping (dict | None): A mapping of the objects to the frontend.</span>
<a id="__codelineno-0-635" name="__codelineno-0-635"></a><span class="sd">                Essentially, if the objects are going to be displayed on the frontend, the frontend has specific keys that it wants the objects to have.</span>
<a id="__codelineno-0-636" name="__codelineno-0-636"></a><span class="sd">                This is a dictionary that maps from frontend keys to the object keys.</span>
<a id="__codelineno-0-637" name="__codelineno-0-637"></a><span class="sd">            llm_message (str | None): A message to be displayed to the LLM to help it parse the result.</span>
<a id="__codelineno-0-638" name="__codelineno-0-638"></a><span class="sd">                You can use the following placeholders that will automatically be replaced with the correct values:</span>
<a id="__codelineno-0-639" name="__codelineno-0-639"></a>
<a id="__codelineno-0-640" name="__codelineno-0-640"></a><span class="sd">                - {type}: The type of the object</span>
<a id="__codelineno-0-641" name="__codelineno-0-641"></a><span class="sd">                - {name}: The name of the object</span>
<a id="__codelineno-0-642" name="__codelineno-0-642"></a><span class="sd">                - {num_objects}: The number of objects in the object</span>
<a id="__codelineno-0-643" name="__codelineno-0-643"></a><span class="sd">                - {metadata_key}: Any key in the metadata dictionary</span>
<a id="__codelineno-0-644" name="__codelineno-0-644"></a><span class="sd">            unmapped_keys (list[str]): A list of keys that are not mapped to the frontend.</span>
<a id="__codelineno-0-645" name="__codelineno-0-645"></a><span class="sd">            display (bool): Whether to display the result on the frontend when yielding this object.</span>
<a id="__codelineno-0-646" name="__codelineno-0-646"></a><span class="sd">                Defaults to `True`.</span>
<a id="__codelineno-0-647" name="__codelineno-0-647"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-648" name="__codelineno-0-648"></a>        <span class="n">Return</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;result&quot;</span><span class="p">,</span> <span class="n">payload_type</span><span class="p">)</span>
<a id="__codelineno-0-649" name="__codelineno-0-649"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">objects</span> <span class="o">=</span> <span class="n">objects</span>
<a id="__codelineno-0-650" name="__codelineno-0-650"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span> <span class="o">=</span> <span class="n">metadata</span>
<a id="__codelineno-0-651" name="__codelineno-0-651"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
<a id="__codelineno-0-652" name="__codelineno-0-652"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mapping</span> <span class="o">=</span> <span class="n">mapping</span>
<a id="__codelineno-0-653" name="__codelineno-0-653"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">llm_message</span> <span class="o">=</span> <span class="n">llm_message</span>
<a id="__codelineno-0-654" name="__codelineno-0-654"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unmapped_keys</span> <span class="o">=</span> <span class="n">unmapped_keys</span>
<a id="__codelineno-0-655" name="__codelineno-0-655"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">display</span> <span class="o">=</span> <span class="n">display</span>
<a id="__codelineno-0-656" name="__codelineno-0-656"></a>
<a id="__codelineno-0-657" name="__codelineno-0-657"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-658" name="__codelineno-0-658"></a>        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="p">)</span>
<a id="__codelineno-0-659" name="__codelineno-0-659"></a>
<a id="__codelineno-0-660" name="__codelineno-0-660"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">format_llm_message</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-661" name="__codelineno-0-661"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-662" name="__codelineno-0-662"></a><span class="sd">        llm_message is a string that is used to help the LLM parse the output of the tool.</span>
<a id="__codelineno-0-663" name="__codelineno-0-663"></a><span class="sd">        It is a placeholder for the actual message that will be displayed to the user.</span>
<a id="__codelineno-0-664" name="__codelineno-0-664"></a>
<a id="__codelineno-0-665" name="__codelineno-0-665"></a><span class="sd">        You can use the following placeholders:</span>
<a id="__codelineno-0-666" name="__codelineno-0-666"></a>
<a id="__codelineno-0-667" name="__codelineno-0-667"></a><span class="sd">        - {payload_type}: The type of the object</span>
<a id="__codelineno-0-668" name="__codelineno-0-668"></a><span class="sd">        - {name}: The name of the object</span>
<a id="__codelineno-0-669" name="__codelineno-0-669"></a><span class="sd">        - {num_objects}: The number of objects in the object</span>
<a id="__codelineno-0-670" name="__codelineno-0-670"></a><span class="sd">        - {metadata_key}: Any key in the metadata dictionary</span>
<a id="__codelineno-0-671" name="__codelineno-0-671"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-672" name="__codelineno-0-672"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">llm_message</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-673" name="__codelineno-0-673"></a>            <span class="k">return</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-0-674" name="__codelineno-0-674"></a>
<a id="__codelineno-0-675" name="__codelineno-0-675"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">llm_message</span><span class="o">.</span><span class="n">format_map</span><span class="p">(</span>
<a id="__codelineno-0-676" name="__codelineno-0-676"></a>            <span class="p">{</span>
<a id="__codelineno-0-677" name="__codelineno-0-677"></a>                <span class="s2">&quot;payload_type&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">payload_type</span><span class="p">,</span>
<a id="__codelineno-0-678" name="__codelineno-0-678"></a>                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
<a id="__codelineno-0-679" name="__codelineno-0-679"></a>                <span class="s2">&quot;num_objects&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span>
<a id="__codelineno-0-680" name="__codelineno-0-680"></a>                <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">,</span>
<a id="__codelineno-0-681" name="__codelineno-0-681"></a>            <span class="p">}</span>
<a id="__codelineno-0-682" name="__codelineno-0-682"></a>        <span class="p">)</span>
<a id="__codelineno-0-683" name="__codelineno-0-683"></a>
<a id="__codelineno-0-684" name="__codelineno-0-684"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">do_mapping</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">objects</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">]):</span>
<a id="__codelineno-0-685" name="__codelineno-0-685"></a>
<a id="__codelineno-0-686" name="__codelineno-0-686"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mapping</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-687" name="__codelineno-0-687"></a>            <span class="k">return</span> <span class="n">objects</span>
<a id="__codelineno-0-688" name="__codelineno-0-688"></a>
<a id="__codelineno-0-689" name="__codelineno-0-689"></a>        <span class="n">output_objects</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-690" name="__codelineno-0-690"></a>        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">objects</span><span class="p">:</span>
<a id="__codelineno-0-691" name="__codelineno-0-691"></a>            <span class="n">output_objects</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-692" name="__codelineno-0-692"></a>                <span class="p">{</span>
<a id="__codelineno-0-693" name="__codelineno-0-693"></a>                    <span class="n">key</span><span class="p">:</span> <span class="n">obj</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">mapping</span><span class="p">[</span><span class="n">key</span><span class="p">]]</span>
<a id="__codelineno-0-694" name="__codelineno-0-694"></a>                    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mapping</span>
<a id="__codelineno-0-695" name="__codelineno-0-695"></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mapping</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-0-696" name="__codelineno-0-696"></a>                <span class="p">}</span>
<a id="__codelineno-0-697" name="__codelineno-0-697"></a>            <span class="p">)</span>
<a id="__codelineno-0-698" name="__codelineno-0-698"></a>            <span class="n">output_objects</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
<a id="__codelineno-0-699" name="__codelineno-0-699"></a>                <span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="n">obj</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">unmapped_keys</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">obj</span><span class="p">}</span>
<a id="__codelineno-0-700" name="__codelineno-0-700"></a>            <span class="p">)</span>
<a id="__codelineno-0-701" name="__codelineno-0-701"></a>
<a id="__codelineno-0-702" name="__codelineno-0-702"></a>        <span class="k">return</span> <span class="n">output_objects</span>
<a id="__codelineno-0-703" name="__codelineno-0-703"></a>
<a id="__codelineno-0-704" name="__codelineno-0-704"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">to_json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mapping</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<a id="__codelineno-0-705" name="__codelineno-0-705"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-706" name="__codelineno-0-706"></a><span class="sd">        Convert the result to a list of dictionaries.</span>
<a id="__codelineno-0-707" name="__codelineno-0-707"></a>
<a id="__codelineno-0-708" name="__codelineno-0-708"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-709" name="__codelineno-0-709"></a><span class="sd">            mapping (bool): Whether to map the objects to the frontend.</span>
<a id="__codelineno-0-710" name="__codelineno-0-710"></a><span class="sd">                This will use the `mapping` dictionary created on initialisation of the `Result` object.</span>
<a id="__codelineno-0-711" name="__codelineno-0-711"></a><span class="sd">                If `False`, the objects are returned as is.</span>
<a id="__codelineno-0-712" name="__codelineno-0-712"></a><span class="sd">                Defaults to `False`.</span>
<a id="__codelineno-0-713" name="__codelineno-0-713"></a>
<a id="__codelineno-0-714" name="__codelineno-0-714"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-715" name="__codelineno-0-715"></a><span class="sd">            (list[dict]): A list of dictionaries, which can be serialised to JSON.</span>
<a id="__codelineno-0-716" name="__codelineno-0-716"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-717" name="__codelineno-0-717"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">elysia.util.parsing</span><span class="w"> </span><span class="kn">import</span> <span class="n">format_dict_to_serialisable</span>
<a id="__codelineno-0-718" name="__codelineno-0-718"></a>
<a id="__codelineno-0-719" name="__codelineno-0-719"></a>        <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span>
<a id="__codelineno-0-720" name="__codelineno-0-720"></a>            <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects</span>
<a id="__codelineno-0-721" name="__codelineno-0-721"></a>        <span class="p">),</span> <span class="s2">&quot;All objects must be dictionaries&quot;</span>
<a id="__codelineno-0-722" name="__codelineno-0-722"></a>
<a id="__codelineno-0-723" name="__codelineno-0-723"></a>        <span class="k">if</span> <span class="n">mapping</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">mapping</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-724" name="__codelineno-0-724"></a>            <span class="n">output_objects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_mapping</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="p">)</span>
<a id="__codelineno-0-725" name="__codelineno-0-725"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-726" name="__codelineno-0-726"></a>            <span class="n">output_objects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects</span>
<a id="__codelineno-0-727" name="__codelineno-0-727"></a>
<a id="__codelineno-0-728" name="__codelineno-0-728"></a>        <span class="k">for</span> <span class="nb">object</span> <span class="ow">in</span> <span class="n">output_objects</span><span class="p">:</span>
<a id="__codelineno-0-729" name="__codelineno-0-729"></a>            <span class="n">format_dict_to_serialisable</span><span class="p">(</span><span class="nb">object</span><span class="p">)</span>
<a id="__codelineno-0-730" name="__codelineno-0-730"></a>
<a id="__codelineno-0-731" name="__codelineno-0-731"></a>        <span class="k">return</span> <span class="n">output_objects</span>
<a id="__codelineno-0-732" name="__codelineno-0-732"></a>
<a id="__codelineno-0-733" name="__codelineno-0-733"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">to_frontend</span><span class="p">(</span>
<a id="__codelineno-0-734" name="__codelineno-0-734"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-735" name="__codelineno-0-735"></a>        <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-736" name="__codelineno-0-736"></a>        <span class="n">conversation_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-737" name="__codelineno-0-737"></a>        <span class="n">query_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-738" name="__codelineno-0-738"></a>    <span class="p">):</span>
<a id="__codelineno-0-739" name="__codelineno-0-739"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-740" name="__codelineno-0-740"></a><span class="sd">        Convert the result to a frontend payload.</span>
<a id="__codelineno-0-741" name="__codelineno-0-741"></a><span class="sd">        This is a wrapper around the `to_json` method.</span>
<a id="__codelineno-0-742" name="__codelineno-0-742"></a><span class="sd">        But the objects and metadata are inside a `payload` key, which also includes a `type` key,</span>
<a id="__codelineno-0-743" name="__codelineno-0-743"></a><span class="sd">        being the frontend identifier for the type of payload being sent.</span>
<a id="__codelineno-0-744" name="__codelineno-0-744"></a><span class="sd">        (e.g. `ticket`, `product`, `message`, etc.)</span>
<a id="__codelineno-0-745" name="__codelineno-0-745"></a>
<a id="__codelineno-0-746" name="__codelineno-0-746"></a><span class="sd">        The outside of the payload also contains the user_id, conversation_id, and query_id.</span>
<a id="__codelineno-0-747" name="__codelineno-0-747"></a>
<a id="__codelineno-0-748" name="__codelineno-0-748"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-749" name="__codelineno-0-749"></a><span class="sd">            user_id (str): The user ID.</span>
<a id="__codelineno-0-750" name="__codelineno-0-750"></a><span class="sd">            conversation_id (str): The conversation ID.</span>
<a id="__codelineno-0-751" name="__codelineno-0-751"></a><span class="sd">            query_id (str): The query ID.</span>
<a id="__codelineno-0-752" name="__codelineno-0-752"></a>
<a id="__codelineno-0-753" name="__codelineno-0-753"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-754" name="__codelineno-0-754"></a><span class="sd">            (dict): The frontend payload, which is a dictionary with the following structure:</span>
<a id="__codelineno-0-755" name="__codelineno-0-755"></a><span class="sd">                ```python</span>
<a id="__codelineno-0-756" name="__codelineno-0-756"></a><span class="sd">                {</span>
<a id="__codelineno-0-757" name="__codelineno-0-757"></a><span class="sd">                    &quot;type&quot;: &quot;result&quot;,</span>
<a id="__codelineno-0-758" name="__codelineno-0-758"></a><span class="sd">                    &quot;user_id&quot;: str,</span>
<a id="__codelineno-0-759" name="__codelineno-0-759"></a><span class="sd">                    &quot;conversation_id&quot;: str,</span>
<a id="__codelineno-0-760" name="__codelineno-0-760"></a><span class="sd">                    &quot;query_id&quot;: str,</span>
<a id="__codelineno-0-761" name="__codelineno-0-761"></a><span class="sd">                    &quot;id&quot;: str,</span>
<a id="__codelineno-0-762" name="__codelineno-0-762"></a><span class="sd">                    &quot;payload&quot;: dict = {</span>
<a id="__codelineno-0-763" name="__codelineno-0-763"></a><span class="sd">                        &quot;type&quot;: str,</span>
<a id="__codelineno-0-764" name="__codelineno-0-764"></a><span class="sd">                        &quot;objects&quot;: list[dict],</span>
<a id="__codelineno-0-765" name="__codelineno-0-765"></a><span class="sd">                        &quot;metadata&quot;: dict,</span>
<a id="__codelineno-0-766" name="__codelineno-0-766"></a><span class="sd">                    },</span>
<a id="__codelineno-0-767" name="__codelineno-0-767"></a><span class="sd">                }</span>
<a id="__codelineno-0-768" name="__codelineno-0-768"></a><span class="sd">                ```</span>
<a id="__codelineno-0-769" name="__codelineno-0-769"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-770" name="__codelineno-0-770"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="p">:</span>
<a id="__codelineno-0-771" name="__codelineno-0-771"></a>            <span class="k">return</span>
<a id="__codelineno-0-772" name="__codelineno-0-772"></a>
<a id="__codelineno-0-773" name="__codelineno-0-773"></a>        <span class="n">objects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="n">mapping</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-774" name="__codelineno-0-774"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">objects</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-775" name="__codelineno-0-775"></a>            <span class="k">return</span>
<a id="__codelineno-0-776" name="__codelineno-0-776"></a>
<a id="__codelineno-0-777" name="__codelineno-0-777"></a>        <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-778" name="__codelineno-0-778"></a>            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">payload_type</span><span class="p">,</span>
<a id="__codelineno-0-779" name="__codelineno-0-779"></a>            <span class="s2">&quot;objects&quot;</span><span class="p">:</span> <span class="n">objects</span><span class="p">,</span>
<a id="__codelineno-0-780" name="__codelineno-0-780"></a>            <span class="s2">&quot;metadata&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">,</span>
<a id="__codelineno-0-781" name="__codelineno-0-781"></a>        <span class="p">}</span>
<a id="__codelineno-0-782" name="__codelineno-0-782"></a>
<a id="__codelineno-0-783" name="__codelineno-0-783"></a>        <span class="k">return</span> <span class="p">{</span>
<a id="__codelineno-0-784" name="__codelineno-0-784"></a>            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">frontend_type</span><span class="p">,</span>
<a id="__codelineno-0-785" name="__codelineno-0-785"></a>            <span class="s2">&quot;user_id&quot;</span><span class="p">:</span> <span class="n">user_id</span><span class="p">,</span>
<a id="__codelineno-0-786" name="__codelineno-0-786"></a>            <span class="s2">&quot;conversation_id&quot;</span><span class="p">:</span> <span class="n">conversation_id</span><span class="p">,</span>
<a id="__codelineno-0-787" name="__codelineno-0-787"></a>            <span class="s2">&quot;query_id&quot;</span><span class="p">:</span> <span class="n">query_id</span><span class="p">,</span>
<a id="__codelineno-0-788" name="__codelineno-0-788"></a>            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">frontend_type</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;-&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()),</span>
<a id="__codelineno-0-789" name="__codelineno-0-789"></a>            <span class="s2">&quot;payload&quot;</span><span class="p">:</span> <span class="n">payload</span><span class="p">,</span>
<a id="__codelineno-0-790" name="__codelineno-0-790"></a>        <span class="p">}</span>
<a id="__codelineno-0-791" name="__codelineno-0-791"></a>
<a id="__codelineno-0-792" name="__codelineno-0-792"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">llm_parse</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-793" name="__codelineno-0-793"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-794" name="__codelineno-0-794"></a><span class="sd">        This method is called when the result is displayed to the LLM.</span>
<a id="__codelineno-0-795" name="__codelineno-0-795"></a><span class="sd">        It is used to display custom information to the LLM about the result.</span>
<a id="__codelineno-0-796" name="__codelineno-0-796"></a><span class="sd">        If `llm_message` was defined, then the llm message is formatted using the placeholders.</span>
<a id="__codelineno-0-797" name="__codelineno-0-797"></a><span class="sd">        Otherwise a default message is used.</span>
<a id="__codelineno-0-798" name="__codelineno-0-798"></a>
<a id="__codelineno-0-799" name="__codelineno-0-799"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-800" name="__codelineno-0-800"></a><span class="sd">            (str): The formatted llm message.</span>
<a id="__codelineno-0-801" name="__codelineno-0-801"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-802" name="__codelineno-0-802"></a>
<a id="__codelineno-0-803" name="__codelineno-0-803"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">llm_message</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-804" name="__codelineno-0-804"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">format_llm_message</span><span class="p">()</span>
<a id="__codelineno-0-805" name="__codelineno-0-805"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-806" name="__codelineno-0-806"></a>            <span class="c1"># Default message</span>
<a id="__codelineno-0-807" name="__codelineno-0-807"></a>            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Displayed: A </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">payload_type</span><span class="si">}</span><span class="s2"> object with </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="p">)</span><span class="si">}</span><span class="s2"> objects.&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="elysia.objects.Result.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">objects</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="p">{},</span> <span class="n">payload_type</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">llm_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">unmapped_keys</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;_REF_ID&#39;</span><span class="p">],</span> <span class="n">display</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">



<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>objects</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="dict">dict</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The objects attached to this result.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>payload_type</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>(str): Identifier for the type of result.</p>
              </div>
            </td>
            <td>
                  <code>&#39;default&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>metadata</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The metadata attached to this result,
for example, query used, time taken, any other information not directly within the objects</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the result, e.g. this could be the name of the collection queried.
Used to index the result in the environment.</p>
              </div>
            </td>
            <td>
                  <code>&#39;default&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>mapping</code>
            </td>
            <td>
                  <code><span title="dict">dict</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A mapping of the objects to the frontend.
Essentially, if the objects are going to be displayed on the frontend, the frontend has specific keys that it wants the objects to have.
This is a dictionary that maps from frontend keys to the object keys.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>llm_message</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A message to be displayed to the LLM to help it parse the result.
You can use the following placeholders that will automatically be replaced with the correct values:</p>
<ul>
<li>{type}: The type of the object</li>
<li>{name}: The name of the object</li>
<li>{num_objects}: The number of objects in the object</li>
<li>{metadata_key}: Any key in the metadata dictionary</li>
</ul>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>unmapped_keys</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of keys that are not mapped to the frontend.</p>
              </div>
            </td>
            <td>
                  <code>[&#39;_REF_ID&#39;]</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>display</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to display the result on the frontend when yielding this object.
Defaults to <code>True</code>.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>elysia/objects.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-615">615</a></span>
<span class="normal"><a href="#__codelineno-0-616">616</a></span>
<span class="normal"><a href="#__codelineno-0-617">617</a></span>
<span class="normal"><a href="#__codelineno-0-618">618</a></span>
<span class="normal"><a href="#__codelineno-0-619">619</a></span>
<span class="normal"><a href="#__codelineno-0-620">620</a></span>
<span class="normal"><a href="#__codelineno-0-621">621</a></span>
<span class="normal"><a href="#__codelineno-0-622">622</a></span>
<span class="normal"><a href="#__codelineno-0-623">623</a></span>
<span class="normal"><a href="#__codelineno-0-624">624</a></span>
<span class="normal"><a href="#__codelineno-0-625">625</a></span>
<span class="normal"><a href="#__codelineno-0-626">626</a></span>
<span class="normal"><a href="#__codelineno-0-627">627</a></span>
<span class="normal"><a href="#__codelineno-0-628">628</a></span>
<span class="normal"><a href="#__codelineno-0-629">629</a></span>
<span class="normal"><a href="#__codelineno-0-630">630</a></span>
<span class="normal"><a href="#__codelineno-0-631">631</a></span>
<span class="normal"><a href="#__codelineno-0-632">632</a></span>
<span class="normal"><a href="#__codelineno-0-633">633</a></span>
<span class="normal"><a href="#__codelineno-0-634">634</a></span>
<span class="normal"><a href="#__codelineno-0-635">635</a></span>
<span class="normal"><a href="#__codelineno-0-636">636</a></span>
<span class="normal"><a href="#__codelineno-0-637">637</a></span>
<span class="normal"><a href="#__codelineno-0-638">638</a></span>
<span class="normal"><a href="#__codelineno-0-639">639</a></span>
<span class="normal"><a href="#__codelineno-0-640">640</a></span>
<span class="normal"><a href="#__codelineno-0-641">641</a></span>
<span class="normal"><a href="#__codelineno-0-642">642</a></span>
<span class="normal"><a href="#__codelineno-0-643">643</a></span>
<span class="normal"><a href="#__codelineno-0-644">644</a></span>
<span class="normal"><a href="#__codelineno-0-645">645</a></span>
<span class="normal"><a href="#__codelineno-0-646">646</a></span>
<span class="normal"><a href="#__codelineno-0-647">647</a></span>
<span class="normal"><a href="#__codelineno-0-648">648</a></span>
<span class="normal"><a href="#__codelineno-0-649">649</a></span>
<span class="normal"><a href="#__codelineno-0-650">650</a></span>
<span class="normal"><a href="#__codelineno-0-651">651</a></span>
<span class="normal"><a href="#__codelineno-0-652">652</a></span>
<span class="normal"><a href="#__codelineno-0-653">653</a></span>
<span class="normal"><a href="#__codelineno-0-654">654</a></span>
<span class="normal"><a href="#__codelineno-0-655">655</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-615" name="__codelineno-0-615"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-616" name="__codelineno-0-616"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-617" name="__codelineno-0-617"></a>    <span class="n">objects</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">],</span>
<a id="__codelineno-0-618" name="__codelineno-0-618"></a>    <span class="n">metadata</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
<a id="__codelineno-0-619" name="__codelineno-0-619"></a>    <span class="n">payload_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;default&quot;</span><span class="p">,</span>
<a id="__codelineno-0-620" name="__codelineno-0-620"></a>    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;default&quot;</span><span class="p">,</span>
<a id="__codelineno-0-621" name="__codelineno-0-621"></a>    <span class="n">mapping</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-622" name="__codelineno-0-622"></a>    <span class="n">llm_message</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-623" name="__codelineno-0-623"></a>    <span class="n">unmapped_keys</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;_REF_ID&quot;</span><span class="p">],</span>
<a id="__codelineno-0-624" name="__codelineno-0-624"></a>    <span class="n">display</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-625" name="__codelineno-0-625"></a><span class="p">):</span>
<a id="__codelineno-0-626" name="__codelineno-0-626"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-627" name="__codelineno-0-627"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-628" name="__codelineno-0-628"></a><span class="sd">        objects (list[dict]): The objects attached to this result.</span>
<a id="__codelineno-0-629" name="__codelineno-0-629"></a><span class="sd">        payload_type: (str): Identifier for the type of result.</span>
<a id="__codelineno-0-630" name="__codelineno-0-630"></a><span class="sd">        metadata (dict): The metadata attached to this result,</span>
<a id="__codelineno-0-631" name="__codelineno-0-631"></a><span class="sd">            for example, query used, time taken, any other information not directly within the objects</span>
<a id="__codelineno-0-632" name="__codelineno-0-632"></a><span class="sd">        name (str): The name of the result, e.g. this could be the name of the collection queried.</span>
<a id="__codelineno-0-633" name="__codelineno-0-633"></a><span class="sd">            Used to index the result in the environment.</span>
<a id="__codelineno-0-634" name="__codelineno-0-634"></a><span class="sd">        mapping (dict | None): A mapping of the objects to the frontend.</span>
<a id="__codelineno-0-635" name="__codelineno-0-635"></a><span class="sd">            Essentially, if the objects are going to be displayed on the frontend, the frontend has specific keys that it wants the objects to have.</span>
<a id="__codelineno-0-636" name="__codelineno-0-636"></a><span class="sd">            This is a dictionary that maps from frontend keys to the object keys.</span>
<a id="__codelineno-0-637" name="__codelineno-0-637"></a><span class="sd">        llm_message (str | None): A message to be displayed to the LLM to help it parse the result.</span>
<a id="__codelineno-0-638" name="__codelineno-0-638"></a><span class="sd">            You can use the following placeholders that will automatically be replaced with the correct values:</span>
<a id="__codelineno-0-639" name="__codelineno-0-639"></a>
<a id="__codelineno-0-640" name="__codelineno-0-640"></a><span class="sd">            - {type}: The type of the object</span>
<a id="__codelineno-0-641" name="__codelineno-0-641"></a><span class="sd">            - {name}: The name of the object</span>
<a id="__codelineno-0-642" name="__codelineno-0-642"></a><span class="sd">            - {num_objects}: The number of objects in the object</span>
<a id="__codelineno-0-643" name="__codelineno-0-643"></a><span class="sd">            - {metadata_key}: Any key in the metadata dictionary</span>
<a id="__codelineno-0-644" name="__codelineno-0-644"></a><span class="sd">        unmapped_keys (list[str]): A list of keys that are not mapped to the frontend.</span>
<a id="__codelineno-0-645" name="__codelineno-0-645"></a><span class="sd">        display (bool): Whether to display the result on the frontend when yielding this object.</span>
<a id="__codelineno-0-646" name="__codelineno-0-646"></a><span class="sd">            Defaults to `True`.</span>
<a id="__codelineno-0-647" name="__codelineno-0-647"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-648" name="__codelineno-0-648"></a>    <span class="n">Return</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;result&quot;</span><span class="p">,</span> <span class="n">payload_type</span><span class="p">)</span>
<a id="__codelineno-0-649" name="__codelineno-0-649"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">objects</span> <span class="o">=</span> <span class="n">objects</span>
<a id="__codelineno-0-650" name="__codelineno-0-650"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span> <span class="o">=</span> <span class="n">metadata</span>
<a id="__codelineno-0-651" name="__codelineno-0-651"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
<a id="__codelineno-0-652" name="__codelineno-0-652"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">mapping</span> <span class="o">=</span> <span class="n">mapping</span>
<a id="__codelineno-0-653" name="__codelineno-0-653"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">llm_message</span> <span class="o">=</span> <span class="n">llm_message</span>
<a id="__codelineno-0-654" name="__codelineno-0-654"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">unmapped_keys</span> <span class="o">=</span> <span class="n">unmapped_keys</span>
<a id="__codelineno-0-655" name="__codelineno-0-655"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">display</span> <span class="o">=</span> <span class="n">display</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="elysia.objects.Result.format_llm_message" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">format_llm_message</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>llm_message is a string that is used to help the LLM parse the output of the tool.
It is a placeholder for the actual message that will be displayed to the user.</p>
<p>You can use the following placeholders:</p>
<ul>
<li>{payload_type}: The type of the object</li>
<li>{name}: The name of the object</li>
<li>{num_objects}: The number of objects in the object</li>
<li>{metadata_key}: Any key in the metadata dictionary</li>
</ul>


            <details class="quote">
              <summary>Source code in <code>elysia/objects.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-660">660</a></span>
<span class="normal"><a href="#__codelineno-0-661">661</a></span>
<span class="normal"><a href="#__codelineno-0-662">662</a></span>
<span class="normal"><a href="#__codelineno-0-663">663</a></span>
<span class="normal"><a href="#__codelineno-0-664">664</a></span>
<span class="normal"><a href="#__codelineno-0-665">665</a></span>
<span class="normal"><a href="#__codelineno-0-666">666</a></span>
<span class="normal"><a href="#__codelineno-0-667">667</a></span>
<span class="normal"><a href="#__codelineno-0-668">668</a></span>
<span class="normal"><a href="#__codelineno-0-669">669</a></span>
<span class="normal"><a href="#__codelineno-0-670">670</a></span>
<span class="normal"><a href="#__codelineno-0-671">671</a></span>
<span class="normal"><a href="#__codelineno-0-672">672</a></span>
<span class="normal"><a href="#__codelineno-0-673">673</a></span>
<span class="normal"><a href="#__codelineno-0-674">674</a></span>
<span class="normal"><a href="#__codelineno-0-675">675</a></span>
<span class="normal"><a href="#__codelineno-0-676">676</a></span>
<span class="normal"><a href="#__codelineno-0-677">677</a></span>
<span class="normal"><a href="#__codelineno-0-678">678</a></span>
<span class="normal"><a href="#__codelineno-0-679">679</a></span>
<span class="normal"><a href="#__codelineno-0-680">680</a></span>
<span class="normal"><a href="#__codelineno-0-681">681</a></span>
<span class="normal"><a href="#__codelineno-0-682">682</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-660" name="__codelineno-0-660"></a><span class="k">def</span><span class="w"> </span><span class="nf">format_llm_message</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-661" name="__codelineno-0-661"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-662" name="__codelineno-0-662"></a><span class="sd">    llm_message is a string that is used to help the LLM parse the output of the tool.</span>
<a id="__codelineno-0-663" name="__codelineno-0-663"></a><span class="sd">    It is a placeholder for the actual message that will be displayed to the user.</span>
<a id="__codelineno-0-664" name="__codelineno-0-664"></a>
<a id="__codelineno-0-665" name="__codelineno-0-665"></a><span class="sd">    You can use the following placeholders:</span>
<a id="__codelineno-0-666" name="__codelineno-0-666"></a>
<a id="__codelineno-0-667" name="__codelineno-0-667"></a><span class="sd">    - {payload_type}: The type of the object</span>
<a id="__codelineno-0-668" name="__codelineno-0-668"></a><span class="sd">    - {name}: The name of the object</span>
<a id="__codelineno-0-669" name="__codelineno-0-669"></a><span class="sd">    - {num_objects}: The number of objects in the object</span>
<a id="__codelineno-0-670" name="__codelineno-0-670"></a><span class="sd">    - {metadata_key}: Any key in the metadata dictionary</span>
<a id="__codelineno-0-671" name="__codelineno-0-671"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-672" name="__codelineno-0-672"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">llm_message</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-673" name="__codelineno-0-673"></a>        <span class="k">return</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-0-674" name="__codelineno-0-674"></a>
<a id="__codelineno-0-675" name="__codelineno-0-675"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">llm_message</span><span class="o">.</span><span class="n">format_map</span><span class="p">(</span>
<a id="__codelineno-0-676" name="__codelineno-0-676"></a>        <span class="p">{</span>
<a id="__codelineno-0-677" name="__codelineno-0-677"></a>            <span class="s2">&quot;payload_type&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">payload_type</span><span class="p">,</span>
<a id="__codelineno-0-678" name="__codelineno-0-678"></a>            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
<a id="__codelineno-0-679" name="__codelineno-0-679"></a>            <span class="s2">&quot;num_objects&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span>
<a id="__codelineno-0-680" name="__codelineno-0-680"></a>            <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">,</span>
<a id="__codelineno-0-681" name="__codelineno-0-681"></a>        <span class="p">}</span>
<a id="__codelineno-0-682" name="__codelineno-0-682"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="elysia.objects.Result.llm_parse" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">llm_parse</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>This method is called when the result is displayed to the LLM.
It is used to display custom information to the LLM about the result.
If <code>llm_message</code> was defined, then the llm message is formatted using the placeholders.
Otherwise a default message is used.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The formatted llm message.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>elysia/objects.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-792">792</a></span>
<span class="normal"><a href="#__codelineno-0-793">793</a></span>
<span class="normal"><a href="#__codelineno-0-794">794</a></span>
<span class="normal"><a href="#__codelineno-0-795">795</a></span>
<span class="normal"><a href="#__codelineno-0-796">796</a></span>
<span class="normal"><a href="#__codelineno-0-797">797</a></span>
<span class="normal"><a href="#__codelineno-0-798">798</a></span>
<span class="normal"><a href="#__codelineno-0-799">799</a></span>
<span class="normal"><a href="#__codelineno-0-800">800</a></span>
<span class="normal"><a href="#__codelineno-0-801">801</a></span>
<span class="normal"><a href="#__codelineno-0-802">802</a></span>
<span class="normal"><a href="#__codelineno-0-803">803</a></span>
<span class="normal"><a href="#__codelineno-0-804">804</a></span>
<span class="normal"><a href="#__codelineno-0-805">805</a></span>
<span class="normal"><a href="#__codelineno-0-806">806</a></span>
<span class="normal"><a href="#__codelineno-0-807">807</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-792" name="__codelineno-0-792"></a><span class="k">def</span><span class="w"> </span><span class="nf">llm_parse</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-793" name="__codelineno-0-793"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-794" name="__codelineno-0-794"></a><span class="sd">    This method is called when the result is displayed to the LLM.</span>
<a id="__codelineno-0-795" name="__codelineno-0-795"></a><span class="sd">    It is used to display custom information to the LLM about the result.</span>
<a id="__codelineno-0-796" name="__codelineno-0-796"></a><span class="sd">    If `llm_message` was defined, then the llm message is formatted using the placeholders.</span>
<a id="__codelineno-0-797" name="__codelineno-0-797"></a><span class="sd">    Otherwise a default message is used.</span>
<a id="__codelineno-0-798" name="__codelineno-0-798"></a>
<a id="__codelineno-0-799" name="__codelineno-0-799"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-800" name="__codelineno-0-800"></a><span class="sd">        (str): The formatted llm message.</span>
<a id="__codelineno-0-801" name="__codelineno-0-801"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-802" name="__codelineno-0-802"></a>
<a id="__codelineno-0-803" name="__codelineno-0-803"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">llm_message</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-804" name="__codelineno-0-804"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">format_llm_message</span><span class="p">()</span>
<a id="__codelineno-0-805" name="__codelineno-0-805"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-806" name="__codelineno-0-806"></a>        <span class="c1"># Default message</span>
<a id="__codelineno-0-807" name="__codelineno-0-807"></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Displayed: A </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">payload_type</span><span class="si">}</span><span class="s2"> object with </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="p">)</span><span class="si">}</span><span class="s2"> objects.&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="elysia.objects.Result.to_frontend" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_frontend</span><span class="p">(</span><span class="n">user_id</span><span class="p">,</span> <span class="n">conversation_id</span><span class="p">,</span> <span class="n">query_id</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Convert the result to a frontend payload.
This is a wrapper around the <code>to_json</code> method.
But the objects and metadata are inside a <code>payload</code> key, which also includes a <code>type</code> key,
being the frontend identifier for the type of payload being sent.
(e.g. <code>ticket</code>, <code>product</code>, <code>message</code>, etc.)</p>
<p>The outside of the payload also contains the user_id, conversation_id, and query_id.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>user_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The user ID.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>conversation_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The conversation ID.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>query_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The query ID.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The frontend payload, which is a dictionary with the following structure:
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="p">{</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;result&quot;</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="s2">&quot;user_id&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="s2">&quot;conversation_id&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="s2">&quot;query_id&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>    <span class="s2">&quot;payload&quot;</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>        <span class="s2">&quot;objects&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">],</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>        <span class="s2">&quot;metadata&quot;</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>    <span class="p">},</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="p">}</span>
</code></pre></div></p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>elysia/objects.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-733">733</a></span>
<span class="normal"><a href="#__codelineno-0-734">734</a></span>
<span class="normal"><a href="#__codelineno-0-735">735</a></span>
<span class="normal"><a href="#__codelineno-0-736">736</a></span>
<span class="normal"><a href="#__codelineno-0-737">737</a></span>
<span class="normal"><a href="#__codelineno-0-738">738</a></span>
<span class="normal"><a href="#__codelineno-0-739">739</a></span>
<span class="normal"><a href="#__codelineno-0-740">740</a></span>
<span class="normal"><a href="#__codelineno-0-741">741</a></span>
<span class="normal"><a href="#__codelineno-0-742">742</a></span>
<span class="normal"><a href="#__codelineno-0-743">743</a></span>
<span class="normal"><a href="#__codelineno-0-744">744</a></span>
<span class="normal"><a href="#__codelineno-0-745">745</a></span>
<span class="normal"><a href="#__codelineno-0-746">746</a></span>
<span class="normal"><a href="#__codelineno-0-747">747</a></span>
<span class="normal"><a href="#__codelineno-0-748">748</a></span>
<span class="normal"><a href="#__codelineno-0-749">749</a></span>
<span class="normal"><a href="#__codelineno-0-750">750</a></span>
<span class="normal"><a href="#__codelineno-0-751">751</a></span>
<span class="normal"><a href="#__codelineno-0-752">752</a></span>
<span class="normal"><a href="#__codelineno-0-753">753</a></span>
<span class="normal"><a href="#__codelineno-0-754">754</a></span>
<span class="normal"><a href="#__codelineno-0-755">755</a></span>
<span class="normal"><a href="#__codelineno-0-756">756</a></span>
<span class="normal"><a href="#__codelineno-0-757">757</a></span>
<span class="normal"><a href="#__codelineno-0-758">758</a></span>
<span class="normal"><a href="#__codelineno-0-759">759</a></span>
<span class="normal"><a href="#__codelineno-0-760">760</a></span>
<span class="normal"><a href="#__codelineno-0-761">761</a></span>
<span class="normal"><a href="#__codelineno-0-762">762</a></span>
<span class="normal"><a href="#__codelineno-0-763">763</a></span>
<span class="normal"><a href="#__codelineno-0-764">764</a></span>
<span class="normal"><a href="#__codelineno-0-765">765</a></span>
<span class="normal"><a href="#__codelineno-0-766">766</a></span>
<span class="normal"><a href="#__codelineno-0-767">767</a></span>
<span class="normal"><a href="#__codelineno-0-768">768</a></span>
<span class="normal"><a href="#__codelineno-0-769">769</a></span>
<span class="normal"><a href="#__codelineno-0-770">770</a></span>
<span class="normal"><a href="#__codelineno-0-771">771</a></span>
<span class="normal"><a href="#__codelineno-0-772">772</a></span>
<span class="normal"><a href="#__codelineno-0-773">773</a></span>
<span class="normal"><a href="#__codelineno-0-774">774</a></span>
<span class="normal"><a href="#__codelineno-0-775">775</a></span>
<span class="normal"><a href="#__codelineno-0-776">776</a></span>
<span class="normal"><a href="#__codelineno-0-777">777</a></span>
<span class="normal"><a href="#__codelineno-0-778">778</a></span>
<span class="normal"><a href="#__codelineno-0-779">779</a></span>
<span class="normal"><a href="#__codelineno-0-780">780</a></span>
<span class="normal"><a href="#__codelineno-0-781">781</a></span>
<span class="normal"><a href="#__codelineno-0-782">782</a></span>
<span class="normal"><a href="#__codelineno-0-783">783</a></span>
<span class="normal"><a href="#__codelineno-0-784">784</a></span>
<span class="normal"><a href="#__codelineno-0-785">785</a></span>
<span class="normal"><a href="#__codelineno-0-786">786</a></span>
<span class="normal"><a href="#__codelineno-0-787">787</a></span>
<span class="normal"><a href="#__codelineno-0-788">788</a></span>
<span class="normal"><a href="#__codelineno-0-789">789</a></span>
<span class="normal"><a href="#__codelineno-0-790">790</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-733" name="__codelineno-0-733"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">to_frontend</span><span class="p">(</span>
<a id="__codelineno-0-734" name="__codelineno-0-734"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-735" name="__codelineno-0-735"></a>    <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-736" name="__codelineno-0-736"></a>    <span class="n">conversation_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-737" name="__codelineno-0-737"></a>    <span class="n">query_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-738" name="__codelineno-0-738"></a><span class="p">):</span>
<a id="__codelineno-0-739" name="__codelineno-0-739"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-740" name="__codelineno-0-740"></a><span class="sd">    Convert the result to a frontend payload.</span>
<a id="__codelineno-0-741" name="__codelineno-0-741"></a><span class="sd">    This is a wrapper around the `to_json` method.</span>
<a id="__codelineno-0-742" name="__codelineno-0-742"></a><span class="sd">    But the objects and metadata are inside a `payload` key, which also includes a `type` key,</span>
<a id="__codelineno-0-743" name="__codelineno-0-743"></a><span class="sd">    being the frontend identifier for the type of payload being sent.</span>
<a id="__codelineno-0-744" name="__codelineno-0-744"></a><span class="sd">    (e.g. `ticket`, `product`, `message`, etc.)</span>
<a id="__codelineno-0-745" name="__codelineno-0-745"></a>
<a id="__codelineno-0-746" name="__codelineno-0-746"></a><span class="sd">    The outside of the payload also contains the user_id, conversation_id, and query_id.</span>
<a id="__codelineno-0-747" name="__codelineno-0-747"></a>
<a id="__codelineno-0-748" name="__codelineno-0-748"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-749" name="__codelineno-0-749"></a><span class="sd">        user_id (str): The user ID.</span>
<a id="__codelineno-0-750" name="__codelineno-0-750"></a><span class="sd">        conversation_id (str): The conversation ID.</span>
<a id="__codelineno-0-751" name="__codelineno-0-751"></a><span class="sd">        query_id (str): The query ID.</span>
<a id="__codelineno-0-752" name="__codelineno-0-752"></a>
<a id="__codelineno-0-753" name="__codelineno-0-753"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-754" name="__codelineno-0-754"></a><span class="sd">        (dict): The frontend payload, which is a dictionary with the following structure:</span>
<a id="__codelineno-0-755" name="__codelineno-0-755"></a><span class="sd">            ```python</span>
<a id="__codelineno-0-756" name="__codelineno-0-756"></a><span class="sd">            {</span>
<a id="__codelineno-0-757" name="__codelineno-0-757"></a><span class="sd">                &quot;type&quot;: &quot;result&quot;,</span>
<a id="__codelineno-0-758" name="__codelineno-0-758"></a><span class="sd">                &quot;user_id&quot;: str,</span>
<a id="__codelineno-0-759" name="__codelineno-0-759"></a><span class="sd">                &quot;conversation_id&quot;: str,</span>
<a id="__codelineno-0-760" name="__codelineno-0-760"></a><span class="sd">                &quot;query_id&quot;: str,</span>
<a id="__codelineno-0-761" name="__codelineno-0-761"></a><span class="sd">                &quot;id&quot;: str,</span>
<a id="__codelineno-0-762" name="__codelineno-0-762"></a><span class="sd">                &quot;payload&quot;: dict = {</span>
<a id="__codelineno-0-763" name="__codelineno-0-763"></a><span class="sd">                    &quot;type&quot;: str,</span>
<a id="__codelineno-0-764" name="__codelineno-0-764"></a><span class="sd">                    &quot;objects&quot;: list[dict],</span>
<a id="__codelineno-0-765" name="__codelineno-0-765"></a><span class="sd">                    &quot;metadata&quot;: dict,</span>
<a id="__codelineno-0-766" name="__codelineno-0-766"></a><span class="sd">                },</span>
<a id="__codelineno-0-767" name="__codelineno-0-767"></a><span class="sd">            }</span>
<a id="__codelineno-0-768" name="__codelineno-0-768"></a><span class="sd">            ```</span>
<a id="__codelineno-0-769" name="__codelineno-0-769"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-770" name="__codelineno-0-770"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="p">:</span>
<a id="__codelineno-0-771" name="__codelineno-0-771"></a>        <span class="k">return</span>
<a id="__codelineno-0-772" name="__codelineno-0-772"></a>
<a id="__codelineno-0-773" name="__codelineno-0-773"></a>    <span class="n">objects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="n">mapping</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-774" name="__codelineno-0-774"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">objects</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-775" name="__codelineno-0-775"></a>        <span class="k">return</span>
<a id="__codelineno-0-776" name="__codelineno-0-776"></a>
<a id="__codelineno-0-777" name="__codelineno-0-777"></a>    <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-778" name="__codelineno-0-778"></a>        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">payload_type</span><span class="p">,</span>
<a id="__codelineno-0-779" name="__codelineno-0-779"></a>        <span class="s2">&quot;objects&quot;</span><span class="p">:</span> <span class="n">objects</span><span class="p">,</span>
<a id="__codelineno-0-780" name="__codelineno-0-780"></a>        <span class="s2">&quot;metadata&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">,</span>
<a id="__codelineno-0-781" name="__codelineno-0-781"></a>    <span class="p">}</span>
<a id="__codelineno-0-782" name="__codelineno-0-782"></a>
<a id="__codelineno-0-783" name="__codelineno-0-783"></a>    <span class="k">return</span> <span class="p">{</span>
<a id="__codelineno-0-784" name="__codelineno-0-784"></a>        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">frontend_type</span><span class="p">,</span>
<a id="__codelineno-0-785" name="__codelineno-0-785"></a>        <span class="s2">&quot;user_id&quot;</span><span class="p">:</span> <span class="n">user_id</span><span class="p">,</span>
<a id="__codelineno-0-786" name="__codelineno-0-786"></a>        <span class="s2">&quot;conversation_id&quot;</span><span class="p">:</span> <span class="n">conversation_id</span><span class="p">,</span>
<a id="__codelineno-0-787" name="__codelineno-0-787"></a>        <span class="s2">&quot;query_id&quot;</span><span class="p">:</span> <span class="n">query_id</span><span class="p">,</span>
<a id="__codelineno-0-788" name="__codelineno-0-788"></a>        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">frontend_type</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;-&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()),</span>
<a id="__codelineno-0-789" name="__codelineno-0-789"></a>        <span class="s2">&quot;payload&quot;</span><span class="p">:</span> <span class="n">payload</span><span class="p">,</span>
<a id="__codelineno-0-790" name="__codelineno-0-790"></a>    <span class="p">}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="elysia.objects.Result.to_json" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_json</span><span class="p">(</span><span class="n">mapping</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Convert the result to a list of dictionaries.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>mapping</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to map the objects to the frontend.
This will use the <code>mapping</code> dictionary created on initialisation of the <code>Result</code> object.
If <code>False</code>, the objects are returned as is.
Defaults to <code>False</code>.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="dict">dict</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of dictionaries, which can be serialised to JSON.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>elysia/objects.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-704">704</a></span>
<span class="normal"><a href="#__codelineno-0-705">705</a></span>
<span class="normal"><a href="#__codelineno-0-706">706</a></span>
<span class="normal"><a href="#__codelineno-0-707">707</a></span>
<span class="normal"><a href="#__codelineno-0-708">708</a></span>
<span class="normal"><a href="#__codelineno-0-709">709</a></span>
<span class="normal"><a href="#__codelineno-0-710">710</a></span>
<span class="normal"><a href="#__codelineno-0-711">711</a></span>
<span class="normal"><a href="#__codelineno-0-712">712</a></span>
<span class="normal"><a href="#__codelineno-0-713">713</a></span>
<span class="normal"><a href="#__codelineno-0-714">714</a></span>
<span class="normal"><a href="#__codelineno-0-715">715</a></span>
<span class="normal"><a href="#__codelineno-0-716">716</a></span>
<span class="normal"><a href="#__codelineno-0-717">717</a></span>
<span class="normal"><a href="#__codelineno-0-718">718</a></span>
<span class="normal"><a href="#__codelineno-0-719">719</a></span>
<span class="normal"><a href="#__codelineno-0-720">720</a></span>
<span class="normal"><a href="#__codelineno-0-721">721</a></span>
<span class="normal"><a href="#__codelineno-0-722">722</a></span>
<span class="normal"><a href="#__codelineno-0-723">723</a></span>
<span class="normal"><a href="#__codelineno-0-724">724</a></span>
<span class="normal"><a href="#__codelineno-0-725">725</a></span>
<span class="normal"><a href="#__codelineno-0-726">726</a></span>
<span class="normal"><a href="#__codelineno-0-727">727</a></span>
<span class="normal"><a href="#__codelineno-0-728">728</a></span>
<span class="normal"><a href="#__codelineno-0-729">729</a></span>
<span class="normal"><a href="#__codelineno-0-730">730</a></span>
<span class="normal"><a href="#__codelineno-0-731">731</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-704" name="__codelineno-0-704"></a><span class="k">def</span><span class="w"> </span><span class="nf">to_json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mapping</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<a id="__codelineno-0-705" name="__codelineno-0-705"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-706" name="__codelineno-0-706"></a><span class="sd">    Convert the result to a list of dictionaries.</span>
<a id="__codelineno-0-707" name="__codelineno-0-707"></a>
<a id="__codelineno-0-708" name="__codelineno-0-708"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-709" name="__codelineno-0-709"></a><span class="sd">        mapping (bool): Whether to map the objects to the frontend.</span>
<a id="__codelineno-0-710" name="__codelineno-0-710"></a><span class="sd">            This will use the `mapping` dictionary created on initialisation of the `Result` object.</span>
<a id="__codelineno-0-711" name="__codelineno-0-711"></a><span class="sd">            If `False`, the objects are returned as is.</span>
<a id="__codelineno-0-712" name="__codelineno-0-712"></a><span class="sd">            Defaults to `False`.</span>
<a id="__codelineno-0-713" name="__codelineno-0-713"></a>
<a id="__codelineno-0-714" name="__codelineno-0-714"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-715" name="__codelineno-0-715"></a><span class="sd">        (list[dict]): A list of dictionaries, which can be serialised to JSON.</span>
<a id="__codelineno-0-716" name="__codelineno-0-716"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-717" name="__codelineno-0-717"></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">elysia.util.parsing</span><span class="w"> </span><span class="kn">import</span> <span class="n">format_dict_to_serialisable</span>
<a id="__codelineno-0-718" name="__codelineno-0-718"></a>
<a id="__codelineno-0-719" name="__codelineno-0-719"></a>    <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span>
<a id="__codelineno-0-720" name="__codelineno-0-720"></a>        <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects</span>
<a id="__codelineno-0-721" name="__codelineno-0-721"></a>    <span class="p">),</span> <span class="s2">&quot;All objects must be dictionaries&quot;</span>
<a id="__codelineno-0-722" name="__codelineno-0-722"></a>
<a id="__codelineno-0-723" name="__codelineno-0-723"></a>    <span class="k">if</span> <span class="n">mapping</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">mapping</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-724" name="__codelineno-0-724"></a>        <span class="n">output_objects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_mapping</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="p">)</span>
<a id="__codelineno-0-725" name="__codelineno-0-725"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-726" name="__codelineno-0-726"></a>        <span class="n">output_objects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects</span>
<a id="__codelineno-0-727" name="__codelineno-0-727"></a>
<a id="__codelineno-0-728" name="__codelineno-0-728"></a>    <span class="k">for</span> <span class="nb">object</span> <span class="ow">in</span> <span class="n">output_objects</span><span class="p">:</span>
<a id="__codelineno-0-729" name="__codelineno-0-729"></a>        <span class="n">format_dict_to_serialisable</span><span class="p">(</span><span class="nb">object</span><span class="p">)</span>
<a id="__codelineno-0-730" name="__codelineno-0-730"></a>
<a id="__codelineno-0-731" name="__codelineno-0-731"></a>    <span class="k">return</span> <span class="n">output_objects</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="elysia.objects.Retrieval" class="doc doc-heading">
            <code>Retrieval</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="Result (elysia.objects.Result)" href="#elysia.objects.Result">Result</a></code></p>


        <p>Store of returned objects from a query/aggregate/any displayed results.</p>








              <details class="quote">
                <summary>Source code in <code>elysia/objects.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-811">811</a></span>
<span class="normal"><a href="#__codelineno-0-812">812</a></span>
<span class="normal"><a href="#__codelineno-0-813">813</a></span>
<span class="normal"><a href="#__codelineno-0-814">814</a></span>
<span class="normal"><a href="#__codelineno-0-815">815</a></span>
<span class="normal"><a href="#__codelineno-0-816">816</a></span>
<span class="normal"><a href="#__codelineno-0-817">817</a></span>
<span class="normal"><a href="#__codelineno-0-818">818</a></span>
<span class="normal"><a href="#__codelineno-0-819">819</a></span>
<span class="normal"><a href="#__codelineno-0-820">820</a></span>
<span class="normal"><a href="#__codelineno-0-821">821</a></span>
<span class="normal"><a href="#__codelineno-0-822">822</a></span>
<span class="normal"><a href="#__codelineno-0-823">823</a></span>
<span class="normal"><a href="#__codelineno-0-824">824</a></span>
<span class="normal"><a href="#__codelineno-0-825">825</a></span>
<span class="normal"><a href="#__codelineno-0-826">826</a></span>
<span class="normal"><a href="#__codelineno-0-827">827</a></span>
<span class="normal"><a href="#__codelineno-0-828">828</a></span>
<span class="normal"><a href="#__codelineno-0-829">829</a></span>
<span class="normal"><a href="#__codelineno-0-830">830</a></span>
<span class="normal"><a href="#__codelineno-0-831">831</a></span>
<span class="normal"><a href="#__codelineno-0-832">832</a></span>
<span class="normal"><a href="#__codelineno-0-833">833</a></span>
<span class="normal"><a href="#__codelineno-0-834">834</a></span>
<span class="normal"><a href="#__codelineno-0-835">835</a></span>
<span class="normal"><a href="#__codelineno-0-836">836</a></span>
<span class="normal"><a href="#__codelineno-0-837">837</a></span>
<span class="normal"><a href="#__codelineno-0-838">838</a></span>
<span class="normal"><a href="#__codelineno-0-839">839</a></span>
<span class="normal"><a href="#__codelineno-0-840">840</a></span>
<span class="normal"><a href="#__codelineno-0-841">841</a></span>
<span class="normal"><a href="#__codelineno-0-842">842</a></span>
<span class="normal"><a href="#__codelineno-0-843">843</a></span>
<span class="normal"><a href="#__codelineno-0-844">844</a></span>
<span class="normal"><a href="#__codelineno-0-845">845</a></span>
<span class="normal"><a href="#__codelineno-0-846">846</a></span>
<span class="normal"><a href="#__codelineno-0-847">847</a></span>
<span class="normal"><a href="#__codelineno-0-848">848</a></span>
<span class="normal"><a href="#__codelineno-0-849">849</a></span>
<span class="normal"><a href="#__codelineno-0-850">850</a></span>
<span class="normal"><a href="#__codelineno-0-851">851</a></span>
<span class="normal"><a href="#__codelineno-0-852">852</a></span>
<span class="normal"><a href="#__codelineno-0-853">853</a></span>
<span class="normal"><a href="#__codelineno-0-854">854</a></span>
<span class="normal"><a href="#__codelineno-0-855">855</a></span>
<span class="normal"><a href="#__codelineno-0-856">856</a></span>
<span class="normal"><a href="#__codelineno-0-857">857</a></span>
<span class="normal"><a href="#__codelineno-0-858">858</a></span>
<span class="normal"><a href="#__codelineno-0-859">859</a></span>
<span class="normal"><a href="#__codelineno-0-860">860</a></span>
<span class="normal"><a href="#__codelineno-0-861">861</a></span>
<span class="normal"><a href="#__codelineno-0-862">862</a></span>
<span class="normal"><a href="#__codelineno-0-863">863</a></span>
<span class="normal"><a href="#__codelineno-0-864">864</a></span>
<span class="normal"><a href="#__codelineno-0-865">865</a></span>
<span class="normal"><a href="#__codelineno-0-866">866</a></span>
<span class="normal"><a href="#__codelineno-0-867">867</a></span>
<span class="normal"><a href="#__codelineno-0-868">868</a></span>
<span class="normal"><a href="#__codelineno-0-869">869</a></span>
<span class="normal"><a href="#__codelineno-0-870">870</a></span>
<span class="normal"><a href="#__codelineno-0-871">871</a></span>
<span class="normal"><a href="#__codelineno-0-872">872</a></span>
<span class="normal"><a href="#__codelineno-0-873">873</a></span>
<span class="normal"><a href="#__codelineno-0-874">874</a></span>
<span class="normal"><a href="#__codelineno-0-875">875</a></span>
<span class="normal"><a href="#__codelineno-0-876">876</a></span>
<span class="normal"><a href="#__codelineno-0-877">877</a></span>
<span class="normal"><a href="#__codelineno-0-878">878</a></span>
<span class="normal"><a href="#__codelineno-0-879">879</a></span>
<span class="normal"><a href="#__codelineno-0-880">880</a></span>
<span class="normal"><a href="#__codelineno-0-881">881</a></span>
<span class="normal"><a href="#__codelineno-0-882">882</a></span>
<span class="normal"><a href="#__codelineno-0-883">883</a></span>
<span class="normal"><a href="#__codelineno-0-884">884</a></span>
<span class="normal"><a href="#__codelineno-0-885">885</a></span>
<span class="normal"><a href="#__codelineno-0-886">886</a></span>
<span class="normal"><a href="#__codelineno-0-887">887</a></span>
<span class="normal"><a href="#__codelineno-0-888">888</a></span>
<span class="normal"><a href="#__codelineno-0-889">889</a></span>
<span class="normal"><a href="#__codelineno-0-890">890</a></span>
<span class="normal"><a href="#__codelineno-0-891">891</a></span>
<span class="normal"><a href="#__codelineno-0-892">892</a></span>
<span class="normal"><a href="#__codelineno-0-893">893</a></span>
<span class="normal"><a href="#__codelineno-0-894">894</a></span>
<span class="normal"><a href="#__codelineno-0-895">895</a></span>
<span class="normal"><a href="#__codelineno-0-896">896</a></span>
<span class="normal"><a href="#__codelineno-0-897">897</a></span>
<span class="normal"><a href="#__codelineno-0-898">898</a></span>
<span class="normal"><a href="#__codelineno-0-899">899</a></span>
<span class="normal"><a href="#__codelineno-0-900">900</a></span>
<span class="normal"><a href="#__codelineno-0-901">901</a></span>
<span class="normal"><a href="#__codelineno-0-902">902</a></span>
<span class="normal"><a href="#__codelineno-0-903">903</a></span>
<span class="normal"><a href="#__codelineno-0-904">904</a></span>
<span class="normal"><a href="#__codelineno-0-905">905</a></span>
<span class="normal"><a href="#__codelineno-0-906">906</a></span>
<span class="normal"><a href="#__codelineno-0-907">907</a></span>
<span class="normal"><a href="#__codelineno-0-908">908</a></span>
<span class="normal"><a href="#__codelineno-0-909">909</a></span>
<span class="normal"><a href="#__codelineno-0-910">910</a></span>
<span class="normal"><a href="#__codelineno-0-911">911</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-811" name="__codelineno-0-811"></a><span class="k">class</span><span class="w"> </span><span class="nc">Retrieval</span><span class="p">(</span><span class="n">Result</span><span class="p">):</span>
<a id="__codelineno-0-812" name="__codelineno-0-812"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-813" name="__codelineno-0-813"></a><span class="sd">    Store of returned objects from a query/aggregate/any displayed results.</span>
<a id="__codelineno-0-814" name="__codelineno-0-814"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-815" name="__codelineno-0-815"></a>
<a id="__codelineno-0-816" name="__codelineno-0-816"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-817" name="__codelineno-0-817"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-818" name="__codelineno-0-818"></a>        <span class="n">objects</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">],</span>
<a id="__codelineno-0-819" name="__codelineno-0-819"></a>        <span class="n">metadata</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
<a id="__codelineno-0-820" name="__codelineno-0-820"></a>        <span class="n">payload_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;default&quot;</span><span class="p">,</span>
<a id="__codelineno-0-821" name="__codelineno-0-821"></a>        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-822" name="__codelineno-0-822"></a>        <span class="n">mapping</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-823" name="__codelineno-0-823"></a>        <span class="n">unmapped_keys</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-824" name="__codelineno-0-824"></a>            <span class="s2">&quot;uuid&quot;</span><span class="p">,</span>
<a id="__codelineno-0-825" name="__codelineno-0-825"></a>            <span class="s2">&quot;ELYSIA_SUMMARY&quot;</span><span class="p">,</span>
<a id="__codelineno-0-826" name="__codelineno-0-826"></a>            <span class="s2">&quot;collection_name&quot;</span><span class="p">,</span>
<a id="__codelineno-0-827" name="__codelineno-0-827"></a>            <span class="s2">&quot;_REF_ID&quot;</span><span class="p">,</span>
<a id="__codelineno-0-828" name="__codelineno-0-828"></a>        <span class="p">],</span>
<a id="__codelineno-0-829" name="__codelineno-0-829"></a>        <span class="n">display</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-830" name="__codelineno-0-830"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-831" name="__codelineno-0-831"></a>        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="s2">&quot;collection_name&quot;</span> <span class="ow">in</span> <span class="n">metadata</span><span class="p">:</span>
<a id="__codelineno-0-832" name="__codelineno-0-832"></a>            <span class="n">result_name</span> <span class="o">=</span> <span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;collection_name&quot;</span><span class="p">]</span>
<a id="__codelineno-0-833" name="__codelineno-0-833"></a>        <span class="k">elif</span> <span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-834" name="__codelineno-0-834"></a>            <span class="n">result_name</span> <span class="o">=</span> <span class="s2">&quot;default&quot;</span>
<a id="__codelineno-0-835" name="__codelineno-0-835"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-836" name="__codelineno-0-836"></a>            <span class="n">result_name</span> <span class="o">=</span> <span class="n">name</span>
<a id="__codelineno-0-837" name="__codelineno-0-837"></a>
<a id="__codelineno-0-838" name="__codelineno-0-838"></a>        <span class="n">Result</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-839" name="__codelineno-0-839"></a>            <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-840" name="__codelineno-0-840"></a>            <span class="n">objects</span><span class="o">=</span><span class="n">objects</span><span class="p">,</span>
<a id="__codelineno-0-841" name="__codelineno-0-841"></a>            <span class="n">payload_type</span><span class="o">=</span><span class="n">payload_type</span><span class="p">,</span>
<a id="__codelineno-0-842" name="__codelineno-0-842"></a>            <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">,</span>
<a id="__codelineno-0-843" name="__codelineno-0-843"></a>            <span class="n">name</span><span class="o">=</span><span class="n">result_name</span><span class="p">,</span>
<a id="__codelineno-0-844" name="__codelineno-0-844"></a>            <span class="n">mapping</span><span class="o">=</span><span class="n">mapping</span><span class="p">,</span>
<a id="__codelineno-0-845" name="__codelineno-0-845"></a>            <span class="n">unmapped_keys</span><span class="o">=</span><span class="n">unmapped_keys</span><span class="p">,</span>
<a id="__codelineno-0-846" name="__codelineno-0-846"></a>            <span class="n">display</span><span class="o">=</span><span class="n">display</span><span class="p">,</span>
<a id="__codelineno-0-847" name="__codelineno-0-847"></a>        <span class="p">)</span>
<a id="__codelineno-0-848" name="__codelineno-0-848"></a>
<a id="__codelineno-0-849" name="__codelineno-0-849"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">add_summaries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">summaries</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-850" name="__codelineno-0-850"></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">obj</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="p">):</span>
<a id="__codelineno-0-851" name="__codelineno-0-851"></a>            <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">summaries</span><span class="p">):</span>
<a id="__codelineno-0-852" name="__codelineno-0-852"></a>                <span class="n">obj</span><span class="p">[</span><span class="s2">&quot;ELYSIA_SUMMARY&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">summaries</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<a id="__codelineno-0-853" name="__codelineno-0-853"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-854" name="__codelineno-0-854"></a>                <span class="n">obj</span><span class="p">[</span><span class="s2">&quot;ELYSIA_SUMMARY&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-0-855" name="__codelineno-0-855"></a>
<a id="__codelineno-0-856" name="__codelineno-0-856"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">llm_parse</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-857" name="__codelineno-0-857"></a>        <span class="n">out</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-0-858" name="__codelineno-0-858"></a>        <span class="n">count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="p">)</span>
<a id="__codelineno-0-859" name="__codelineno-0-859"></a>
<a id="__codelineno-0-860" name="__codelineno-0-860"></a>        <span class="k">if</span> <span class="s2">&quot;collection_name&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">:</span>
<a id="__codelineno-0-861" name="__codelineno-0-861"></a>            <span class="k">if</span> <span class="n">count</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-862" name="__codelineno-0-862"></a>                <span class="n">out</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Queried collection: &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;collection_name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39; and returned </span><span class="si">{</span><span class="n">count</span><span class="si">}</span><span class="s2"> objects, &quot;</span>
<a id="__codelineno-0-863" name="__codelineno-0-863"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-864" name="__codelineno-0-864"></a>                <span class="n">out</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Queried collection: &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;collection_name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39; but no objects were returned.&quot;</span>
<a id="__codelineno-0-865" name="__codelineno-0-865"></a>                <span class="n">out</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; Since it had no objects, judge the query that was created, and evaluate whether it was appropriate for the collection, the user prompt, and the data available.&quot;</span>
<a id="__codelineno-0-866" name="__codelineno-0-866"></a>                <span class="n">out</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; If it seemed innappropriate, you can choose to try again if you think it can still be completed (or there is more to do).&quot;</span>
<a id="__codelineno-0-867" name="__codelineno-0-867"></a>        <span class="k">if</span> <span class="s2">&quot;return_type&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">:</span>
<a id="__codelineno-0-868" name="__codelineno-0-868"></a>            <span class="n">out</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Returned with type &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;return_type&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39;, &quot;</span>
<a id="__codelineno-0-869" name="__codelineno-0-869"></a>        <span class="k">if</span> <span class="s2">&quot;output_type&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">:</span>
<a id="__codelineno-0-870" name="__codelineno-0-870"></a>            <span class="n">out</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">outputted &#39;</span><span class="si">{</span><span class="s1">&#39;itemised summaries&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;output_type&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;summary&#39;</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;original objects&#39;</span><span class="si">}</span><span class="s2">&#39;</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-871" name="__codelineno-0-871"></a>        <span class="k">if</span> <span class="s2">&quot;query_text&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">:</span>
<a id="__codelineno-0-872" name="__codelineno-0-872"></a>            <span class="n">out</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Search terms: &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;query_text&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
<a id="__codelineno-0-873" name="__codelineno-0-873"></a>        <span class="k">if</span> <span class="s2">&quot;query_type&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">:</span>
<a id="__codelineno-0-874" name="__codelineno-0-874"></a>            <span class="n">out</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Type of query: &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;query_type&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
<a id="__codelineno-0-875" name="__codelineno-0-875"></a>        <span class="k">if</span> <span class="s2">&quot;impossible&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">:</span>
<a id="__codelineno-0-876" name="__codelineno-0-876"></a>            <span class="n">out</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Impossible prompt: &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;impossible&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
<a id="__codelineno-0-877" name="__codelineno-0-877"></a>            <span class="k">if</span> <span class="s2">&quot;collection_name&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">:</span>
<a id="__codelineno-0-878" name="__codelineno-0-878"></a>                <span class="n">out</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">This attempt at querying the collection: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;collection_name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> was deemed impossible.&quot;</span>
<a id="__codelineno-0-879" name="__codelineno-0-879"></a>            <span class="k">if</span> <span class="s2">&quot;impossible_reason&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">:</span>
<a id="__codelineno-0-880" name="__codelineno-0-880"></a>                <span class="n">out</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Reasoning for impossibility: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;impossible_reason&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-881" name="__codelineno-0-881"></a>        <span class="k">if</span> <span class="s2">&quot;query_output&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">:</span>
<a id="__codelineno-0-882" name="__codelineno-0-882"></a>            <span class="n">out</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">The query used was:</span><span class="se">\n</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;query_output&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-883" name="__codelineno-0-883"></a>        <span class="k">return</span> <span class="n">out</span>
<a id="__codelineno-0-884" name="__codelineno-0-884"></a>
<a id="__codelineno-0-885" name="__codelineno-0-885"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">to_frontend</span><span class="p">(</span>
<a id="__codelineno-0-886" name="__codelineno-0-886"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-887" name="__codelineno-0-887"></a>        <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-888" name="__codelineno-0-888"></a>        <span class="n">conversation_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-889" name="__codelineno-0-889"></a>        <span class="n">query_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-890" name="__codelineno-0-890"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-891" name="__codelineno-0-891"></a>        <span class="n">objects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="n">mapping</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-892" name="__codelineno-0-892"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">objects</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-893" name="__codelineno-0-893"></a>            <span class="k">return</span>
<a id="__codelineno-0-894" name="__codelineno-0-894"></a>
<a id="__codelineno-0-895" name="__codelineno-0-895"></a>        <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-896" name="__codelineno-0-896"></a>            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">payload_type</span><span class="p">,</span>
<a id="__codelineno-0-897" name="__codelineno-0-897"></a>            <span class="s2">&quot;objects&quot;</span><span class="p">:</span> <span class="n">objects</span><span class="p">,</span>
<a id="__codelineno-0-898" name="__codelineno-0-898"></a>            <span class="s2">&quot;metadata&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">,</span>
<a id="__codelineno-0-899" name="__codelineno-0-899"></a>        <span class="p">}</span>
<a id="__codelineno-0-900" name="__codelineno-0-900"></a>
<a id="__codelineno-0-901" name="__codelineno-0-901"></a>        <span class="k">if</span> <span class="s2">&quot;code&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">:</span>
<a id="__codelineno-0-902" name="__codelineno-0-902"></a>            <span class="n">payload</span><span class="p">[</span><span class="s2">&quot;code&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;code&quot;</span><span class="p">]</span>
<a id="__codelineno-0-903" name="__codelineno-0-903"></a>
<a id="__codelineno-0-904" name="__codelineno-0-904"></a>        <span class="k">return</span> <span class="p">{</span>
<a id="__codelineno-0-905" name="__codelineno-0-905"></a>            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">frontend_type</span><span class="p">,</span>
<a id="__codelineno-0-906" name="__codelineno-0-906"></a>            <span class="s2">&quot;user_id&quot;</span><span class="p">:</span> <span class="n">user_id</span><span class="p">,</span>
<a id="__codelineno-0-907" name="__codelineno-0-907"></a>            <span class="s2">&quot;conversation_id&quot;</span><span class="p">:</span> <span class="n">conversation_id</span><span class="p">,</span>
<a id="__codelineno-0-908" name="__codelineno-0-908"></a>            <span class="s2">&quot;query_id&quot;</span><span class="p">:</span> <span class="n">query_id</span><span class="p">,</span>
<a id="__codelineno-0-909" name="__codelineno-0-909"></a>            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">frontend_type</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;-&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()),</span>
<a id="__codelineno-0-910" name="__codelineno-0-910"></a>            <span class="s2">&quot;payload&quot;</span><span class="p">:</span> <span class="n">payload</span><span class="p">,</span>
<a id="__codelineno-0-911" name="__codelineno-0-911"></a>        <span class="p">}</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="elysia.objects.Return" class="doc doc-heading">
            <code>Return</code>


</h2>


    <div class="doc doc-contents ">


        <p>A Return object is something that is returned to the frontend.
This kind of object is frontend-aware.</p>








              <details class="quote">
                <summary>Source code in <code>elysia/objects.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-463" name="__codelineno-0-463"></a><span class="k">class</span><span class="w"> </span><span class="nc">Return</span><span class="p">:</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a><span class="sd">    A Return object is something that is returned to the frontend.</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a><span class="sd">    This kind of object is frontend-aware.</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frontend_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">payload_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">frontend_type</span> <span class="o">=</span> <span class="n">frontend_type</span>  <span class="c1"># frontend identifier</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">payload_type</span> <span class="o">=</span> <span class="n">payload_type</span>  <span class="c1"># backend identifier</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="elysia.objects.Status" class="doc doc-heading">
            <code>Status</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="Update (elysia.objects.Update)" href="#elysia.objects.Update">Update</a></code></p>


        <p>Status message to be sent to the frontend for real-time updates in words.</p>








              <details class="quote">
                <summary>Source code in <code>elysia/objects.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-577">577</a></span>
<span class="normal"><a href="#__codelineno-0-578">578</a></span>
<span class="normal"><a href="#__codelineno-0-579">579</a></span>
<span class="normal"><a href="#__codelineno-0-580">580</a></span>
<span class="normal"><a href="#__codelineno-0-581">581</a></span>
<span class="normal"><a href="#__codelineno-0-582">582</a></span>
<span class="normal"><a href="#__codelineno-0-583">583</a></span>
<span class="normal"><a href="#__codelineno-0-584">584</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-577" name="__codelineno-0-577"></a><span class="k">class</span><span class="w"> </span><span class="nc">Status</span><span class="p">(</span><span class="n">Update</span><span class="p">):</span>
<a id="__codelineno-0-578" name="__codelineno-0-578"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-579" name="__codelineno-0-579"></a><span class="sd">    Status message to be sent to the frontend for real-time updates in words.</span>
<a id="__codelineno-0-580" name="__codelineno-0-580"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-581" name="__codelineno-0-581"></a>
<a id="__codelineno-0-582" name="__codelineno-0-582"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-583" name="__codelineno-0-583"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">text</span>
<a id="__codelineno-0-584" name="__codelineno-0-584"></a>        <span class="n">Update</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;status&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="n">text</span><span class="p">})</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="elysia.objects.Text" class="doc doc-heading">
            <code>Text</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="Return (elysia.objects.Return)" href="#elysia.objects.Return">Return</a></code></p>


        <p>Frontend Return Type 1: Text
Objects is usually a one-element list containing a dict with a "text" key only.
But is not limited to this.</p>








              <details class="quote">
                <summary>Source code in <code>elysia/objects.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span>
<span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span>
<span class="normal"><a href="#__codelineno-0-506">506</a></span>
<span class="normal"><a href="#__codelineno-0-507">507</a></span>
<span class="normal"><a href="#__codelineno-0-508">508</a></span>
<span class="normal"><a href="#__codelineno-0-509">509</a></span>
<span class="normal"><a href="#__codelineno-0-510">510</a></span>
<span class="normal"><a href="#__codelineno-0-511">511</a></span>
<span class="normal"><a href="#__codelineno-0-512">512</a></span>
<span class="normal"><a href="#__codelineno-0-513">513</a></span>
<span class="normal"><a href="#__codelineno-0-514">514</a></span>
<span class="normal"><a href="#__codelineno-0-515">515</a></span>
<span class="normal"><a href="#__codelineno-0-516">516</a></span>
<span class="normal"><a href="#__codelineno-0-517">517</a></span>
<span class="normal"><a href="#__codelineno-0-518">518</a></span>
<span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span>
<span class="normal"><a href="#__codelineno-0-523">523</a></span>
<span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span>
<span class="normal"><a href="#__codelineno-0-528">528</a></span>
<span class="normal"><a href="#__codelineno-0-529">529</a></span>
<span class="normal"><a href="#__codelineno-0-530">530</a></span>
<span class="normal"><a href="#__codelineno-0-531">531</a></span>
<span class="normal"><a href="#__codelineno-0-532">532</a></span>
<span class="normal"><a href="#__codelineno-0-533">533</a></span>
<span class="normal"><a href="#__codelineno-0-534">534</a></span>
<span class="normal"><a href="#__codelineno-0-535">535</a></span>
<span class="normal"><a href="#__codelineno-0-536">536</a></span>
<span class="normal"><a href="#__codelineno-0-537">537</a></span>
<span class="normal"><a href="#__codelineno-0-538">538</a></span>
<span class="normal"><a href="#__codelineno-0-539">539</a></span>
<span class="normal"><a href="#__codelineno-0-540">540</a></span>
<span class="normal"><a href="#__codelineno-0-541">541</a></span>
<span class="normal"><a href="#__codelineno-0-542">542</a></span>
<span class="normal"><a href="#__codelineno-0-543">543</a></span>
<span class="normal"><a href="#__codelineno-0-544">544</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-474" name="__codelineno-0-474"></a><span class="k">class</span><span class="w"> </span><span class="nc">Text</span><span class="p">(</span><span class="n">Return</span><span class="p">):</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a><span class="sd">    Frontend Return Type 1: Text</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a><span class="sd">    Objects is usually a one-element list containing a dict with a &quot;text&quot; key only.</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a><span class="sd">    But is not limited to this.</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a>        <span class="n">payload_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a>        <span class="n">objects</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">],</span>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a>        <span class="n">metadata</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a>        <span class="n">display</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a>    <span class="p">):</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a>        <span class="n">Return</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="n">payload_type</span><span class="p">)</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">objects</span> <span class="o">=</span> <span class="n">objects</span>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span> <span class="o">=</span> <span class="n">metadata</span>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_concat_text</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="p">)</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">display</span> <span class="o">=</span> <span class="n">display</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_concat_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">objects</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">]):</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a>        <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">obj</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">objects</span><span class="p">):</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a>            <span class="k">if</span> <span class="s2">&quot;text&quot;</span> <span class="ow">in</span> <span class="n">obj</span><span class="p">:</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a>                <span class="n">spacer</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a>                <span class="k">if</span> <span class="p">(</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a>                    <span class="ow">not</span> <span class="n">obj</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a>                    <span class="ow">and</span> <span class="ow">not</span> <span class="n">obj</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a>                    <span class="ow">and</span> <span class="n">i</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">objects</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a>                <span class="p">):</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a>                    <span class="n">spacer</span> <span class="o">+=</span> <span class="s2">&quot; &quot;</span>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a>                <span class="k">if</span> <span class="p">(</span>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a>                    <span class="n">i</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">objects</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a>                    <span class="ow">and</span> <span class="s2">&quot;text&quot;</span> <span class="ow">in</span> <span class="n">objects</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a>                    <span class="ow">and</span> <span class="n">objects</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="s2">&quot;text&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;* &quot;</span><span class="p">)</span>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a>                    <span class="ow">and</span> <span class="ow">not</span> <span class="n">obj</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a>                <span class="p">):</span>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a>                    <span class="n">spacer</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a>                <span class="n">text</span> <span class="o">+=</span> <span class="n">obj</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">spacer</span>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a>        <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_REF_ID&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a>        <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;REF_ID&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a>        <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;  &quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a>        <span class="k">return</span> <span class="n">text</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">to_json</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a>        <span class="k">return</span> <span class="p">{</span>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a>            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">payload_type</span><span class="p">,</span>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a>            <span class="s2">&quot;metadata&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">,</span>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a>            <span class="s2">&quot;objects&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="p">,</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a>        <span class="p">}</span>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">to_frontend</span><span class="p">(</span>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a>        <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a>        <span class="n">conversation_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-532" name="__codelineno-0-532"></a>        <span class="n">query_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a>    <span class="p">):</span>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="p">:</span>
<a id="__codelineno-0-535" name="__codelineno-0-535"></a>            <span class="k">return</span>
<a id="__codelineno-0-536" name="__codelineno-0-536"></a>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a>        <span class="k">return</span> <span class="p">{</span>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a>            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">frontend_type</span><span class="p">,</span>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a>            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">frontend_type</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;-&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()),</span>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a>            <span class="s2">&quot;user_id&quot;</span><span class="p">:</span> <span class="n">user_id</span><span class="p">,</span>
<a id="__codelineno-0-541" name="__codelineno-0-541"></a>            <span class="s2">&quot;conversation_id&quot;</span><span class="p">:</span> <span class="n">conversation_id</span><span class="p">,</span>
<a id="__codelineno-0-542" name="__codelineno-0-542"></a>            <span class="s2">&quot;query_id&quot;</span><span class="p">:</span> <span class="n">query_id</span><span class="p">,</span>
<a id="__codelineno-0-543" name="__codelineno-0-543"></a>            <span class="s2">&quot;payload&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_json</span><span class="p">(),</span>
<a id="__codelineno-0-544" name="__codelineno-0-544"></a>        <span class="p">}</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="elysia.objects.Tool" class="doc doc-heading">
            <code>Tool</code>


</h2>


    <div class="doc doc-contents ">


        <p>The generic Tool class, which will be a superclass of any tools used by Elysia.</p>








              <details class="quote">
                <summary>Source code in <code>elysia/objects.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="k">class</span><span class="w"> </span><span class="nc">Tool</span><span class="p">(</span><span class="n">metaclass</span><span class="o">=</span><span class="n">ToolMeta</span><span class="p">):</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="sd">    The generic Tool class, which will be a superclass of any tools used by Elysia.</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>    <span class="nd">@classmethod</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_metadata</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">bool</span> <span class="o">|</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]:</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get tool metadata without instantiation.&quot;&quot;&quot;</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>        <span class="k">return</span> <span class="p">{</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="s2">&quot;_tool_name&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="s2">&quot;_tool_description&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>            <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="s2">&quot;_tool_inputs&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>            <span class="s2">&quot;end&quot;</span><span class="p">:</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="s2">&quot;_tool_end&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>        <span class="p">}</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>        <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>        <span class="n">status</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>        <span class="n">inputs</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>        <span class="n">end</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>    <span class="p">):</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="sd">            name (str): The name of the tool. Required.</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="sd">            description (str): A detailed description of the tool to give to the LLM. Required.</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="sd">            status (str): A status update message to display while the tool is running. Optional, defaults to &quot;Running {name}...&quot;.</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">            inputs (dict): A dictionary of inputs for the tool, with the following structure:</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">                ```python</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="sd">                {</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">                    input_name: {</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="sd">                        &quot;description&quot;: str,</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="sd">                        &quot;type&quot;: str,</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="sd">                        &quot;default&quot;: str,</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">                        &quot;required&quot;: bool</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">                    }</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">                }</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="sd">                ```</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="sd">            end (bool): Whether the tool is an end tool. Optional, defaults to False.</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="n">description</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">inputs</span> <span class="o">=</span> <span class="n">inputs</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">end</span> <span class="o">=</span> <span class="n">end</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>        <span class="k">if</span> <span class="n">status</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Running </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">...&quot;</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="n">status</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_default_inputs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>        <span class="k">return</span> <span class="p">{</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>            <span class="n">key</span><span class="p">:</span> <span class="n">value</span><span class="p">[</span><span class="s2">&quot;default&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;default&quot;</span> <span class="ow">in</span> <span class="n">value</span> <span class="k">else</span> <span class="kc">None</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>        <span class="p">}</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">run_if_true</span><span class="p">(</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>        <span class="n">tree_data</span><span class="p">,</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>        <span class="n">base_lm</span><span class="p">,</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>        <span class="n">complex_lm</span><span class="p">,</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>        <span class="n">client_manager</span><span class="p">,</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]:</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="sd">        This method is called to check if the tool should be run automatically.</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">        If this returns `True`, then the tool is immediately called at the start of the tree.</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">        Otherwise it does not appear in the decision tree.</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="sd">        You must also return a dictionary of inputs for the tool, which will be used to call the tool if `True` is returned.</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">        If the inputs are None or an empty dictionary, then the default inputs will be used.</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a><span class="sd">        This must be an async function.</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="sd">            tree_data (TreeData): The tree data object.</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a><span class="sd">            base_lm (LM): The base language model, a dspy.LM object.</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a><span class="sd">            complex_lm (LM): The complex language model, a dspy.LM object.</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a><span class="sd">            client_manager (ClientManager): The client manager, a way of interfacing with a Weaviate client.</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a><span class="sd">            bool: True if the tool should be run automatically, False otherwise.</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a><span class="sd">            dict: A dictionary of inputs for the tool, with the following structure:</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a><span class="sd">                ```python</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a><span class="sd">                {</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a><span class="sd">                    input_name: input_value</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a><span class="sd">                }</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="sd">                ```</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>        <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="p">{}</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">is_tool_available</span><span class="p">(</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>        <span class="n">tree_data</span><span class="p">,</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>        <span class="n">base_lm</span><span class="p">,</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>        <span class="n">complex_lm</span><span class="p">,</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>        <span class="n">client_manager</span><span class="p">,</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="sd">        This method is called to check if the tool is available.</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="sd">        If this returns `True`, then the tool is available to be used by the LLM.</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a><span class="sd">        Otherwise it does not appear in the decision tree.</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a><span class="sd">        The difference between this and `run_if_true` is that `run_if_true` will _always_ run the __call__ method if it returns `True`,</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a><span class="sd">        even if the LLM does not choose to use the tool.</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="sd">        This must be an async function.</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a><span class="sd">            tree_data (TreeData): The tree data object.</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a><span class="sd">            base_lm (LM): The base language model, a dspy.LM object.</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a><span class="sd">            complex_lm (LM): The complex language model, a dspy.LM object.</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a><span class="sd">            client_manager (ClientManager): The client manager, a way of interfacing with a Weaviate client.</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a><span class="sd">            bool: True if the tool is available, False otherwise.</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>        <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">tree_data</span><span class="p">,</span> <span class="n">inputs</span><span class="p">,</span> <span class="n">base_lm</span><span class="p">,</span> <span class="n">complex_lm</span><span class="p">,</span> <span class="n">client_manager</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AsyncGenerator</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a><span class="sd">        This method is called to run the tool.</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a><span class="sd">        This must be an async generator, so objects must be yielded and not returned.</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a><span class="sd">            tree_data (TreeData): The data from the decision tree, includes the environment, user prompt, etc.</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a><span class="sd">                See the `TreeData` class for more details.</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a><span class="sd">            base_lm (LM): The base language model, a dspy.LM object.</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a><span class="sd">            complex_lm (LM): The complex language model, a dspy.LM object.</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a><span class="sd">            client_manager (ClientManager): The client manager, a way of interfacing with a Weaviate client.</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>        <span class="k">yield</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="elysia.objects.Tool.__call__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">tree_data</span><span class="p">,</span> <span class="n">inputs</span><span class="p">,</span> <span class="n">base_lm</span><span class="p">,</span> <span class="n">complex_lm</span><span class="p">,</span> <span class="n">client_manager</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>This method is called to run the tool.</p>
<p>This must be an async generator, so objects must be yielded and not returned.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>tree_data</code>
            </td>
            <td>
                  <code><span title="TreeData">TreeData</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The data from the decision tree, includes the environment, user prompt, etc.
See the <code>TreeData</code> class for more details.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>base_lm</code>
            </td>
            <td>
                  <code><span title="LM">LM</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The base language model, a dspy.LM object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>complex_lm</code>
            </td>
            <td>
                  <code><span title="LM">LM</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The complex language model, a dspy.LM object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>client_manager</code>
            </td>
            <td>
                  <code><span title="ClientManager">ClientManager</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The client manager, a way of interfacing with a Weaviate client.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>elysia/objects.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-217" name="__codelineno-0-217"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">tree_data</span><span class="p">,</span> <span class="n">inputs</span><span class="p">,</span> <span class="n">base_lm</span><span class="p">,</span> <span class="n">complex_lm</span><span class="p">,</span> <span class="n">client_manager</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AsyncGenerator</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a><span class="sd">    This method is called to run the tool.</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a><span class="sd">    This must be an async generator, so objects must be yielded and not returned.</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a><span class="sd">        tree_data (TreeData): The data from the decision tree, includes the environment, user prompt, etc.</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a><span class="sd">            See the `TreeData` class for more details.</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a><span class="sd">        base_lm (LM): The base language model, a dspy.LM object.</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a><span class="sd">        complex_lm (LM): The complex language model, a dspy.LM object.</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a><span class="sd">        client_manager (ClientManager): The client manager, a way of interfacing with a Weaviate client.</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>    <span class="k">yield</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="elysia.objects.Tool.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="p">{},</span> <span class="n">end</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">



<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the tool. Required.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>description</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A detailed description of the tool to give to the LLM. Required.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>status</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A status update message to display while the tool is running. Optional, defaults to "Running {name}...".</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>inputs</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary of inputs for the tool, with the following structure:
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="p">{</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">input_name</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>        <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>        <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="nb">bool</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>    <span class="p">}</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="p">}</span>
</code></pre></div></p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>end</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the tool is an end tool. Optional, defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>elysia/objects.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>    <span class="n">status</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>    <span class="n">inputs</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>    <span class="n">end</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="p">):</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="sd">        name (str): The name of the tool. Required.</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="sd">        description (str): A detailed description of the tool to give to the LLM. Required.</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="sd">        status (str): A status update message to display while the tool is running. Optional, defaults to &quot;Running {name}...&quot;.</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">        inputs (dict): A dictionary of inputs for the tool, with the following structure:</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">            ```python</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="sd">            {</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">                input_name: {</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="sd">                    &quot;description&quot;: str,</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="sd">                    &quot;type&quot;: str,</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="sd">                    &quot;default&quot;: str,</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">                    &quot;required&quot;: bool</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">                }</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">            }</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="sd">            ```</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="sd">        end (bool): Whether the tool is an end tool. Optional, defaults to False.</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="n">description</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">inputs</span> <span class="o">=</span> <span class="n">inputs</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">end</span> <span class="o">=</span> <span class="n">end</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>    <span class="k">if</span> <span class="n">status</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Running </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">...&quot;</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="n">status</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="elysia.objects.Tool.get_metadata" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_metadata</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get tool metadata without instantiation.</p>


            <details class="quote">
              <summary>Source code in <code>elysia/objects.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="nd">@classmethod</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_metadata</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">bool</span> <span class="o">|</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]:</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get tool metadata without instantiation.&quot;&quot;&quot;</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>    <span class="k">return</span> <span class="p">{</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="s2">&quot;_tool_name&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="s2">&quot;_tool_description&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>        <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="s2">&quot;_tool_inputs&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>        <span class="s2">&quot;end&quot;</span><span class="p">:</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="s2">&quot;_tool_end&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>    <span class="p">}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="elysia.objects.Tool.is_tool_available" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_tool_available</span><span class="p">(</span><span class="n">tree_data</span><span class="p">,</span> <span class="n">base_lm</span><span class="p">,</span> <span class="n">complex_lm</span><span class="p">,</span> <span class="n">client_manager</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>This method is called to check if the tool is available.
If this returns <code>True</code>, then the tool is available to be used by the LLM.
Otherwise it does not appear in the decision tree.</p>
<p>The difference between this and <code>run_if_true</code> is that <code>run_if_true</code> will <em>always</em> run the <strong>call</strong> method if it returns <code>True</code>,
even if the LLM does not choose to use the tool.</p>
<p>This must be an async function.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>tree_data</code>
            </td>
            <td>
                  <code><span title="TreeData">TreeData</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The tree data object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>base_lm</code>
            </td>
            <td>
                  <code><span title="LM">LM</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The base language model, a dspy.LM object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>complex_lm</code>
            </td>
            <td>
                  <code><span title="LM">LM</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The complex language model, a dspy.LM object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>client_manager</code>
            </td>
            <td>
                  <code><span title="ClientManager">ClientManager</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The client manager, a way of interfacing with a Weaviate client.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the tool is available, False otherwise.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>elysia/objects.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-189" name="__codelineno-0-189"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">is_tool_available</span><span class="p">(</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>    <span class="n">tree_data</span><span class="p">,</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>    <span class="n">base_lm</span><span class="p">,</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>    <span class="n">complex_lm</span><span class="p">,</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>    <span class="n">client_manager</span><span class="p">,</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="sd">    This method is called to check if the tool is available.</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="sd">    If this returns `True`, then the tool is available to be used by the LLM.</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a><span class="sd">    Otherwise it does not appear in the decision tree.</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a><span class="sd">    The difference between this and `run_if_true` is that `run_if_true` will _always_ run the __call__ method if it returns `True`,</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a><span class="sd">    even if the LLM does not choose to use the tool.</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="sd">    This must be an async function.</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a><span class="sd">        tree_data (TreeData): The tree data object.</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a><span class="sd">        base_lm (LM): The base language model, a dspy.LM object.</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a><span class="sd">        complex_lm (LM): The complex language model, a dspy.LM object.</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a><span class="sd">        client_manager (ClientManager): The client manager, a way of interfacing with a Weaviate client.</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a><span class="sd">        bool: True if the tool is available, False otherwise.</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>    <span class="k">return</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="elysia.objects.Tool.run_if_true" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run_if_true</span><span class="p">(</span><span class="n">tree_data</span><span class="p">,</span> <span class="n">base_lm</span><span class="p">,</span> <span class="n">complex_lm</span><span class="p">,</span> <span class="n">client_manager</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>This method is called to check if the tool should be run automatically.
If this returns <code>True</code>, then the tool is immediately called at the start of the tree.
Otherwise it does not appear in the decision tree.
You must also return a dictionary of inputs for the tool, which will be used to call the tool if <code>True</code> is returned.
If the inputs are None or an empty dictionary, then the default inputs will be used.</p>
<p>This must be an async function.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>tree_data</code>
            </td>
            <td>
                  <code><span title="TreeData">TreeData</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The tree data object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>base_lm</code>
            </td>
            <td>
                  <code><span title="LM">LM</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The base language model, a dspy.LM object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>complex_lm</code>
            </td>
            <td>
                  <code><span title="LM">LM</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The complex language model, a dspy.LM object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>client_manager</code>
            </td>
            <td>
                  <code><span title="ClientManager">ClientManager</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The client manager, a way of interfacing with a Weaviate client.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the tool should be run automatically, False otherwise.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>dict</code></td>            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary of inputs for the tool, with the following structure:
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="p">{</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">input_name</span><span class="p">:</span> <span class="n">input_value</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="p">}</span>
</code></pre></div></p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>elysia/objects.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">run_if_true</span><span class="p">(</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>    <span class="n">tree_data</span><span class="p">,</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>    <span class="n">base_lm</span><span class="p">,</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>    <span class="n">complex_lm</span><span class="p">,</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>    <span class="n">client_manager</span><span class="p">,</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]:</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="sd">    This method is called to check if the tool should be run automatically.</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">    If this returns `True`, then the tool is immediately called at the start of the tree.</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">    Otherwise it does not appear in the decision tree.</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="sd">    You must also return a dictionary of inputs for the tool, which will be used to call the tool if `True` is returned.</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">    If the inputs are None or an empty dictionary, then the default inputs will be used.</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a><span class="sd">    This must be an async function.</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="sd">        tree_data (TreeData): The tree data object.</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a><span class="sd">        base_lm (LM): The base language model, a dspy.LM object.</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a><span class="sd">        complex_lm (LM): The complex language model, a dspy.LM object.</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a><span class="sd">        client_manager (ClientManager): The client manager, a way of interfacing with a Weaviate client.</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a><span class="sd">        bool: True if the tool should be run automatically, False otherwise.</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a><span class="sd">        dict: A dictionary of inputs for the tool, with the following structure:</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a><span class="sd">            ```python</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a><span class="sd">            {</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a><span class="sd">                input_name: input_value</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a><span class="sd">            }</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="sd">            ```</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>    <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="p">{}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="elysia.objects.ToolMeta" class="doc doc-heading">
            <code>ToolMeta</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="type">type</span></code></p>


        <p>Metaclass that extracts tool metadata from <strong>init</strong> method.</p>








              <details class="quote">
                <summary>Source code in <code>elysia/objects.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-10">10</a></span>
<span class="normal"><a href="#__codelineno-0-11">11</a></span>
<span class="normal"><a href="#__codelineno-0-12">12</a></span>
<span class="normal"><a href="#__codelineno-0-13">13</a></span>
<span class="normal"><a href="#__codelineno-0-14">14</a></span>
<span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span>
<span class="normal"><a href="#__codelineno-0-76">76</a></span>
<span class="normal"><a href="#__codelineno-0-77">77</a></span>
<span class="normal"><a href="#__codelineno-0-78">78</a></span>
<span class="normal"><a href="#__codelineno-0-79">79</a></span>
<span class="normal"><a href="#__codelineno-0-80">80</a></span>
<span class="normal"><a href="#__codelineno-0-81">81</a></span>
<span class="normal"><a href="#__codelineno-0-82">82</a></span>
<span class="normal"><a href="#__codelineno-0-83">83</a></span>
<span class="normal"><a href="#__codelineno-0-84">84</a></span>
<span class="normal"><a href="#__codelineno-0-85">85</a></span>
<span class="normal"><a href="#__codelineno-0-86">86</a></span>
<span class="normal"><a href="#__codelineno-0-87">87</a></span>
<span class="normal"><a href="#__codelineno-0-88">88</a></span>
<span class="normal"><a href="#__codelineno-0-89">89</a></span>
<span class="normal"><a href="#__codelineno-0-90">90</a></span>
<span class="normal"><a href="#__codelineno-0-91">91</a></span>
<span class="normal"><a href="#__codelineno-0-92">92</a></span>
<span class="normal"><a href="#__codelineno-0-93">93</a></span>
<span class="normal"><a href="#__codelineno-0-94">94</a></span>
<span class="normal"><a href="#__codelineno-0-95">95</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="k">class</span><span class="w"> </span><span class="nc">ToolMeta</span><span class="p">(</span><span class="nb">type</span><span class="p">):</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Metaclass that extracts tool metadata from __init__ method.&quot;&quot;&quot;</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a>    <span class="n">_tool_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a>    <span class="n">_tool_description</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a>    <span class="n">_tool_inputs</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a>    <span class="n">_tool_end</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>    <span class="nd">@staticmethod</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_convert_ast_dict</span><span class="p">(</span><span class="n">ast_dict</span><span class="p">:</span> <span class="n">ast</span><span class="o">.</span><span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>        <span class="n">out</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ast_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">)):</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>            <span class="n">k</span><span class="p">:</span> <span class="n">ast</span><span class="o">.</span><span class="n">Constant</span> <span class="o">=</span> <span class="n">ast_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>            <span class="n">v</span><span class="p">:</span> <span class="n">ast</span><span class="o">.</span><span class="n">Dict</span> <span class="o">|</span> <span class="n">ast</span><span class="o">.</span><span class="n">List</span> <span class="o">|</span> <span class="n">ast</span><span class="o">.</span><span class="n">Constant</span> <span class="o">=</span> <span class="n">ast_dict</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">ast</span><span class="o">.</span><span class="n">Dict</span><span class="p">):</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>                <span class="n">out</span><span class="p">[</span><span class="n">k</span><span class="o">.</span><span class="n">value</span><span class="p">]</span> <span class="o">=</span> <span class="n">ToolMeta</span><span class="o">.</span><span class="n">_convert_ast_dict</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">ast</span><span class="o">.</span><span class="n">List</span><span class="p">):</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>                <span class="n">out</span><span class="p">[</span><span class="n">k</span><span class="o">.</span><span class="n">value</span><span class="p">]</span> <span class="o">=</span> <span class="n">ToolMeta</span><span class="o">.</span><span class="n">_convert_ast_list</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">ast</span><span class="o">.</span><span class="n">Constant</span><span class="p">):</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>                <span class="n">out</span><span class="p">[</span><span class="n">k</span><span class="o">.</span><span class="n">value</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">value</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>        <span class="k">return</span> <span class="n">out</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>    <span class="nd">@staticmethod</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_convert_ast_list</span><span class="p">(</span><span class="n">ast_list</span><span class="p">:</span> <span class="n">ast</span><span class="o">.</span><span class="n">List</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>        <span class="n">out</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">ast_list</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">ast</span><span class="o">.</span><span class="n">Dict</span><span class="p">):</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>                <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ToolMeta</span><span class="o">.</span><span class="n">_convert_ast_dict</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">ast</span><span class="o">.</span><span class="n">List</span><span class="p">):</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>                <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ToolMeta</span><span class="o">.</span><span class="n">_convert_ast_list</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">ast</span><span class="o">.</span><span class="n">Constant</span><span class="p">):</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>                <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>        <span class="k">return</span> <span class="n">out</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">bases</span><span class="p">,</span> <span class="n">namespace</span><span class="p">):</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>        <span class="n">new_class</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">bases</span><span class="p">,</span> <span class="n">namespace</span><span class="p">)</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>        <span class="c1"># Skip the base Tool class itself</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>        <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Tool&quot;</span><span class="p">:</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>            <span class="k">return</span> <span class="n">new_class</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>        <span class="c1"># Extract metadata from __init__ method if it exists</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>        <span class="k">if</span> <span class="s2">&quot;__init__&quot;</span> <span class="ow">in</span> <span class="n">namespace</span><span class="p">:</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>            <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>                <span class="n">init_method</span> <span class="o">=</span> <span class="n">namespace</span><span class="p">[</span><span class="s2">&quot;__init__&quot;</span><span class="p">]</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>                <span class="n">source</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getsource</span><span class="p">(</span><span class="n">init_method</span><span class="p">)</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>                <span class="n">tree</span> <span class="o">=</span> <span class="n">ast</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">source</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>                <span class="c1"># Find the super().__init__() call and extract arguments</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>                <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">ast</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">tree</span><span class="p">):</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>                    <span class="k">if</span> <span class="p">(</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>                        <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">ast</span><span class="o">.</span><span class="n">Call</span><span class="p">)</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>                        <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">func</span><span class="p">,</span> <span class="n">ast</span><span class="o">.</span><span class="n">Attribute</span><span class="p">)</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>                        <span class="ow">and</span> <span class="n">node</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">attr</span> <span class="o">==</span> <span class="s2">&quot;__init__&quot;</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>                        <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">ast</span><span class="o">.</span><span class="n">Call</span><span class="p">)</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>                        <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">func</span><span class="p">,</span> <span class="n">ast</span><span class="o">.</span><span class="n">Name</span><span class="p">)</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>                        <span class="ow">and</span> <span class="n">node</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="s2">&quot;super&quot;</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>                    <span class="p">):</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>                        <span class="c1"># Extract keyword arguments</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>                        <span class="k">for</span> <span class="n">keyword</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">keywords</span><span class="p">:</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>                            <span class="k">if</span> <span class="n">keyword</span><span class="o">.</span><span class="n">arg</span> <span class="o">==</span> <span class="s2">&quot;name&quot;</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>                                <span class="n">keyword</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">ast</span><span class="o">.</span><span class="n">Constant</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>                            <span class="p">):</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>                                <span class="n">new_class</span><span class="o">.</span><span class="n">_tool_name</span> <span class="o">=</span> <span class="n">keyword</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">value</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>                            <span class="k">elif</span> <span class="n">keyword</span><span class="o">.</span><span class="n">arg</span> <span class="o">==</span> <span class="s2">&quot;description&quot;</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>                                <span class="n">keyword</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">ast</span><span class="o">.</span><span class="n">Constant</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>                            <span class="p">):</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>                                <span class="n">new_class</span><span class="o">.</span><span class="n">_tool_description</span> <span class="o">=</span> <span class="n">keyword</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">value</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>                            <span class="k">elif</span> <span class="n">keyword</span><span class="o">.</span><span class="n">arg</span> <span class="o">==</span> <span class="s2">&quot;inputs&quot;</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>                                <span class="n">keyword</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">ast</span><span class="o">.</span><span class="n">Dict</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>                            <span class="p">):</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>                                <span class="n">new_class</span><span class="o">.</span><span class="n">_tool_inputs</span> <span class="o">=</span> <span class="n">ToolMeta</span><span class="o">.</span><span class="n">_convert_ast_dict</span><span class="p">(</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>                                    <span class="n">keyword</span><span class="o">.</span><span class="n">value</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>                                <span class="p">)</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>                            <span class="k">elif</span> <span class="n">keyword</span><span class="o">.</span><span class="n">arg</span> <span class="o">==</span> <span class="s2">&quot;end&quot;</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>                                <span class="n">keyword</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">ast</span><span class="o">.</span><span class="n">Constant</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>                            <span class="p">):</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>                                <span class="n">new_class</span><span class="o">.</span><span class="n">_tool_end</span> <span class="o">=</span> <span class="n">keyword</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">value</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>                        <span class="k">break</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>                <span class="c1"># If parsing fails, just continue without setting class attributes</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>                <span class="k">pass</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>        <span class="k">return</span> <span class="n">new_class</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="elysia.objects.Update" class="doc doc-heading">
            <code>Update</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="Return (elysia.objects.Return)" href="#elysia.objects.Return">Return</a></code></p>


        <p>Frontend Return Type 2: Update
An update is something that is not <em>displayed</em> on the frontend, but gives information to the frontend.
E.g. a warning, error, status message, etc.</p>








              <details class="quote">
                <summary>Source code in <code>elysia/objects.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-552">552</a></span>
<span class="normal"><a href="#__codelineno-0-553">553</a></span>
<span class="normal"><a href="#__codelineno-0-554">554</a></span>
<span class="normal"><a href="#__codelineno-0-555">555</a></span>
<span class="normal"><a href="#__codelineno-0-556">556</a></span>
<span class="normal"><a href="#__codelineno-0-557">557</a></span>
<span class="normal"><a href="#__codelineno-0-558">558</a></span>
<span class="normal"><a href="#__codelineno-0-559">559</a></span>
<span class="normal"><a href="#__codelineno-0-560">560</a></span>
<span class="normal"><a href="#__codelineno-0-561">561</a></span>
<span class="normal"><a href="#__codelineno-0-562">562</a></span>
<span class="normal"><a href="#__codelineno-0-563">563</a></span>
<span class="normal"><a href="#__codelineno-0-564">564</a></span>
<span class="normal"><a href="#__codelineno-0-565">565</a></span>
<span class="normal"><a href="#__codelineno-0-566">566</a></span>
<span class="normal"><a href="#__codelineno-0-567">567</a></span>
<span class="normal"><a href="#__codelineno-0-568">568</a></span>
<span class="normal"><a href="#__codelineno-0-569">569</a></span>
<span class="normal"><a href="#__codelineno-0-570">570</a></span>
<span class="normal"><a href="#__codelineno-0-571">571</a></span>
<span class="normal"><a href="#__codelineno-0-572">572</a></span>
<span class="normal"><a href="#__codelineno-0-573">573</a></span>
<span class="normal"><a href="#__codelineno-0-574">574</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-552" name="__codelineno-0-552"></a><span class="k">class</span><span class="w"> </span><span class="nc">Update</span><span class="p">(</span><span class="n">Return</span><span class="p">):</span>
<a id="__codelineno-0-553" name="__codelineno-0-553"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-554" name="__codelineno-0-554"></a><span class="sd">    Frontend Return Type 2: Update</span>
<a id="__codelineno-0-555" name="__codelineno-0-555"></a><span class="sd">    An update is something that is not _displayed_ on the frontend, but gives information to the frontend.</span>
<a id="__codelineno-0-556" name="__codelineno-0-556"></a><span class="sd">    E.g. a warning, error, status message, etc.</span>
<a id="__codelineno-0-557" name="__codelineno-0-557"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-558" name="__codelineno-0-558"></a>
<a id="__codelineno-0-559" name="__codelineno-0-559"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frontend_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">object</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
<a id="__codelineno-0-560" name="__codelineno-0-560"></a>        <span class="n">Return</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frontend_type</span><span class="p">,</span> <span class="s2">&quot;update&quot;</span><span class="p">)</span>
<a id="__codelineno-0-561" name="__codelineno-0-561"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">object</span> <span class="o">=</span> <span class="nb">object</span>
<a id="__codelineno-0-562" name="__codelineno-0-562"></a>
<a id="__codelineno-0-563" name="__codelineno-0-563"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">to_json</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-564" name="__codelineno-0-564"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span>
<a id="__codelineno-0-565" name="__codelineno-0-565"></a>
<a id="__codelineno-0-566" name="__codelineno-0-566"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">to_frontend</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">conversation_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">query_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-567" name="__codelineno-0-567"></a>        <span class="k">return</span> <span class="p">{</span>
<a id="__codelineno-0-568" name="__codelineno-0-568"></a>            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">frontend_type</span><span class="p">,</span>
<a id="__codelineno-0-569" name="__codelineno-0-569"></a>            <span class="s2">&quot;user_id&quot;</span><span class="p">:</span> <span class="n">user_id</span><span class="p">,</span>
<a id="__codelineno-0-570" name="__codelineno-0-570"></a>            <span class="s2">&quot;conversation_id&quot;</span><span class="p">:</span> <span class="n">conversation_id</span><span class="p">,</span>
<a id="__codelineno-0-571" name="__codelineno-0-571"></a>            <span class="s2">&quot;query_id&quot;</span><span class="p">:</span> <span class="n">query_id</span><span class="p">,</span>
<a id="__codelineno-0-572" name="__codelineno-0-572"></a>            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">frontend_type</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;-&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()),</span>
<a id="__codelineno-0-573" name="__codelineno-0-573"></a>            <span class="s2">&quot;payload&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_json</span><span class="p">(),</span>
<a id="__codelineno-0-574" name="__codelineno-0-574"></a>        <span class="p">}</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="elysia.objects.Warning" class="doc doc-heading">
            <code>Warning</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="Update (elysia.objects.Update)" href="#elysia.objects.Update">Update</a></code></p>


        <p>Warning message to be sent to the frontend.</p>








              <details class="quote">
                <summary>Source code in <code>elysia/objects.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-587">587</a></span>
<span class="normal"><a href="#__codelineno-0-588">588</a></span>
<span class="normal"><a href="#__codelineno-0-589">589</a></span>
<span class="normal"><a href="#__codelineno-0-590">590</a></span>
<span class="normal"><a href="#__codelineno-0-591">591</a></span>
<span class="normal"><a href="#__codelineno-0-592">592</a></span>
<span class="normal"><a href="#__codelineno-0-593">593</a></span>
<span class="normal"><a href="#__codelineno-0-594">594</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-587" name="__codelineno-0-587"></a><span class="k">class</span><span class="w"> </span><span class="nc">Warning</span><span class="p">(</span><span class="n">Update</span><span class="p">):</span>
<a id="__codelineno-0-588" name="__codelineno-0-588"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-589" name="__codelineno-0-589"></a><span class="sd">    Warning message to be sent to the frontend.</span>
<a id="__codelineno-0-590" name="__codelineno-0-590"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-591" name="__codelineno-0-591"></a>
<a id="__codelineno-0-592" name="__codelineno-0-592"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-593" name="__codelineno-0-593"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">text</span>
<a id="__codelineno-0-594" name="__codelineno-0-594"></a>        <span class="n">Update</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;warning&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="n">text</span><span class="p">})</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">












  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h2 id="elysia.objects.tool" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">tool</span><span class="p">(</span><span class="n">function</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">tree</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">branch_id</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>
          <div class="doc-overloads">
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">tool</span><span class="p">(</span><span class="n">function</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">status</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">end</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">tree</span><span class="p">:</span> <span class="n">Tree</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">branch_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tool</span>
</code></pre></div><div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">tool</span><span class="p">(</span><span class="n">function</span><span class="p">:</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">status</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">end</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">tree</span><span class="p">:</span> <span class="n">Tree</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">branch_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Callable</span><span class="p">],</span> <span class="n">Tool</span><span class="p">]</span>
</code></pre></div>          </div>


    <div class="doc doc-contents ">

        <p>Create a tool from a python function.
Use this decorator to create a tool from a function.
The function must be an async function or async generator function.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>function</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The function to create a tool from.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>status</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The status message to display while the tool is running.
Optional, defaults to None, which will use the default status message "Running {tool_name}...".</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>end</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the tool can be at the end of the decision tree.
Set to True when this tool is allowed to end the conversation.
Optional, defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tree</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Tree (elysia.tree.tree.Tree)" href="../Tree/#elysia.tree.tree.Tree">Tree</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The tree to add the tool to.
Optional, defaults to None, which will not add the tool to the tree.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>branch_id</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The branch of the tree to add the tool to.
Optional, defaults to None, which will add the tool to the root branch.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="Tool (elysia.objects.Tool)" href="#elysia.objects.Tool">Tool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The tool object which can be added to the tree (via <code>tree.add_tool(...)</code>).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>elysia/objects.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-257" name="__codelineno-0-257"></a><span class="k">def</span><span class="w"> </span><span class="nf">tool</span><span class="p">(</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>    <span class="n">function</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>    <span class="n">status</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>    <span class="n">end</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>    <span class="n">tree</span><span class="p">:</span> <span class="s2">&quot;Tree | None&quot;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>    <span class="n">branch_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Callable</span><span class="p">],</span> <span class="n">Tool</span><span class="p">]</span> <span class="o">|</span> <span class="n">Tool</span><span class="p">:</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a><span class="sd">    Create a tool from a python function.</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a><span class="sd">    Use this decorator to create a tool from a function.</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a><span class="sd">    The function must be an async function or async generator function.</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a><span class="sd">        function (Callable): The function to create a tool from.</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a><span class="sd">        status (str | None): The status message to display while the tool is running.</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a><span class="sd">            Optional, defaults to None, which will use the default status message &quot;Running {tool_name}...&quot;.</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a><span class="sd">        end (bool): Whether the tool can be at the end of the decision tree.</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a><span class="sd">            Set to True when this tool is allowed to end the conversation.</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a><span class="sd">            Optional, defaults to False.</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a><span class="sd">        tree (Tree | None): The tree to add the tool to.</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a><span class="sd">            Optional, defaults to None, which will not add the tool to the tree.</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a><span class="sd">        branch_id (str | None): The branch of the tree to add the tool to.</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a><span class="sd">            Optional, defaults to None, which will add the tool to the root branch.</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a><span class="sd">        (Tool): The tool object which can be added to the tree (via `tree.add_tool(...)`).</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">decorator</span><span class="p">(</span><span class="n">function</span><span class="p">:</span> <span class="n">Callable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tool</span><span class="p">:</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>        <span class="n">async_function</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">iscoroutinefunction</span><span class="p">(</span><span class="n">function</span><span class="p">)</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>        <span class="n">async_generator_function</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isasyncgenfunction</span><span class="p">(</span><span class="n">function</span><span class="p">)</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">async_function</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">async_generator_function</span><span class="p">:</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>                <span class="s2">&quot;The provided function must be an async function or async generator function.&quot;</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>            <span class="p">)</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>        <span class="k">if</span> <span class="s2">&quot;inputs&quot;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">function</span><span class="o">.</span><span class="vm">__annotations__</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>                <span class="s2">&quot;The `inputs` argument is reserved in tool functions, please choose another name.&quot;</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>            <span class="p">)</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>        <span class="n">sig</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="n">function</span><span class="p">)</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>        <span class="n">defaults_mapping</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>            <span class="n">k</span><span class="p">:</span> <span class="n">v</span><span class="o">.</span><span class="n">default</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">sig</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>            <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">default</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">inspect</span><span class="o">.</span><span class="n">Parameter</span><span class="o">.</span><span class="n">empty</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>        <span class="p">}</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">list_to_list_of_dicts</span><span class="p">(</span><span class="n">result</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">]:</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>            <span class="n">objects</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>            <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>                    <span class="n">objects</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">bool</span><span class="p">):</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>                    <span class="n">objects</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>                        <span class="p">{</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>                            <span class="s2">&quot;tool_result&quot;</span><span class="p">:</span> <span class="n">obj</span><span class="p">,</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a>                        <span class="p">}</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a>                    <span class="p">)</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>                    <span class="n">objects</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">list_to_list_of_dicts</span><span class="p">(</span><span class="n">obj</span><span class="p">))</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a>                    <span class="n">objects</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a>                        <span class="p">{</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a>                            <span class="s2">&quot;tool_result&quot;</span><span class="p">:</span> <span class="n">obj</span><span class="p">,</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a>                        <span class="p">}</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a>                    <span class="p">)</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a>            <span class="k">return</span> <span class="n">objects</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">return_mapping</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">Result</span> <span class="o">|</span> <span class="n">Text</span> <span class="o">|</span> <span class="n">Update</span> <span class="o">|</span> <span class="n">Status</span> <span class="o">|</span> <span class="n">Error</span><span class="p">):</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>                <span class="k">return</span> <span class="n">result</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a>                <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">bool</span><span class="p">):</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a>                <span class="k">return</span> <span class="n">Result</span><span class="p">(</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a>                    <span class="n">objects</span><span class="o">=</span><span class="p">[</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>                        <span class="p">{</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>                            <span class="s2">&quot;tool_result&quot;</span><span class="p">:</span> <span class="n">result</span><span class="p">,</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>                        <span class="p">}</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>                    <span class="p">],</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>                    <span class="n">metadata</span><span class="o">=</span><span class="p">{</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>                        <span class="s2">&quot;tool_name&quot;</span><span class="p">:</span> <span class="n">function</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>                        <span class="s2">&quot;inputs_used&quot;</span><span class="p">:</span> <span class="n">inputs</span><span class="p">,</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>                    <span class="p">},</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>                <span class="p">)</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>                <span class="k">return</span> <span class="n">Result</span><span class="p">(</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>                    <span class="n">objects</span><span class="o">=</span><span class="p">[</span><span class="n">result</span><span class="p">],</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>                    <span class="n">metadata</span><span class="o">=</span><span class="p">{</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>                        <span class="s2">&quot;tool_name&quot;</span><span class="p">:</span> <span class="n">function</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>                        <span class="s2">&quot;inputs_used&quot;</span><span class="p">:</span> <span class="n">inputs</span><span class="p">,</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>                    <span class="p">},</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>                <span class="p">)</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>                <span class="k">return</span> <span class="n">Result</span><span class="p">(</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>                    <span class="n">objects</span><span class="o">=</span><span class="n">list_to_list_of_dicts</span><span class="p">(</span><span class="n">result</span><span class="p">),</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>                    <span class="n">metadata</span><span class="o">=</span><span class="p">{</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a>                        <span class="s2">&quot;tool_name&quot;</span><span class="p">:</span> <span class="n">function</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a>                        <span class="s2">&quot;inputs_used&quot;</span><span class="p">:</span> <span class="n">inputs</span><span class="p">,</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a>                    <span class="p">},</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>                <span class="p">)</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>                <span class="k">return</span> <span class="n">Result</span><span class="p">(</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a>                    <span class="n">objects</span><span class="o">=</span><span class="p">[</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a>                        <span class="p">{</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a>                            <span class="s2">&quot;tool_result&quot;</span><span class="p">:</span> <span class="n">result</span><span class="p">,</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>                        <span class="p">}</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a>                    <span class="p">],</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a>                    <span class="n">metadata</span><span class="o">=</span><span class="p">{</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a>                        <span class="s2">&quot;tool_name&quot;</span><span class="p">:</span> <span class="n">function</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>                        <span class="s2">&quot;inputs_used&quot;</span><span class="p">:</span> <span class="n">inputs</span><span class="p">,</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a>                    <span class="p">},</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>                <span class="p">)</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>        <span class="k">class</span><span class="w"> </span><span class="nc">ToolClass</span><span class="p">(</span><span class="n">Tool</span><span class="p">):</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>            <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a>                <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>                    <span class="n">name</span><span class="o">=</span><span class="n">function</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>                    <span class="n">description</span><span class="o">=</span><span class="n">function</span><span class="o">.</span><span class="vm">__doc__</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>                    <span class="n">status</span><span class="o">=</span><span class="p">(</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>                        <span class="n">status</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>                        <span class="k">if</span> <span class="n">status</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>                        <span class="k">else</span> <span class="sa">f</span><span class="s2">&quot;Running </span><span class="si">{</span><span class="n">function</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">...&quot;</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>                    <span class="p">),</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>                    <span class="n">inputs</span><span class="o">=</span><span class="p">{</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>                        <span class="n">input_key</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>                            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>                            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">input_value</span><span class="p">,</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>                            <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="n">defaults_mapping</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">input_key</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>                            <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="n">defaults_mapping</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">input_key</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>                            <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>                        <span class="p">}</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>                        <span class="k">for</span> <span class="n">input_key</span><span class="p">,</span> <span class="n">input_value</span> <span class="ow">in</span> <span class="n">function</span><span class="o">.</span><span class="vm">__annotations__</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>                        <span class="k">if</span> <span class="n">input_key</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a>                        <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>                            <span class="s2">&quot;tree_data&quot;</span><span class="p">,</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a>                            <span class="s2">&quot;base_lm&quot;</span><span class="p">,</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a>                            <span class="s2">&quot;complex_lm&quot;</span><span class="p">,</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a>                            <span class="s2">&quot;client_manager&quot;</span><span class="p">,</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a>                            <span class="s2">&quot;return&quot;</span><span class="p">,</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a>                        <span class="p">]</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a>                    <span class="p">},</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a>                    <span class="n">end</span><span class="o">=</span><span class="n">end</span><span class="p">,</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a>                <span class="p">)</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_original_function</span> <span class="o">=</span> <span class="n">function</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a>            <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>                <span class="bp">self</span><span class="p">,</span> <span class="n">tree_data</span><span class="p">,</span> <span class="n">inputs</span><span class="p">,</span> <span class="n">base_lm</span><span class="p">,</span> <span class="n">complex_lm</span><span class="p">,</span> <span class="n">client_manager</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a>            <span class="p">):</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a>                <span class="k">if</span> <span class="n">async_function</span><span class="p">:</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a>                    <span class="n">tool_output</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a>                        <span class="k">await</span> <span class="n">function</span><span class="p">(</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>                            <span class="o">**</span><span class="n">inputs</span><span class="p">,</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a>                            <span class="o">**</span><span class="p">{</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a>                                <span class="n">k</span><span class="p">:</span> <span class="n">v</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a>                                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="p">{</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>                                    <span class="s2">&quot;tree_data&quot;</span><span class="p">:</span> <span class="n">tree_data</span><span class="p">,</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>                                    <span class="s2">&quot;base_lm&quot;</span><span class="p">:</span> <span class="n">base_lm</span><span class="p">,</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a>                                    <span class="s2">&quot;complex_lm&quot;</span><span class="p">:</span> <span class="n">complex_lm</span><span class="p">,</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a>                                    <span class="s2">&quot;client_manager&quot;</span><span class="p">:</span> <span class="n">client_manager</span><span class="p">,</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a>                                    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a>                                <span class="p">}</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a>                                <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">function</span><span class="o">.</span><span class="vm">__annotations__</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a>                            <span class="p">},</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>                        <span class="p">)</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a>                    <span class="p">]</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a>                <span class="k">elif</span> <span class="n">async_generator_function</span><span class="p">:</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a>                    <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a>                    <span class="k">async</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">function</span><span class="p">(</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a>                        <span class="o">**</span><span class="n">inputs</span><span class="p">,</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a>                        <span class="o">**</span><span class="p">{</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a>                            <span class="n">k</span><span class="p">:</span> <span class="n">v</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a>                            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="p">{</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a>                                <span class="s2">&quot;tree_data&quot;</span><span class="p">:</span> <span class="n">tree_data</span><span class="p">,</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a>                                <span class="s2">&quot;base_lm&quot;</span><span class="p">:</span> <span class="n">base_lm</span><span class="p">,</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a>                                <span class="s2">&quot;complex_lm&quot;</span><span class="p">:</span> <span class="n">complex_lm</span><span class="p">,</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a>                                <span class="s2">&quot;client_manager&quot;</span><span class="p">:</span> <span class="n">client_manager</span><span class="p">,</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a>                                <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a>                            <span class="p">}</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a>                            <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">function</span><span class="o">.</span><span class="vm">__annotations__</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a>                        <span class="p">},</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a>                    <span class="p">):</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a>                        <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a>                    <span class="n">tool_output</span> <span class="o">=</span> <span class="n">results</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a>                <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">tool_output</span><span class="p">:</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a>                    <span class="n">mapped_result</span> <span class="o">=</span> <span class="n">return_mapping</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">inputs</span><span class="p">)</span>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a>                    <span class="k">yield</span> <span class="n">mapped_result</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a>        <span class="n">tool_class</span> <span class="o">=</span> <span class="n">ToolClass</span><span class="p">()</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a>        <span class="k">if</span> <span class="n">tree</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a>            <span class="n">tree</span><span class="o">.</span><span class="n">add_tool</span><span class="p">(</span><span class="n">tool_class</span><span class="p">,</span> <span class="n">branch_id</span><span class="o">=</span><span class="n">branch_id</span><span class="p">)</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a>        <span class="k">return</span> <span class="n">tool_class</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a>    <span class="k">if</span> <span class="n">function</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a>        <span class="k">return</span> <span class="n">decorator</span><span class="p">(</span><span class="n">function</span><span class="p">)</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a>        <span class="k">return</span> <span class="n">decorator</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="elysia.tree.objects"></a>
    <div class="doc doc-contents first">










  <div class="doc doc-children">









<div class="doc doc-object doc-class">



<h2 id="elysia.tree.objects.CollectionData" class="doc doc-heading">
            <code>CollectionData</code>


</h2>


    <div class="doc doc-contents ">


        <p>Store of data about the Weaviate collections that are used in the tree.
These are the output of the <code>preprocess</code> function.</p>
<p>You do not normally need to interact with this class directly.
Instead, do so via the <code>TreeData</code> class, which has corresponding methods to get the data in a variety of formats.
(Such as via the <code>output_full_metadata</code> method.)</p>








              <details class="quote">
                <summary>Source code in <code>elysia/tree/objects.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span>
<span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span>
<span class="normal"><a href="#__codelineno-0-506">506</a></span>
<span class="normal"><a href="#__codelineno-0-507">507</a></span>
<span class="normal"><a href="#__codelineno-0-508">508</a></span>
<span class="normal"><a href="#__codelineno-0-509">509</a></span>
<span class="normal"><a href="#__codelineno-0-510">510</a></span>
<span class="normal"><a href="#__codelineno-0-511">511</a></span>
<span class="normal"><a href="#__codelineno-0-512">512</a></span>
<span class="normal"><a href="#__codelineno-0-513">513</a></span>
<span class="normal"><a href="#__codelineno-0-514">514</a></span>
<span class="normal"><a href="#__codelineno-0-515">515</a></span>
<span class="normal"><a href="#__codelineno-0-516">516</a></span>
<span class="normal"><a href="#__codelineno-0-517">517</a></span>
<span class="normal"><a href="#__codelineno-0-518">518</a></span>
<span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span>
<span class="normal"><a href="#__codelineno-0-523">523</a></span>
<span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span>
<span class="normal"><a href="#__codelineno-0-528">528</a></span>
<span class="normal"><a href="#__codelineno-0-529">529</a></span>
<span class="normal"><a href="#__codelineno-0-530">530</a></span>
<span class="normal"><a href="#__codelineno-0-531">531</a></span>
<span class="normal"><a href="#__codelineno-0-532">532</a></span>
<span class="normal"><a href="#__codelineno-0-533">533</a></span>
<span class="normal"><a href="#__codelineno-0-534">534</a></span>
<span class="normal"><a href="#__codelineno-0-535">535</a></span>
<span class="normal"><a href="#__codelineno-0-536">536</a></span>
<span class="normal"><a href="#__codelineno-0-537">537</a></span>
<span class="normal"><a href="#__codelineno-0-538">538</a></span>
<span class="normal"><a href="#__codelineno-0-539">539</a></span>
<span class="normal"><a href="#__codelineno-0-540">540</a></span>
<span class="normal"><a href="#__codelineno-0-541">541</a></span>
<span class="normal"><a href="#__codelineno-0-542">542</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-378" name="__codelineno-0-378"></a><span class="k">class</span><span class="w"> </span><span class="nc">CollectionData</span><span class="p">:</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a><span class="sd">    Store of data about the Weaviate collections that are used in the tree.</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a><span class="sd">    These are the output of the `preprocess` function.</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a><span class="sd">    You do not normally need to interact with this class directly.</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a><span class="sd">    Instead, do so via the `TreeData` class, which has corresponding methods to get the data in a variety of formats.</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a><span class="sd">    (Such as via the `output_full_metadata` method.)</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>        <span class="n">collection_names</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>        <span class="n">metadata</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{},</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>        <span class="n">logger</span><span class="p">:</span> <span class="n">Logger</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>    <span class="p">):</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">collection_names</span> <span class="o">=</span> <span class="n">collection_names</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span> <span class="o">=</span> <span class="n">metadata</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logger</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">set_collection_names</span><span class="p">(</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">collection_names</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">client_manager</span><span class="p">:</span> <span class="n">ClientManager</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a>    <span class="p">):</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a>        <span class="n">temp_metadata</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a>        <span class="c1"># check if any of these collections exist in the full metadata (cached)</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>        <span class="n">collections_to_get</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a>        <span class="k">for</span> <span class="n">collection_name</span> <span class="ow">in</span> <span class="n">collection_names</span><span class="p">:</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a>            <span class="k">if</span> <span class="n">collection_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">:</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>                <span class="n">collections_to_get</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">collection_name</span><span class="p">)</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">removed_collections</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">incorrect_collections</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a>        <span class="n">metadata_name</span> <span class="o">=</span> <span class="s2">&quot;ELYSIA_METADATA__&quot;</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a>        <span class="k">async</span> <span class="k">with</span> <span class="n">client_manager</span><span class="o">.</span><span class="n">connect_to_async_client</span><span class="p">()</span> <span class="k">as</span> <span class="n">client</span><span class="p">:</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a>            <span class="c1"># check if the metadata collection exists</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="k">await</span> <span class="n">client</span><span class="o">.</span><span class="n">collections</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">metadata_name</span><span class="p">):</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">removed_collections</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">collections_to_get</span><span class="p">)</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a>                <span class="n">metadata_collection</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">collections</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">metadata_name</span><span class="p">)</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a>                <span class="n">filters</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a>                    <span class="n">Filter</span><span class="o">.</span><span class="n">any_of</span><span class="p">(</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a>                        <span class="p">[</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a>                            <span class="n">Filter</span><span class="o">.</span><span class="n">by_property</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="n">collection_name</span><span class="p">)</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a>                            <span class="k">for</span> <span class="n">collection_name</span> <span class="ow">in</span> <span class="n">collections_to_get</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>                        <span class="p">]</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a>                    <span class="p">)</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a>                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">collections_to_get</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">1</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a>                    <span class="k">else</span> <span class="kc">None</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a>                <span class="p">)</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a>                <span class="n">metadata</span> <span class="o">=</span> <span class="k">await</span> <span class="n">metadata_collection</span><span class="o">.</span><span class="n">query</span><span class="o">.</span><span class="n">fetch_objects</span><span class="p">(</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a>                    <span class="n">filters</span><span class="o">=</span><span class="n">filters</span><span class="p">,</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a>                    <span class="n">limit</span><span class="o">=</span><span class="mi">9999</span><span class="p">,</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a>                <span class="p">)</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a>                <span class="n">metadata_map</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a>                    <span class="n">metadata_obj</span><span class="o">.</span><span class="n">properties</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]:</span> <span class="n">metadata_obj</span><span class="o">.</span><span class="n">properties</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a>                    <span class="k">for</span> <span class="n">metadata_obj</span> <span class="ow">in</span> <span class="n">metadata</span><span class="o">.</span><span class="n">objects</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a>                <span class="p">}</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a>                <span class="k">for</span> <span class="n">collection_name</span> <span class="ow">in</span> <span class="n">collections_to_get</span><span class="p">:</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="k">await</span> <span class="n">client</span><span class="o">.</span><span class="n">collections</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">collection_name</span><span class="p">):</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">incorrect_collections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">collection_name</span><span class="p">)</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a>                        <span class="k">continue</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a>                    <span class="k">if</span> <span class="n">collection_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">metadata_map</span><span class="p">:</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">removed_collections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">collection_name</span><span class="p">)</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a>                    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a>                        <span class="n">properties</span> <span class="o">=</span> <span class="n">metadata_map</span><span class="p">[</span><span class="n">collection_name</span><span class="p">]</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a>                        <span class="n">format_dict_to_serialisable</span><span class="p">(</span><span class="n">properties</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a>                        <span class="n">temp_metadata</span><span class="p">[</span><span class="n">collection_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">properties</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">removed_collections</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="p">:</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a>                <span class="s2">&quot;The following collections have not been pre-processed for Elysia. &quot;</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">removed_collections</span><span class="si">}</span><span class="s2">. &quot;</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a>                <span class="s2">&quot;Ignoring these collections for now.&quot;</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a>            <span class="p">)</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">incorrect_collections</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="p">:</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a>                <span class="s2">&quot;The following collections cannot be found in this Weaviate cluster. &quot;</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">incorrect_collections</span><span class="si">}</span><span class="s2">. &quot;</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a>                <span class="s2">&quot;These are being ignored for now. Please check that the collection names are correct.&quot;</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a>            <span class="p">)</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">collection_names</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a>            <span class="n">collection_name</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a>            <span class="k">for</span> <span class="n">collection_name</span> <span class="ow">in</span> <span class="n">collection_names</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a>            <span class="k">if</span> <span class="n">collection_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">removed_collections</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a>            <span class="ow">and</span> <span class="n">collection_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">incorrect_collections</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a>        <span class="p">]</span>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a>        <span class="c1"># add to cached full metadata</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a>            <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">,</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a>            <span class="o">**</span><span class="p">{</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a>                <span class="n">collection_name</span><span class="p">:</span> <span class="n">temp_metadata</span><span class="p">[</span><span class="n">collection_name</span><span class="p">]</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a>                <span class="k">for</span> <span class="n">collection_name</span> <span class="ow">in</span> <span class="n">temp_metadata</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a>                <span class="k">if</span> <span class="n">collection_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a>            <span class="p">},</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a>        <span class="p">}</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">collection_names</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">output_full_metadata</span><span class="p">(</span>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">collection_names</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">with_mappings</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a>    <span class="p">):</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a>        <span class="k">if</span> <span class="n">collection_names</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a>            <span class="n">collection_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collection_names</span>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a>        <span class="k">if</span> <span class="n">with_mappings</span><span class="p">:</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a>            <span class="k">return</span> <span class="p">{</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a>                <span class="n">collection_name</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="n">collection_name</span><span class="p">]</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a>                <span class="k">for</span> <span class="n">collection_name</span> <span class="ow">in</span> <span class="n">collection_names</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a>            <span class="p">}</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a>            <span class="k">return</span> <span class="p">{</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a>                <span class="n">collection_name</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a>                    <span class="n">k</span><span class="p">:</span> <span class="n">v</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a>                    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="n">collection_name</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a>                    <span class="k">if</span> <span class="n">k</span> <span class="o">!=</span> <span class="s2">&quot;mappings&quot;</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a>                <span class="p">}</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a>                <span class="k">for</span> <span class="n">collection_name</span> <span class="ow">in</span> <span class="n">collection_names</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a>            <span class="p">}</span>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">output_collection_summaries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">collection_names</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a>        <span class="k">if</span> <span class="n">collection_names</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a>            <span class="k">return</span> <span class="p">{</span>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a>                <span class="n">collection_name</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="n">collection_name</span><span class="p">][</span><span class="s2">&quot;summary&quot;</span><span class="p">]</span>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a>                <span class="k">for</span> <span class="n">collection_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">collection_names</span>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a>            <span class="p">}</span>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a>            <span class="k">return</span> <span class="p">{</span>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a>                <span class="n">collection_name</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="n">collection_name</span><span class="p">][</span><span class="s2">&quot;summary&quot;</span><span class="p">]</span>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a>                <span class="k">for</span> <span class="n">collection_name</span> <span class="ow">in</span> <span class="n">collection_names</span>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a>            <span class="p">}</span>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">output_mapping_lists</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a>        <span class="k">return</span> <span class="p">{</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a>            <span class="n">collection_name</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="n">collection_name</span><span class="p">][</span><span class="s2">&quot;mappings&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a>            <span class="k">for</span> <span class="n">collection_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">collection_names</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a>        <span class="p">}</span>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">output_mappings</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a>        <span class="k">return</span> <span class="p">{</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a>            <span class="n">collection_name</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="n">collection_name</span><span class="p">][</span><span class="s2">&quot;mappings&quot;</span><span class="p">]</span>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a>            <span class="k">for</span> <span class="n">collection_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">collection_names</span>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a>        <span class="p">}</span>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">to_json</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a>        <span class="k">return</span> <span class="p">{</span>
<a id="__codelineno-0-532" name="__codelineno-0-532"></a>            <span class="s2">&quot;collection_names&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">collection_names</span><span class="p">,</span>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a>            <span class="s2">&quot;metadata&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">,</span>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a>        <span class="p">}</span>
<a id="__codelineno-0-535" name="__codelineno-0-535"></a>
<a id="__codelineno-0-536" name="__codelineno-0-536"></a>    <span class="nd">@classmethod</span>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">from_json</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">json_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">logger</span><span class="p">:</span> <span class="n">Logger</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a>            <span class="n">collection_names</span><span class="o">=</span><span class="n">json_data</span><span class="p">[</span><span class="s2">&quot;collection_names&quot;</span><span class="p">],</span>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a>            <span class="n">metadata</span><span class="o">=</span><span class="n">json_data</span><span class="p">[</span><span class="s2">&quot;metadata&quot;</span><span class="p">],</span>
<a id="__codelineno-0-541" name="__codelineno-0-541"></a>            <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">,</span>
<a id="__codelineno-0-542" name="__codelineno-0-542"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="elysia.tree.objects.Environment" class="doc doc-heading">
            <code>Environment</code>


</h2>


    <div class="doc doc-contents ">


        <p>Store of all objects across different types of queries and responses.</p>
<p>The environment is how the tree stores all objects across different types of queries and responses.
This includes things like retrieved objects, retrieved metadata, retrieved summaries, etc.</p>
<p>This is persistent across the tree, so that all agents are aware of the same objects.</p>
<p>The environment is formatted and keyed as follows:
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="p">{</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="s2">&quot;tool_name&quot;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>        <span class="s2">&quot;result_name&quot;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>            <span class="p">{</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>                <span class="s2">&quot;metadata&quot;</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>                <span class="s2">&quot;objects&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">],</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>            <span class="p">},</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>            <span class="o">...</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>        <span class="p">]</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>    <span class="p">}</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="p">}</span>
</code></pre></div></p>
<p>Where <code>"tool_name"</code> is the name of the function that the result belongs to,
e.g. if the result came from a tool called <code>"query"</code>, then <code>"tool_name"</code> is <code>"query"</code>.</p>
<p><code>"result_name"</code> is the name of the Result object, which can be customised,
e.g. if the result comes from a specific collection, then <code>"result_name"</code> is the name of the collection.</p>
<p><code>"metadata"</code> is the metadata of the result,
e.g. the time taken to retrieve the result, the query used, etc.</p>
<p><code>"objects"</code> is the list of objects retrieved from the result. This is a list of dictionaries, where each dictionary is an object.
It is important that <code>objects</code> should have be list of dictionaries.
e.g. each object that was returned from a retrieval, where the fields of each dictionary are the fields of the object returned.</p>
<p>Each list under <code>result_name</code> is a dictionary with both <code>metadata</code> and <code>objects</code> keys.
This is if, for example, you retrieve multiple objects from the same collection, each one is stored with different metadata.
Because, for example, the query used to retrieve each object may be different (and stored differently in the metadata).</p>
<p>The environment is initialised with a default "SelfInfo.generic" key, which is a list of one object, containing information about Elysia itself.</p>
<p>You can use various methods to add, remove, replace, and find objects in the environment. See the methods below for more information.</p>
<p>Within the environment, there is a variable called <code>hidden_environment</code>, which is a dictionary of key-value pairs.
This is used to store information that is not shown to the LLM, but is instead a 'store' of data that can be used across tools.</p>








              <details class="quote">
                <summary>Source code in <code>elysia/tree/objects.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-15"> 15</a></span>
<span class="normal"><a href="#__codelineno-0-16"> 16</a></span>
<span class="normal"><a href="#__codelineno-0-17"> 17</a></span>
<span class="normal"><a href="#__codelineno-0-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-0-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-0-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-0-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-0-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-0-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-0-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-0-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-0-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-0-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-0-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-0-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-0-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-0-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-0-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-0-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-0-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-0-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-0-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-0-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-0-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-0-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-0-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-0-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-0-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-0-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-0-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-0-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-0-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-0-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-0-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-0-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-0-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-0-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-0-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-0-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-0-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="k">class</span><span class="w"> </span><span class="nc">Environment</span><span class="p">:</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="sd">    Store of all objects across different types of queries and responses.</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="sd">    The environment is how the tree stores all objects across different types of queries and responses.</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="sd">    This includes things like retrieved objects, retrieved metadata, retrieved summaries, etc.</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="sd">    This is persistent across the tree, so that all agents are aware of the same objects.</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="sd">    The environment is formatted and keyed as follows:</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="sd">    ```python</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="sd">    {</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">        &quot;tool_name&quot;: {</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">            &quot;result_name&quot;: [</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">                {</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">                    &quot;metadata&quot;: dict,</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">                    &quot;objects&quot;: list[dict],</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">                },</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">                ...</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">            ]</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">        }</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">    }</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">    ```</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">    Where `&quot;tool_name&quot;` is the name of the function that the result belongs to,</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">    e.g. if the result came from a tool called `&quot;query&quot;`, then `&quot;tool_name&quot;` is `&quot;query&quot;`.</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">    `&quot;result_name&quot;` is the name of the Result object, which can be customised,</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="sd">    e.g. if the result comes from a specific collection, then `&quot;result_name&quot;` is the name of the collection.</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">    `&quot;metadata&quot;` is the metadata of the result,</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="sd">    e.g. the time taken to retrieve the result, the query used, etc.</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">    `&quot;objects&quot;` is the list of objects retrieved from the result. This is a list of dictionaries, where each dictionary is an object.</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">    It is important that `objects` should have be list of dictionaries.</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">    e.g. each object that was returned from a retrieval, where the fields of each dictionary are the fields of the object returned.</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="sd">    Each list under `result_name` is a dictionary with both `metadata` and `objects` keys.</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="sd">    This is if, for example, you retrieve multiple objects from the same collection, each one is stored with different metadata.</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="sd">    Because, for example, the query used to retrieve each object may be different (and stored differently in the metadata).</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="sd">    The environment is initialised with a default &quot;SelfInfo.generic&quot; key, which is a list of one object, containing information about Elysia itself.</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="sd">    You can use various methods to add, remove, replace, and find objects in the environment. See the methods below for more information.</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="sd">    Within the environment, there is a variable called `hidden_environment`, which is a dictionary of key-value pairs.</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="sd">    This is used to store information that is not shown to the LLM, but is instead a &#39;store&#39; of data that can be used across tools.</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>        <span class="n">environment</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>        <span class="n">self_info</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>        <span class="n">hidden_environment</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{},</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>    <span class="p">):</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>        <span class="k">if</span> <span class="n">environment</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>            <span class="n">environment</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">environment</span> <span class="o">=</span> <span class="n">environment</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">hidden_environment</span> <span class="o">=</span> <span class="n">hidden_environment</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">self_info</span> <span class="o">=</span> <span class="n">self_info</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>        <span class="k">if</span> <span class="n">self_info</span><span class="p">:</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="p">[</span><span class="s2">&quot;SelfInfo&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="p">[</span><span class="s2">&quot;SelfInfo&quot;</span><span class="p">][</span><span class="s2">&quot;info&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>                <span class="p">{</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Elysia&quot;</span><span class="p">,</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;An agentic RAG service in Weaviate.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>                    <span class="s2">&quot;purpose&quot;</span><span class="p">:</span> <span class="n">remove_whitespace</span><span class="p">(</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="w">                        </span><span class="sd">&quot;&quot;&quot;Elysia is an agentic retrieval augmented generation (RAG) service, where users can query from Weaviate collections,</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">                    and the assistant will retrieve the most relevant information and answer the user&#39;s question. This includes a variety</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="sd">                    of different ways to query, such as by filtering, sorting, querying multiple collections, and providing summaries</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="sd">                    and textual responses.</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">                    Elysia will dynamically display retrieved objects from the collections in the frontend.</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="sd">                    Elysia works via a tree-based approach, where the user&#39;s question is used to generate a tree of potential</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="sd">                    queries to retrieve the most relevant information.</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">                    Each end of the tree connects to a separate agent that will perform a specific task, such as retrieval, aggregation, or generation, or more.</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="sd">                    The tree itself has decision nodes that determine the next step in the query.</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="sd">                    The decision nodes are decided via a decision-agent, which decides the task.</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">                    The agents communicate via a series of different prompts, which are stored in the prompt-library.</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="sd">                    The decision-agent prompts are designed to be as general as possible, so that they can be used for a variety of different tasks.</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">                    Some of these variables include conversation history, retrieved objects, the user&#39;s original question, train of thought via model reasoning, and more.</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">                    The backend of Elysia is built with a range of libraries. Elysia is built with a lot of base python, and was constructed from the ground up to keep it as modular as possible.</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="sd">                    The LLM components are built with DSPy, a library for training and running LLMs.</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="sd">                    &quot;&quot;&quot;</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>                    <span class="p">),</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>                <span class="p">}</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>            <span class="p">]</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_empty</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a><span class="sd">        Check if the environment is empty.</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="sd">        The &quot;SelfInfo&quot; key is not counted towards the empty environment.</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="sd">        If the `.remove` method has been used, this is accounted for (e.g. empty lists count towards an empty environment).</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>        <span class="n">empty</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>        <span class="k">for</span> <span class="n">tool_key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>            <span class="k">if</span> <span class="n">tool_key</span> <span class="o">==</span> <span class="s2">&quot;SelfInfo&quot;</span><span class="p">:</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>                <span class="k">continue</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>            <span class="k">for</span> <span class="n">result_key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="p">[</span><span class="n">tool_key</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="p">[</span><span class="n">tool_key</span><span class="p">][</span><span class="n">result_key</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>                    <span class="n">empty</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>                    <span class="k">break</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>        <span class="k">return</span> <span class="n">empty</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">result</span><span class="p">:</span> <span class="n">Result</span><span class="p">,</span> <span class="n">include_duplicates</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">        Adds a result to the environment.</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">        Is called automatically by the tree when a result is returned from an agent.</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">        You can also add a result to the environment manually by using this method.</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="sd">        In this case, you must be adding a &#39;Result&#39; object (which has an implicit &#39;name&#39; attribute used to key the environment).</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="sd">        If you want to add something manually, you can use the `add_objects` method.</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">        Each item is added with a `_REF_ID` attribute, which is a unique identifier used to identify the object in the environment.</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">        If duplicate objects are detected, they are added with a duplicate `_REF_ID` entry detailing that they are a duplicate,</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">        as well as the `_REF_ID` of the original object.</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">            tool_name (str): The name of the tool called that the result belongs to.</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="sd">            result (Result): The result to add to the environment.</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="sd">            include_duplicates (bool): Optional. Whether to include duplicate objects in the environment.</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">                Defaults to `False`, which still adds the duplicate object, but with a duplicate `_REF_ID` entry (and no repeating properties).</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="sd">                If `True`, the duplicate object is added with a new `_REF_ID` entry, and the repeated properties are added to the object.</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>        <span class="n">objects</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>        <span class="n">name</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">name</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>        <span class="n">metadata</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">metadata</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>        <span class="k">if</span> <span class="n">tool_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="p">:</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="p">[</span><span class="n">tool_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">add_objects</span><span class="p">(</span><span class="n">tool_name</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">objects</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span> <span class="n">include_duplicates</span><span class="p">)</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">add_objects</span><span class="p">(</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>        <span class="n">tool_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>        <span class="n">objects</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">],</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>        <span class="n">metadata</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>        <span class="n">include_duplicates</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>    <span class="p">):</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">        Adds an object to the environment.</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">        Is not called automatically by the tree, so you must manually call this method.</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="sd">        This is useful if you want to add an object to the environment manually that doesn&#39;t come from a Result object.</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">        Each item is added with a `_REF_ID` attribute, which is a unique identifier used to identify the object in the environment.</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="sd">        If duplicate objects are detected, they are added with a duplicate `_REF_ID` entry detailing that they are a duplicate,</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">        as well as the `_REF_ID` of the original object.</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="sd">            tool_name (str): The name of the tool called that the result belongs to.</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="sd">            name (str): The name of the result.</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="sd">            objects (list[dict]): The objects to add to the environment.</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a><span class="sd">            metadata (dict): Optional. The metadata of the objects to add to the environment.</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a><span class="sd">                Defaults to an empty dictionary.</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a><span class="sd">            include_duplicates (bool): Optional. Whether to include duplicate objects in the environment.</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a><span class="sd">                Defaults to `False`, which still adds the duplicate object, but with a duplicate `_REF_ID` entry (and no repeating properties).</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="sd">                If `True`, the duplicate object is added with a new `_REF_ID` entry, and the repeated properties are added to the object.</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>        <span class="k">if</span> <span class="n">tool_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="p">:</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="p">[</span><span class="n">tool_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>        <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="p">[</span><span class="n">tool_name</span><span class="p">]:</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="p">[</span><span class="n">tool_name</span><span class="p">][</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">objects</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="p">[</span><span class="n">tool_name</span><span class="p">][</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>                <span class="p">{</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>                    <span class="s2">&quot;metadata&quot;</span><span class="p">:</span> <span class="n">metadata</span><span class="p">,</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>                    <span class="s2">&quot;objects&quot;</span><span class="p">:</span> <span class="p">[],</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>                <span class="p">}</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>            <span class="p">)</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">obj</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">objects</span><span class="p">):</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>                <span class="c1"># check if the object is already in the environment</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>                <span class="n">obj_found</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>                <span class="n">where_obj</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>                <span class="k">for</span> <span class="n">env_item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="p">[</span><span class="n">tool_name</span><span class="p">][</span><span class="n">name</span><span class="p">]:</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>                    <span class="k">if</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">env_item</span><span class="p">[</span><span class="s2">&quot;objects&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>                        <span class="n">obj_found</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>                        <span class="n">where_obj</span> <span class="o">=</span> <span class="n">env_item</span><span class="p">[</span><span class="s2">&quot;objects&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>                        <span class="n">_REF_ID</span> <span class="o">=</span> <span class="n">env_item</span><span class="p">[</span><span class="s2">&quot;objects&quot;</span><span class="p">][</span><span class="n">where_obj</span><span class="p">][</span><span class="s2">&quot;_REF_ID&quot;</span><span class="p">]</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>                        <span class="k">break</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>                <span class="k">if</span> <span class="n">obj_found</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">include_duplicates</span><span class="p">:</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="p">[</span><span class="n">tool_name</span><span class="p">][</span><span class="n">name</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;objects&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>                        <span class="p">{</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>                            <span class="s2">&quot;object_info&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;[repeat]&quot;</span><span class="p">,</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>                            <span class="s2">&quot;_REF_ID&quot;</span><span class="p">:</span> <span class="n">_REF_ID</span><span class="p">,</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>                        <span class="p">}</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>                    <span class="p">)</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>                <span class="k">elif</span> <span class="s2">&quot;_REF_ID&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">obj</span><span class="p">:</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>                    <span class="n">_REF_ID</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">tool_name</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="p">[</span><span class="n">tool_name</span><span class="p">][</span><span class="n">name</span><span class="p">])</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="p">[</span><span class="n">tool_name</span><span class="p">][</span><span class="n">name</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;objects&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>                        <span class="p">{</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>                            <span class="s2">&quot;_REF_ID&quot;</span><span class="p">:</span> <span class="n">_REF_ID</span><span class="p">,</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>                            <span class="o">**</span><span class="n">obj</span><span class="p">,</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>                        <span class="p">}</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>                    <span class="p">)</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="p">[</span><span class="n">tool_name</span><span class="p">][</span><span class="n">name</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;objects&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">remove</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a><span class="sd">        Replaces the list of objects for the given `tool_name` and `name` with an empty list.</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a><span class="sd">            tool_name (str): The name of the tool called that the result belongs to.</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a><span class="sd">            name (str): The name of the result.</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a><span class="sd">            index (int | None): The index of the object to remove.</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a><span class="sd">                If `None`, the entire list corresponding to `tool_name`/`name` is deleted.</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a><span class="sd">                If an integer, the object at the given index is removed.</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a><span class="sd">                Defaults to `None`.</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a><span class="sd">                If `index=-1`, the last object is removed.</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>        <span class="k">if</span> <span class="n">tool_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="p">:</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>            <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="p">[</span><span class="n">tool_name</span><span class="p">]:</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>                <span class="k">if</span> <span class="n">index</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="p">[</span><span class="n">tool_name</span><span class="p">][</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="p">[</span><span class="n">tool_name</span><span class="p">][</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">replace</span><span class="p">(</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>        <span class="n">tool_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>        <span class="n">objects</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">],</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>        <span class="n">metadata</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>        <span class="n">index</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>    <span class="p">):</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a><span class="sd">        Replaces the list of objects for the given `tool_name` and `name` with the given list of objects.</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a><span class="sd">            tool_name (str): The name of the tool called that the result belongs to.</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a><span class="sd">            name (str): The name of the result.</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a><span class="sd">            objects (list[dict]): The objects to replace the existing objects with.</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a><span class="sd">            metadata (dict): The metadata of the objects to replace the existing objects with.</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a><span class="sd">            index (int | None): The index of the object to replace.</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a><span class="sd">                If `None`, the entire list corresponding to `tool_name`/`name` is deleted and replaced with the new objects.</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a><span class="sd">                If an integer, the object at the given index is replaced with the new objects.</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a><span class="sd">                Defaults to `None`.</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>        <span class="k">if</span> <span class="n">tool_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="p">:</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>            <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="p">[</span><span class="n">tool_name</span><span class="p">]:</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>                <span class="k">if</span> <span class="n">index</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="p">[</span><span class="n">tool_name</span><span class="p">][</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>                        <span class="p">{</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>                            <span class="s2">&quot;metadata&quot;</span><span class="p">:</span> <span class="n">metadata</span><span class="p">,</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>                            <span class="s2">&quot;objects&quot;</span><span class="p">:</span> <span class="n">objects</span><span class="p">,</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>                        <span class="p">}</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>                    <span class="p">]</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="p">[</span><span class="n">tool_name</span><span class="p">][</span><span class="n">name</span><span class="p">][</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>                        <span class="s2">&quot;metadata&quot;</span><span class="p">:</span> <span class="n">metadata</span><span class="p">,</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>                        <span class="s2">&quot;objects&quot;</span><span class="p">:</span> <span class="n">objects</span><span class="p">,</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>                    <span class="p">}</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">find</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a><span class="sd">        Finds a corresponding list of objects in the environment.</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a><span class="sd">        Keyed via `tool_name` and `name`. See the base class description for more information on how the environment is keyed.</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a><span class="sd">            tool_name (str): The name of the tool called that the result belongs to.</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a><span class="sd">            name (str): The name of the result.</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a><span class="sd">            index (int | None): The index of the object to find.</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a><span class="sd">                If `None`, the entire list corresponding to `tool_name`/`name` is returned.</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a><span class="sd">                If an integer, the object at the given index is returned.</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a><span class="sd">            (list[dict]): if `index` is `None` - The list of objects for the given `tool_name` and `name`.</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a><span class="sd">            (dict): if `index` is an integer - The object at the given `index` for the given `tool_name` and `name`.</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a><span class="sd">            (None): If the `tool_name` or `name` is not found in the environment.</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>        <span class="k">if</span> <span class="n">tool_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="p">:</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>            <span class="k">return</span> <span class="kc">None</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>        <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="p">[</span><span class="n">tool_name</span><span class="p">]:</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>            <span class="k">return</span> <span class="kc">None</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>        <span class="k">if</span> <span class="n">index</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="p">[</span><span class="n">tool_name</span><span class="p">][</span><span class="n">name</span><span class="p">]</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="p">[</span><span class="n">tool_name</span><span class="p">][</span><span class="n">name</span><span class="p">][</span><span class="n">index</span><span class="p">]</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">to_json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">remove_unserialisable</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a><span class="sd">        Converts the environment to a JSON serialisable format.</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a><span class="sd">        Used to access specific objects from the environment.</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>        <span class="n">env_copy</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="p">)</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>        <span class="n">hidden_env_copy</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hidden_environment</span><span class="p">)</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a>        <span class="c1"># Check if environment and hidden_environment are JSON serialisable</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>        <span class="k">for</span> <span class="n">tool_name</span> <span class="ow">in</span> <span class="n">env_copy</span><span class="p">:</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>            <span class="k">if</span> <span class="n">tool_name</span> <span class="o">!=</span> <span class="s2">&quot;SelfInfo&quot;</span><span class="p">:</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a>                <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="p">[</span><span class="n">tool_name</span><span class="p">]:</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a>                    <span class="k">for</span> <span class="n">obj_metadata</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="p">[</span><span class="n">tool_name</span><span class="p">][</span><span class="n">name</span><span class="p">]:</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a>                        <span class="n">format_dict_to_serialisable</span><span class="p">(</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a>                            <span class="n">obj_metadata</span><span class="p">[</span><span class="s2">&quot;metadata&quot;</span><span class="p">],</span> <span class="n">remove_unserialisable</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a>                        <span class="p">)</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a>                        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">obj_metadata</span><span class="p">[</span><span class="s2">&quot;objects&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a>                            <span class="n">format_dict_to_serialisable</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">remove_unserialisable</span><span class="p">)</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a>        <span class="n">format_dict_to_serialisable</span><span class="p">(</span><span class="n">hidden_env_copy</span><span class="p">,</span> <span class="n">remove_unserialisable</span><span class="p">)</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>        <span class="k">return</span> <span class="p">{</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a>            <span class="s2">&quot;environment&quot;</span><span class="p">:</span> <span class="n">env_copy</span><span class="p">,</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a>            <span class="s2">&quot;hidden_environment&quot;</span><span class="p">:</span> <span class="n">hidden_env_copy</span><span class="p">,</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>            <span class="s2">&quot;self_info&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">self_info</span><span class="p">,</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a>        <span class="p">}</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>    <span class="nd">@classmethod</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">from_json</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">json_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>            <span class="n">environment</span><span class="o">=</span><span class="n">json_data</span><span class="p">[</span><span class="s2">&quot;environment&quot;</span><span class="p">],</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>            <span class="n">hidden_environment</span><span class="o">=</span><span class="n">json_data</span><span class="p">[</span><span class="s2">&quot;hidden_environment&quot;</span><span class="p">],</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>            <span class="n">self_info</span><span class="o">=</span><span class="n">json_data</span><span class="p">[</span><span class="s2">&quot;self_info&quot;</span><span class="p">],</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="elysia.tree.objects.Environment.add" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add</span><span class="p">(</span><span class="n">tool_name</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="n">include_duplicates</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Adds a result to the environment.
Is called automatically by the tree when a result is returned from an agent.</p>
<p>You can also add a result to the environment manually by using this method.
In this case, you must be adding a 'Result' object (which has an implicit 'name' attribute used to key the environment).
If you want to add something manually, you can use the <code>add_objects</code> method.</p>
<p>Each item is added with a <code>_REF_ID</code> attribute, which is a unique identifier used to identify the object in the environment.
If duplicate objects are detected, they are added with a duplicate <code>_REF_ID</code> entry detailing that they are a duplicate,
as well as the <code>_REF_ID</code> of the original object.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>tool_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the tool called that the result belongs to.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>result</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Result (elysia.objects.Result)" href="#elysia.objects.Result">Result</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The result to add to the environment.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>include_duplicates</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional. Whether to include duplicate objects in the environment.
Defaults to <code>False</code>, which still adds the duplicate object, but with a duplicate <code>_REF_ID</code> entry (and no repeating properties).
If <code>True</code>, the duplicate object is added with a new <code>_REF_ID</code> entry, and the repeated properties are added to the object.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>elysia/tree/objects.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="k">def</span><span class="w"> </span><span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">result</span><span class="p">:</span> <span class="n">Result</span><span class="p">,</span> <span class="n">include_duplicates</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">    Adds a result to the environment.</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">    Is called automatically by the tree when a result is returned from an agent.</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">    You can also add a result to the environment manually by using this method.</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="sd">    In this case, you must be adding a &#39;Result&#39; object (which has an implicit &#39;name&#39; attribute used to key the environment).</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="sd">    If you want to add something manually, you can use the `add_objects` method.</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">    Each item is added with a `_REF_ID` attribute, which is a unique identifier used to identify the object in the environment.</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">    If duplicate objects are detected, they are added with a duplicate `_REF_ID` entry detailing that they are a duplicate,</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">    as well as the `_REF_ID` of the original object.</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">        tool_name (str): The name of the tool called that the result belongs to.</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="sd">        result (Result): The result to add to the environment.</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="sd">        include_duplicates (bool): Optional. Whether to include duplicate objects in the environment.</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">            Defaults to `False`, which still adds the duplicate object, but with a duplicate `_REF_ID` entry (and no repeating properties).</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="sd">            If `True`, the duplicate object is added with a new `_REF_ID` entry, and the repeated properties are added to the object.</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>    <span class="n">objects</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>    <span class="n">name</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">name</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>    <span class="n">metadata</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">metadata</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>    <span class="k">if</span> <span class="n">tool_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="p">:</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="p">[</span><span class="n">tool_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">add_objects</span><span class="p">(</span><span class="n">tool_name</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">objects</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span> <span class="n">include_duplicates</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="elysia.tree.objects.Environment.add_objects" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_objects</span><span class="p">(</span><span class="n">tool_name</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">objects</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="p">{},</span> <span class="n">include_duplicates</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Adds an object to the environment.
Is not called automatically by the tree, so you must manually call this method.
This is useful if you want to add an object to the environment manually that doesn't come from a Result object.</p>
<p>Each item is added with a <code>_REF_ID</code> attribute, which is a unique identifier used to identify the object in the environment.
If duplicate objects are detected, they are added with a duplicate <code>_REF_ID</code> entry detailing that they are a duplicate,
as well as the <code>_REF_ID</code> of the original object.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>tool_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the tool called that the result belongs to.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the result.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>objects</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="dict">dict</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The objects to add to the environment.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>metadata</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional. The metadata of the objects to add to the environment.
Defaults to an empty dictionary.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>include_duplicates</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional. Whether to include duplicate objects in the environment.
Defaults to <code>False</code>, which still adds the duplicate object, but with a duplicate <code>_REF_ID</code> entry (and no repeating properties).
If <code>True</code>, the duplicate object is added with a new <code>_REF_ID</code> entry, and the repeated properties are added to the object.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>elysia/tree/objects.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="k">def</span><span class="w"> </span><span class="nf">add_objects</span><span class="p">(</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>    <span class="n">tool_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>    <span class="n">objects</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">],</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>    <span class="n">metadata</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>    <span class="n">include_duplicates</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="p">):</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">    Adds an object to the environment.</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">    Is not called automatically by the tree, so you must manually call this method.</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="sd">    This is useful if you want to add an object to the environment manually that doesn&#39;t come from a Result object.</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">    Each item is added with a `_REF_ID` attribute, which is a unique identifier used to identify the object in the environment.</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="sd">    If duplicate objects are detected, they are added with a duplicate `_REF_ID` entry detailing that they are a duplicate,</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">    as well as the `_REF_ID` of the original object.</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="sd">        tool_name (str): The name of the tool called that the result belongs to.</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="sd">        name (str): The name of the result.</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="sd">        objects (list[dict]): The objects to add to the environment.</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a><span class="sd">        metadata (dict): Optional. The metadata of the objects to add to the environment.</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a><span class="sd">            Defaults to an empty dictionary.</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a><span class="sd">        include_duplicates (bool): Optional. Whether to include duplicate objects in the environment.</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a><span class="sd">            Defaults to `False`, which still adds the duplicate object, but with a duplicate `_REF_ID` entry (and no repeating properties).</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="sd">            If `True`, the duplicate object is added with a new `_REF_ID` entry, and the repeated properties are added to the object.</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>    <span class="k">if</span> <span class="n">tool_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="p">:</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="p">[</span><span class="n">tool_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>    <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="p">[</span><span class="n">tool_name</span><span class="p">]:</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="p">[</span><span class="n">tool_name</span><span class="p">][</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">objects</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="p">[</span><span class="n">tool_name</span><span class="p">][</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>            <span class="p">{</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>                <span class="s2">&quot;metadata&quot;</span><span class="p">:</span> <span class="n">metadata</span><span class="p">,</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>                <span class="s2">&quot;objects&quot;</span><span class="p">:</span> <span class="p">[],</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>            <span class="p">}</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>        <span class="p">)</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">obj</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">objects</span><span class="p">):</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>            <span class="c1"># check if the object is already in the environment</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>            <span class="n">obj_found</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>            <span class="n">where_obj</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>            <span class="k">for</span> <span class="n">env_item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="p">[</span><span class="n">tool_name</span><span class="p">][</span><span class="n">name</span><span class="p">]:</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>                <span class="k">if</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">env_item</span><span class="p">[</span><span class="s2">&quot;objects&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>                    <span class="n">obj_found</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>                    <span class="n">where_obj</span> <span class="o">=</span> <span class="n">env_item</span><span class="p">[</span><span class="s2">&quot;objects&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>                    <span class="n">_REF_ID</span> <span class="o">=</span> <span class="n">env_item</span><span class="p">[</span><span class="s2">&quot;objects&quot;</span><span class="p">][</span><span class="n">where_obj</span><span class="p">][</span><span class="s2">&quot;_REF_ID&quot;</span><span class="p">]</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>                    <span class="k">break</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>            <span class="k">if</span> <span class="n">obj_found</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">include_duplicates</span><span class="p">:</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="p">[</span><span class="n">tool_name</span><span class="p">][</span><span class="n">name</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;objects&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>                    <span class="p">{</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>                        <span class="s2">&quot;object_info&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;[repeat]&quot;</span><span class="p">,</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>                        <span class="s2">&quot;_REF_ID&quot;</span><span class="p">:</span> <span class="n">_REF_ID</span><span class="p">,</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>                    <span class="p">}</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>                <span class="p">)</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>            <span class="k">elif</span> <span class="s2">&quot;_REF_ID&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">obj</span><span class="p">:</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>                <span class="n">_REF_ID</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">tool_name</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="p">[</span><span class="n">tool_name</span><span class="p">][</span><span class="n">name</span><span class="p">])</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="p">[</span><span class="n">tool_name</span><span class="p">][</span><span class="n">name</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;objects&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>                    <span class="p">{</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>                        <span class="s2">&quot;_REF_ID&quot;</span><span class="p">:</span> <span class="n">_REF_ID</span><span class="p">,</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>                        <span class="o">**</span><span class="n">obj</span><span class="p">,</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>                    <span class="p">}</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>                <span class="p">)</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="p">[</span><span class="n">tool_name</span><span class="p">][</span><span class="n">name</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;objects&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="elysia.tree.objects.Environment.find" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">find</span><span class="p">(</span><span class="n">tool_name</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Finds a corresponding list of objects in the environment.
Keyed via <code>tool_name</code> and <code>name</code>. See the base class description for more information on how the environment is keyed.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>tool_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the tool called that the result belongs to.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the result.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>index</code>
            </td>
            <td>
                  <code><span title="int">int</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The index of the object to find.
If <code>None</code>, the entire list corresponding to <code>tool_name</code>/<code>name</code> is returned.
If an integer, the object at the given index is returned.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="dict">dict</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if <code>index</code> is <code>None</code> - The list of objects for the given <code>tool_name</code> and <code>name</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if <code>index</code> is an integer - The object at the given <code>index</code> for the given <code>tool_name</code> and <code>name</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the <code>tool_name</code> or <code>name</code> is not found in the environment.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>elysia/tree/objects.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-280" name="__codelineno-0-280"></a><span class="k">def</span><span class="w"> </span><span class="nf">find</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a><span class="sd">    Finds a corresponding list of objects in the environment.</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a><span class="sd">    Keyed via `tool_name` and `name`. See the base class description for more information on how the environment is keyed.</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a><span class="sd">        tool_name (str): The name of the tool called that the result belongs to.</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a><span class="sd">        name (str): The name of the result.</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a><span class="sd">        index (int | None): The index of the object to find.</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a><span class="sd">            If `None`, the entire list corresponding to `tool_name`/`name` is returned.</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a><span class="sd">            If an integer, the object at the given index is returned.</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a><span class="sd">        (list[dict]): if `index` is `None` - The list of objects for the given `tool_name` and `name`.</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a><span class="sd">        (dict): if `index` is an integer - The object at the given `index` for the given `tool_name` and `name`.</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a><span class="sd">        (None): If the `tool_name` or `name` is not found in the environment.</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>    <span class="k">if</span> <span class="n">tool_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="p">:</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>        <span class="k">return</span> <span class="kc">None</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>    <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="p">[</span><span class="n">tool_name</span><span class="p">]:</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>        <span class="k">return</span> <span class="kc">None</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>    <span class="k">if</span> <span class="n">index</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="p">[</span><span class="n">tool_name</span><span class="p">][</span><span class="n">name</span><span class="p">]</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="p">[</span><span class="n">tool_name</span><span class="p">][</span><span class="n">name</span><span class="p">][</span><span class="n">index</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="elysia.tree.objects.Environment.is_empty" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_empty</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Check if the environment is empty.</p>
<p>The "SelfInfo" key is not counted towards the empty environment.</p>
<p>If the <code>.remove</code> method has been used, this is accounted for (e.g. empty lists count towards an empty environment).</p>


            <details class="quote">
              <summary>Source code in <code>elysia/tree/objects.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="k">def</span><span class="w"> </span><span class="nf">is_empty</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a><span class="sd">    Check if the environment is empty.</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="sd">    The &quot;SelfInfo&quot; key is not counted towards the empty environment.</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="sd">    If the `.remove` method has been used, this is accounted for (e.g. empty lists count towards an empty environment).</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>    <span class="n">empty</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>    <span class="k">for</span> <span class="n">tool_key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>        <span class="k">if</span> <span class="n">tool_key</span> <span class="o">==</span> <span class="s2">&quot;SelfInfo&quot;</span><span class="p">:</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>            <span class="k">continue</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>        <span class="k">for</span> <span class="n">result_key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="p">[</span><span class="n">tool_key</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="p">[</span><span class="n">tool_key</span><span class="p">][</span><span class="n">result_key</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>                <span class="n">empty</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>                <span class="k">break</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>    <span class="k">return</span> <span class="n">empty</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="elysia.tree.objects.Environment.remove" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">remove</span><span class="p">(</span><span class="n">tool_name</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Replaces the list of objects for the given <code>tool_name</code> and <code>name</code> with an empty list.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>tool_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the tool called that the result belongs to.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the result.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>index</code>
            </td>
            <td>
                  <code><span title="int">int</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The index of the object to remove.
If <code>None</code>, the entire list corresponding to <code>tool_name</code>/<code>name</code> is deleted.
If an integer, the object at the given index is removed.
Defaults to <code>None</code>.
If <code>index=-1</code>, the last object is removed.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>elysia/tree/objects.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-224" name="__codelineno-0-224"></a><span class="k">def</span><span class="w"> </span><span class="nf">remove</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a><span class="sd">    Replaces the list of objects for the given `tool_name` and `name` with an empty list.</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a><span class="sd">        tool_name (str): The name of the tool called that the result belongs to.</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a><span class="sd">        name (str): The name of the result.</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a><span class="sd">        index (int | None): The index of the object to remove.</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a><span class="sd">            If `None`, the entire list corresponding to `tool_name`/`name` is deleted.</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a><span class="sd">            If an integer, the object at the given index is removed.</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a><span class="sd">            Defaults to `None`.</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a><span class="sd">            If `index=-1`, the last object is removed.</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>    <span class="k">if</span> <span class="n">tool_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="p">:</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>        <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="p">[</span><span class="n">tool_name</span><span class="p">]:</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>            <span class="k">if</span> <span class="n">index</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="p">[</span><span class="n">tool_name</span><span class="p">][</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="p">[</span><span class="n">tool_name</span><span class="p">][</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="elysia.tree.objects.Environment.replace" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">replace</span><span class="p">(</span><span class="n">tool_name</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">objects</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="p">{},</span> <span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Replaces the list of objects for the given <code>tool_name</code> and <code>name</code> with the given list of objects.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>tool_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the tool called that the result belongs to.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the result.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>objects</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="dict">dict</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The objects to replace the existing objects with.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>metadata</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The metadata of the objects to replace the existing objects with.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>index</code>
            </td>
            <td>
                  <code><span title="int">int</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The index of the object to replace.
If <code>None</code>, the entire list corresponding to <code>tool_name</code>/<code>name</code> is deleted and replaced with the new objects.
If an integer, the object at the given index is replaced with the new objects.
Defaults to <code>None</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>elysia/tree/objects.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="k">def</span><span class="w"> </span><span class="nf">replace</span><span class="p">(</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>    <span class="n">tool_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>    <span class="n">objects</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">],</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>    <span class="n">metadata</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>    <span class="n">index</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a><span class="p">):</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a><span class="sd">    Replaces the list of objects for the given `tool_name` and `name` with the given list of objects.</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a><span class="sd">        tool_name (str): The name of the tool called that the result belongs to.</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a><span class="sd">        name (str): The name of the result.</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a><span class="sd">        objects (list[dict]): The objects to replace the existing objects with.</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a><span class="sd">        metadata (dict): The metadata of the objects to replace the existing objects with.</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a><span class="sd">        index (int | None): The index of the object to replace.</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a><span class="sd">            If `None`, the entire list corresponding to `tool_name`/`name` is deleted and replaced with the new objects.</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a><span class="sd">            If an integer, the object at the given index is replaced with the new objects.</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a><span class="sd">            Defaults to `None`.</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>    <span class="k">if</span> <span class="n">tool_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="p">:</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>        <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="p">[</span><span class="n">tool_name</span><span class="p">]:</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>            <span class="k">if</span> <span class="n">index</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="p">[</span><span class="n">tool_name</span><span class="p">][</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>                    <span class="p">{</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>                        <span class="s2">&quot;metadata&quot;</span><span class="p">:</span> <span class="n">metadata</span><span class="p">,</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>                        <span class="s2">&quot;objects&quot;</span><span class="p">:</span> <span class="n">objects</span><span class="p">,</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>                    <span class="p">}</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>                <span class="p">]</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="p">[</span><span class="n">tool_name</span><span class="p">][</span><span class="n">name</span><span class="p">][</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>                    <span class="s2">&quot;metadata&quot;</span><span class="p">:</span> <span class="n">metadata</span><span class="p">,</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>                    <span class="s2">&quot;objects&quot;</span><span class="p">:</span> <span class="n">objects</span><span class="p">,</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>                <span class="p">}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="elysia.tree.objects.Environment.to_json" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_json</span><span class="p">(</span><span class="n">remove_unserialisable</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Converts the environment to a JSON serialisable format.
Used to access specific objects from the environment.</p>


            <details class="quote">
              <summary>Source code in <code>elysia/tree/objects.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-308" name="__codelineno-0-308"></a><span class="k">def</span><span class="w"> </span><span class="nf">to_json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">remove_unserialisable</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a><span class="sd">    Converts the environment to a JSON serialisable format.</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a><span class="sd">    Used to access specific objects from the environment.</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>    <span class="n">env_copy</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="p">)</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>    <span class="n">hidden_env_copy</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hidden_environment</span><span class="p">)</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a>    <span class="c1"># Check if environment and hidden_environment are JSON serialisable</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>    <span class="k">for</span> <span class="n">tool_name</span> <span class="ow">in</span> <span class="n">env_copy</span><span class="p">:</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>        <span class="k">if</span> <span class="n">tool_name</span> <span class="o">!=</span> <span class="s2">&quot;SelfInfo&quot;</span><span class="p">:</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a>            <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="p">[</span><span class="n">tool_name</span><span class="p">]:</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a>                <span class="k">for</span> <span class="n">obj_metadata</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="p">[</span><span class="n">tool_name</span><span class="p">][</span><span class="n">name</span><span class="p">]:</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a>                    <span class="n">format_dict_to_serialisable</span><span class="p">(</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a>                        <span class="n">obj_metadata</span><span class="p">[</span><span class="s2">&quot;metadata&quot;</span><span class="p">],</span> <span class="n">remove_unserialisable</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a>                    <span class="p">)</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a>                    <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">obj_metadata</span><span class="p">[</span><span class="s2">&quot;objects&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a>                        <span class="n">format_dict_to_serialisable</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">remove_unserialisable</span><span class="p">)</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a>    <span class="n">format_dict_to_serialisable</span><span class="p">(</span><span class="n">hidden_env_copy</span><span class="p">,</span> <span class="n">remove_unserialisable</span><span class="p">)</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>    <span class="k">return</span> <span class="p">{</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a>        <span class="s2">&quot;environment&quot;</span><span class="p">:</span> <span class="n">env_copy</span><span class="p">,</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a>        <span class="s2">&quot;hidden_environment&quot;</span><span class="p">:</span> <span class="n">hidden_env_copy</span><span class="p">,</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>        <span class="s2">&quot;self_info&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">self_info</span><span class="p">,</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a>    <span class="p">}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="elysia.tree.objects.TreeData" class="doc doc-heading">
            <code>TreeData</code>


</h2>


    <div class="doc doc-contents ">


        <p>Store of data across the tree.
This includes things like conversation history, actions, decisions, etc.
These data are given to ALL agents, so every agent is aware of the stage of the decision processes.</p>
<p>This also contains functions that process the data into an LLM friendly format,
such as a string with extra description.
E.g. the number of trees completed is converted into a string (i/N)
     and additional warnings if i is close to N.</p>
<p>The TreeData has the following objects:</p>
<ul>
<li>collection_data (CollectionData): The collection metadata/schema, which contains information about the collections used in the tree.
    This is the store of data that is saved by the <code>preprocess</code> function, and retrieved on initialisation of this object.</li>
<li>atlas (Atlas): The atlas, described in the Atlas class.</li>
<li>user_prompt (str): The user's prompt.</li>
<li>conversation_history (list[dict]): The conversation history stored in the current tree, of the form:
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="p">[</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="p">{</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>        <span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;user&quot;</span> <span class="o">|</span> <span class="s2">&quot;assistant&quot;</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>        <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="p">},</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    <span class="o">...</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="p">]</span>
</code></pre></div></li>
<li>environment (Environment): The environment, described in the Environment class.</li>
<li>tasks_completed (list[dict]): The tasks completed as a list of dictionaries.
    This is separate from the environment, as it separates what tasks were completed in each prompt in which order.</li>
<li>num_trees_completed (int): The current level of the decision tree, how many iterations have been completed so far.</li>
<li>recursion_limit (int): The maximum number of iterations allowed in the decision tree.</li>
<li>errors (dict): A dictionary of self-healing errors that have occurred in the tree. Keyed by the function name that caused the error.</li>
</ul>
<p>In general, you should not initialise this class directly.
But you can access the data in this class to access the relevant data from the tree (in e.g. tool construction/usage).</p>








              <details class="quote">
                <summary>Source code in <code>elysia/tree/objects.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-545">545</a></span>
<span class="normal"><a href="#__codelineno-0-546">546</a></span>
<span class="normal"><a href="#__codelineno-0-547">547</a></span>
<span class="normal"><a href="#__codelineno-0-548">548</a></span>
<span class="normal"><a href="#__codelineno-0-549">549</a></span>
<span class="normal"><a href="#__codelineno-0-550">550</a></span>
<span class="normal"><a href="#__codelineno-0-551">551</a></span>
<span class="normal"><a href="#__codelineno-0-552">552</a></span>
<span class="normal"><a href="#__codelineno-0-553">553</a></span>
<span class="normal"><a href="#__codelineno-0-554">554</a></span>
<span class="normal"><a href="#__codelineno-0-555">555</a></span>
<span class="normal"><a href="#__codelineno-0-556">556</a></span>
<span class="normal"><a href="#__codelineno-0-557">557</a></span>
<span class="normal"><a href="#__codelineno-0-558">558</a></span>
<span class="normal"><a href="#__codelineno-0-559">559</a></span>
<span class="normal"><a href="#__codelineno-0-560">560</a></span>
<span class="normal"><a href="#__codelineno-0-561">561</a></span>
<span class="normal"><a href="#__codelineno-0-562">562</a></span>
<span class="normal"><a href="#__codelineno-0-563">563</a></span>
<span class="normal"><a href="#__codelineno-0-564">564</a></span>
<span class="normal"><a href="#__codelineno-0-565">565</a></span>
<span class="normal"><a href="#__codelineno-0-566">566</a></span>
<span class="normal"><a href="#__codelineno-0-567">567</a></span>
<span class="normal"><a href="#__codelineno-0-568">568</a></span>
<span class="normal"><a href="#__codelineno-0-569">569</a></span>
<span class="normal"><a href="#__codelineno-0-570">570</a></span>
<span class="normal"><a href="#__codelineno-0-571">571</a></span>
<span class="normal"><a href="#__codelineno-0-572">572</a></span>
<span class="normal"><a href="#__codelineno-0-573">573</a></span>
<span class="normal"><a href="#__codelineno-0-574">574</a></span>
<span class="normal"><a href="#__codelineno-0-575">575</a></span>
<span class="normal"><a href="#__codelineno-0-576">576</a></span>
<span class="normal"><a href="#__codelineno-0-577">577</a></span>
<span class="normal"><a href="#__codelineno-0-578">578</a></span>
<span class="normal"><a href="#__codelineno-0-579">579</a></span>
<span class="normal"><a href="#__codelineno-0-580">580</a></span>
<span class="normal"><a href="#__codelineno-0-581">581</a></span>
<span class="normal"><a href="#__codelineno-0-582">582</a></span>
<span class="normal"><a href="#__codelineno-0-583">583</a></span>
<span class="normal"><a href="#__codelineno-0-584">584</a></span>
<span class="normal"><a href="#__codelineno-0-585">585</a></span>
<span class="normal"><a href="#__codelineno-0-586">586</a></span>
<span class="normal"><a href="#__codelineno-0-587">587</a></span>
<span class="normal"><a href="#__codelineno-0-588">588</a></span>
<span class="normal"><a href="#__codelineno-0-589">589</a></span>
<span class="normal"><a href="#__codelineno-0-590">590</a></span>
<span class="normal"><a href="#__codelineno-0-591">591</a></span>
<span class="normal"><a href="#__codelineno-0-592">592</a></span>
<span class="normal"><a href="#__codelineno-0-593">593</a></span>
<span class="normal"><a href="#__codelineno-0-594">594</a></span>
<span class="normal"><a href="#__codelineno-0-595">595</a></span>
<span class="normal"><a href="#__codelineno-0-596">596</a></span>
<span class="normal"><a href="#__codelineno-0-597">597</a></span>
<span class="normal"><a href="#__codelineno-0-598">598</a></span>
<span class="normal"><a href="#__codelineno-0-599">599</a></span>
<span class="normal"><a href="#__codelineno-0-600">600</a></span>
<span class="normal"><a href="#__codelineno-0-601">601</a></span>
<span class="normal"><a href="#__codelineno-0-602">602</a></span>
<span class="normal"><a href="#__codelineno-0-603">603</a></span>
<span class="normal"><a href="#__codelineno-0-604">604</a></span>
<span class="normal"><a href="#__codelineno-0-605">605</a></span>
<span class="normal"><a href="#__codelineno-0-606">606</a></span>
<span class="normal"><a href="#__codelineno-0-607">607</a></span>
<span class="normal"><a href="#__codelineno-0-608">608</a></span>
<span class="normal"><a href="#__codelineno-0-609">609</a></span>
<span class="normal"><a href="#__codelineno-0-610">610</a></span>
<span class="normal"><a href="#__codelineno-0-611">611</a></span>
<span class="normal"><a href="#__codelineno-0-612">612</a></span>
<span class="normal"><a href="#__codelineno-0-613">613</a></span>
<span class="normal"><a href="#__codelineno-0-614">614</a></span>
<span class="normal"><a href="#__codelineno-0-615">615</a></span>
<span class="normal"><a href="#__codelineno-0-616">616</a></span>
<span class="normal"><a href="#__codelineno-0-617">617</a></span>
<span class="normal"><a href="#__codelineno-0-618">618</a></span>
<span class="normal"><a href="#__codelineno-0-619">619</a></span>
<span class="normal"><a href="#__codelineno-0-620">620</a></span>
<span class="normal"><a href="#__codelineno-0-621">621</a></span>
<span class="normal"><a href="#__codelineno-0-622">622</a></span>
<span class="normal"><a href="#__codelineno-0-623">623</a></span>
<span class="normal"><a href="#__codelineno-0-624">624</a></span>
<span class="normal"><a href="#__codelineno-0-625">625</a></span>
<span class="normal"><a href="#__codelineno-0-626">626</a></span>
<span class="normal"><a href="#__codelineno-0-627">627</a></span>
<span class="normal"><a href="#__codelineno-0-628">628</a></span>
<span class="normal"><a href="#__codelineno-0-629">629</a></span>
<span class="normal"><a href="#__codelineno-0-630">630</a></span>
<span class="normal"><a href="#__codelineno-0-631">631</a></span>
<span class="normal"><a href="#__codelineno-0-632">632</a></span>
<span class="normal"><a href="#__codelineno-0-633">633</a></span>
<span class="normal"><a href="#__codelineno-0-634">634</a></span>
<span class="normal"><a href="#__codelineno-0-635">635</a></span>
<span class="normal"><a href="#__codelineno-0-636">636</a></span>
<span class="normal"><a href="#__codelineno-0-637">637</a></span>
<span class="normal"><a href="#__codelineno-0-638">638</a></span>
<span class="normal"><a href="#__codelineno-0-639">639</a></span>
<span class="normal"><a href="#__codelineno-0-640">640</a></span>
<span class="normal"><a href="#__codelineno-0-641">641</a></span>
<span class="normal"><a href="#__codelineno-0-642">642</a></span>
<span class="normal"><a href="#__codelineno-0-643">643</a></span>
<span class="normal"><a href="#__codelineno-0-644">644</a></span>
<span class="normal"><a href="#__codelineno-0-645">645</a></span>
<span class="normal"><a href="#__codelineno-0-646">646</a></span>
<span class="normal"><a href="#__codelineno-0-647">647</a></span>
<span class="normal"><a href="#__codelineno-0-648">648</a></span>
<span class="normal"><a href="#__codelineno-0-649">649</a></span>
<span class="normal"><a href="#__codelineno-0-650">650</a></span>
<span class="normal"><a href="#__codelineno-0-651">651</a></span>
<span class="normal"><a href="#__codelineno-0-652">652</a></span>
<span class="normal"><a href="#__codelineno-0-653">653</a></span>
<span class="normal"><a href="#__codelineno-0-654">654</a></span>
<span class="normal"><a href="#__codelineno-0-655">655</a></span>
<span class="normal"><a href="#__codelineno-0-656">656</a></span>
<span class="normal"><a href="#__codelineno-0-657">657</a></span>
<span class="normal"><a href="#__codelineno-0-658">658</a></span>
<span class="normal"><a href="#__codelineno-0-659">659</a></span>
<span class="normal"><a href="#__codelineno-0-660">660</a></span>
<span class="normal"><a href="#__codelineno-0-661">661</a></span>
<span class="normal"><a href="#__codelineno-0-662">662</a></span>
<span class="normal"><a href="#__codelineno-0-663">663</a></span>
<span class="normal"><a href="#__codelineno-0-664">664</a></span>
<span class="normal"><a href="#__codelineno-0-665">665</a></span>
<span class="normal"><a href="#__codelineno-0-666">666</a></span>
<span class="normal"><a href="#__codelineno-0-667">667</a></span>
<span class="normal"><a href="#__codelineno-0-668">668</a></span>
<span class="normal"><a href="#__codelineno-0-669">669</a></span>
<span class="normal"><a href="#__codelineno-0-670">670</a></span>
<span class="normal"><a href="#__codelineno-0-671">671</a></span>
<span class="normal"><a href="#__codelineno-0-672">672</a></span>
<span class="normal"><a href="#__codelineno-0-673">673</a></span>
<span class="normal"><a href="#__codelineno-0-674">674</a></span>
<span class="normal"><a href="#__codelineno-0-675">675</a></span>
<span class="normal"><a href="#__codelineno-0-676">676</a></span>
<span class="normal"><a href="#__codelineno-0-677">677</a></span>
<span class="normal"><a href="#__codelineno-0-678">678</a></span>
<span class="normal"><a href="#__codelineno-0-679">679</a></span>
<span class="normal"><a href="#__codelineno-0-680">680</a></span>
<span class="normal"><a href="#__codelineno-0-681">681</a></span>
<span class="normal"><a href="#__codelineno-0-682">682</a></span>
<span class="normal"><a href="#__codelineno-0-683">683</a></span>
<span class="normal"><a href="#__codelineno-0-684">684</a></span>
<span class="normal"><a href="#__codelineno-0-685">685</a></span>
<span class="normal"><a href="#__codelineno-0-686">686</a></span>
<span class="normal"><a href="#__codelineno-0-687">687</a></span>
<span class="normal"><a href="#__codelineno-0-688">688</a></span>
<span class="normal"><a href="#__codelineno-0-689">689</a></span>
<span class="normal"><a href="#__codelineno-0-690">690</a></span>
<span class="normal"><a href="#__codelineno-0-691">691</a></span>
<span class="normal"><a href="#__codelineno-0-692">692</a></span>
<span class="normal"><a href="#__codelineno-0-693">693</a></span>
<span class="normal"><a href="#__codelineno-0-694">694</a></span>
<span class="normal"><a href="#__codelineno-0-695">695</a></span>
<span class="normal"><a href="#__codelineno-0-696">696</a></span>
<span class="normal"><a href="#__codelineno-0-697">697</a></span>
<span class="normal"><a href="#__codelineno-0-698">698</a></span>
<span class="normal"><a href="#__codelineno-0-699">699</a></span>
<span class="normal"><a href="#__codelineno-0-700">700</a></span>
<span class="normal"><a href="#__codelineno-0-701">701</a></span>
<span class="normal"><a href="#__codelineno-0-702">702</a></span>
<span class="normal"><a href="#__codelineno-0-703">703</a></span>
<span class="normal"><a href="#__codelineno-0-704">704</a></span>
<span class="normal"><a href="#__codelineno-0-705">705</a></span>
<span class="normal"><a href="#__codelineno-0-706">706</a></span>
<span class="normal"><a href="#__codelineno-0-707">707</a></span>
<span class="normal"><a href="#__codelineno-0-708">708</a></span>
<span class="normal"><a href="#__codelineno-0-709">709</a></span>
<span class="normal"><a href="#__codelineno-0-710">710</a></span>
<span class="normal"><a href="#__codelineno-0-711">711</a></span>
<span class="normal"><a href="#__codelineno-0-712">712</a></span>
<span class="normal"><a href="#__codelineno-0-713">713</a></span>
<span class="normal"><a href="#__codelineno-0-714">714</a></span>
<span class="normal"><a href="#__codelineno-0-715">715</a></span>
<span class="normal"><a href="#__codelineno-0-716">716</a></span>
<span class="normal"><a href="#__codelineno-0-717">717</a></span>
<span class="normal"><a href="#__codelineno-0-718">718</a></span>
<span class="normal"><a href="#__codelineno-0-719">719</a></span>
<span class="normal"><a href="#__codelineno-0-720">720</a></span>
<span class="normal"><a href="#__codelineno-0-721">721</a></span>
<span class="normal"><a href="#__codelineno-0-722">722</a></span>
<span class="normal"><a href="#__codelineno-0-723">723</a></span>
<span class="normal"><a href="#__codelineno-0-724">724</a></span>
<span class="normal"><a href="#__codelineno-0-725">725</a></span>
<span class="normal"><a href="#__codelineno-0-726">726</a></span>
<span class="normal"><a href="#__codelineno-0-727">727</a></span>
<span class="normal"><a href="#__codelineno-0-728">728</a></span>
<span class="normal"><a href="#__codelineno-0-729">729</a></span>
<span class="normal"><a href="#__codelineno-0-730">730</a></span>
<span class="normal"><a href="#__codelineno-0-731">731</a></span>
<span class="normal"><a href="#__codelineno-0-732">732</a></span>
<span class="normal"><a href="#__codelineno-0-733">733</a></span>
<span class="normal"><a href="#__codelineno-0-734">734</a></span>
<span class="normal"><a href="#__codelineno-0-735">735</a></span>
<span class="normal"><a href="#__codelineno-0-736">736</a></span>
<span class="normal"><a href="#__codelineno-0-737">737</a></span>
<span class="normal"><a href="#__codelineno-0-738">738</a></span>
<span class="normal"><a href="#__codelineno-0-739">739</a></span>
<span class="normal"><a href="#__codelineno-0-740">740</a></span>
<span class="normal"><a href="#__codelineno-0-741">741</a></span>
<span class="normal"><a href="#__codelineno-0-742">742</a></span>
<span class="normal"><a href="#__codelineno-0-743">743</a></span>
<span class="normal"><a href="#__codelineno-0-744">744</a></span>
<span class="normal"><a href="#__codelineno-0-745">745</a></span>
<span class="normal"><a href="#__codelineno-0-746">746</a></span>
<span class="normal"><a href="#__codelineno-0-747">747</a></span>
<span class="normal"><a href="#__codelineno-0-748">748</a></span>
<span class="normal"><a href="#__codelineno-0-749">749</a></span>
<span class="normal"><a href="#__codelineno-0-750">750</a></span>
<span class="normal"><a href="#__codelineno-0-751">751</a></span>
<span class="normal"><a href="#__codelineno-0-752">752</a></span>
<span class="normal"><a href="#__codelineno-0-753">753</a></span>
<span class="normal"><a href="#__codelineno-0-754">754</a></span>
<span class="normal"><a href="#__codelineno-0-755">755</a></span>
<span class="normal"><a href="#__codelineno-0-756">756</a></span>
<span class="normal"><a href="#__codelineno-0-757">757</a></span>
<span class="normal"><a href="#__codelineno-0-758">758</a></span>
<span class="normal"><a href="#__codelineno-0-759">759</a></span>
<span class="normal"><a href="#__codelineno-0-760">760</a></span>
<span class="normal"><a href="#__codelineno-0-761">761</a></span>
<span class="normal"><a href="#__codelineno-0-762">762</a></span>
<span class="normal"><a href="#__codelineno-0-763">763</a></span>
<span class="normal"><a href="#__codelineno-0-764">764</a></span>
<span class="normal"><a href="#__codelineno-0-765">765</a></span>
<span class="normal"><a href="#__codelineno-0-766">766</a></span>
<span class="normal"><a href="#__codelineno-0-767">767</a></span>
<span class="normal"><a href="#__codelineno-0-768">768</a></span>
<span class="normal"><a href="#__codelineno-0-769">769</a></span>
<span class="normal"><a href="#__codelineno-0-770">770</a></span>
<span class="normal"><a href="#__codelineno-0-771">771</a></span>
<span class="normal"><a href="#__codelineno-0-772">772</a></span>
<span class="normal"><a href="#__codelineno-0-773">773</a></span>
<span class="normal"><a href="#__codelineno-0-774">774</a></span>
<span class="normal"><a href="#__codelineno-0-775">775</a></span>
<span class="normal"><a href="#__codelineno-0-776">776</a></span>
<span class="normal"><a href="#__codelineno-0-777">777</a></span>
<span class="normal"><a href="#__codelineno-0-778">778</a></span>
<span class="normal"><a href="#__codelineno-0-779">779</a></span>
<span class="normal"><a href="#__codelineno-0-780">780</a></span>
<span class="normal"><a href="#__codelineno-0-781">781</a></span>
<span class="normal"><a href="#__codelineno-0-782">782</a></span>
<span class="normal"><a href="#__codelineno-0-783">783</a></span>
<span class="normal"><a href="#__codelineno-0-784">784</a></span>
<span class="normal"><a href="#__codelineno-0-785">785</a></span>
<span class="normal"><a href="#__codelineno-0-786">786</a></span>
<span class="normal"><a href="#__codelineno-0-787">787</a></span>
<span class="normal"><a href="#__codelineno-0-788">788</a></span>
<span class="normal"><a href="#__codelineno-0-789">789</a></span>
<span class="normal"><a href="#__codelineno-0-790">790</a></span>
<span class="normal"><a href="#__codelineno-0-791">791</a></span>
<span class="normal"><a href="#__codelineno-0-792">792</a></span>
<span class="normal"><a href="#__codelineno-0-793">793</a></span>
<span class="normal"><a href="#__codelineno-0-794">794</a></span>
<span class="normal"><a href="#__codelineno-0-795">795</a></span>
<span class="normal"><a href="#__codelineno-0-796">796</a></span>
<span class="normal"><a href="#__codelineno-0-797">797</a></span>
<span class="normal"><a href="#__codelineno-0-798">798</a></span>
<span class="normal"><a href="#__codelineno-0-799">799</a></span>
<span class="normal"><a href="#__codelineno-0-800">800</a></span>
<span class="normal"><a href="#__codelineno-0-801">801</a></span>
<span class="normal"><a href="#__codelineno-0-802">802</a></span>
<span class="normal"><a href="#__codelineno-0-803">803</a></span>
<span class="normal"><a href="#__codelineno-0-804">804</a></span>
<span class="normal"><a href="#__codelineno-0-805">805</a></span>
<span class="normal"><a href="#__codelineno-0-806">806</a></span>
<span class="normal"><a href="#__codelineno-0-807">807</a></span>
<span class="normal"><a href="#__codelineno-0-808">808</a></span>
<span class="normal"><a href="#__codelineno-0-809">809</a></span>
<span class="normal"><a href="#__codelineno-0-810">810</a></span>
<span class="normal"><a href="#__codelineno-0-811">811</a></span>
<span class="normal"><a href="#__codelineno-0-812">812</a></span>
<span class="normal"><a href="#__codelineno-0-813">813</a></span>
<span class="normal"><a href="#__codelineno-0-814">814</a></span>
<span class="normal"><a href="#__codelineno-0-815">815</a></span>
<span class="normal"><a href="#__codelineno-0-816">816</a></span>
<span class="normal"><a href="#__codelineno-0-817">817</a></span>
<span class="normal"><a href="#__codelineno-0-818">818</a></span>
<span class="normal"><a href="#__codelineno-0-819">819</a></span>
<span class="normal"><a href="#__codelineno-0-820">820</a></span>
<span class="normal"><a href="#__codelineno-0-821">821</a></span>
<span class="normal"><a href="#__codelineno-0-822">822</a></span>
<span class="normal"><a href="#__codelineno-0-823">823</a></span>
<span class="normal"><a href="#__codelineno-0-824">824</a></span>
<span class="normal"><a href="#__codelineno-0-825">825</a></span>
<span class="normal"><a href="#__codelineno-0-826">826</a></span>
<span class="normal"><a href="#__codelineno-0-827">827</a></span>
<span class="normal"><a href="#__codelineno-0-828">828</a></span>
<span class="normal"><a href="#__codelineno-0-829">829</a></span>
<span class="normal"><a href="#__codelineno-0-830">830</a></span>
<span class="normal"><a href="#__codelineno-0-831">831</a></span>
<span class="normal"><a href="#__codelineno-0-832">832</a></span>
<span class="normal"><a href="#__codelineno-0-833">833</a></span>
<span class="normal"><a href="#__codelineno-0-834">834</a></span>
<span class="normal"><a href="#__codelineno-0-835">835</a></span>
<span class="normal"><a href="#__codelineno-0-836">836</a></span>
<span class="normal"><a href="#__codelineno-0-837">837</a></span>
<span class="normal"><a href="#__codelineno-0-838">838</a></span>
<span class="normal"><a href="#__codelineno-0-839">839</a></span>
<span class="normal"><a href="#__codelineno-0-840">840</a></span>
<span class="normal"><a href="#__codelineno-0-841">841</a></span>
<span class="normal"><a href="#__codelineno-0-842">842</a></span>
<span class="normal"><a href="#__codelineno-0-843">843</a></span>
<span class="normal"><a href="#__codelineno-0-844">844</a></span>
<span class="normal"><a href="#__codelineno-0-845">845</a></span>
<span class="normal"><a href="#__codelineno-0-846">846</a></span>
<span class="normal"><a href="#__codelineno-0-847">847</a></span>
<span class="normal"><a href="#__codelineno-0-848">848</a></span>
<span class="normal"><a href="#__codelineno-0-849">849</a></span>
<span class="normal"><a href="#__codelineno-0-850">850</a></span>
<span class="normal"><a href="#__codelineno-0-851">851</a></span>
<span class="normal"><a href="#__codelineno-0-852">852</a></span>
<span class="normal"><a href="#__codelineno-0-853">853</a></span>
<span class="normal"><a href="#__codelineno-0-854">854</a></span>
<span class="normal"><a href="#__codelineno-0-855">855</a></span>
<span class="normal"><a href="#__codelineno-0-856">856</a></span>
<span class="normal"><a href="#__codelineno-0-857">857</a></span>
<span class="normal"><a href="#__codelineno-0-858">858</a></span>
<span class="normal"><a href="#__codelineno-0-859">859</a></span>
<span class="normal"><a href="#__codelineno-0-860">860</a></span>
<span class="normal"><a href="#__codelineno-0-861">861</a></span>
<span class="normal"><a href="#__codelineno-0-862">862</a></span>
<span class="normal"><a href="#__codelineno-0-863">863</a></span>
<span class="normal"><a href="#__codelineno-0-864">864</a></span>
<span class="normal"><a href="#__codelineno-0-865">865</a></span>
<span class="normal"><a href="#__codelineno-0-866">866</a></span>
<span class="normal"><a href="#__codelineno-0-867">867</a></span>
<span class="normal"><a href="#__codelineno-0-868">868</a></span>
<span class="normal"><a href="#__codelineno-0-869">869</a></span>
<span class="normal"><a href="#__codelineno-0-870">870</a></span>
<span class="normal"><a href="#__codelineno-0-871">871</a></span>
<span class="normal"><a href="#__codelineno-0-872">872</a></span>
<span class="normal"><a href="#__codelineno-0-873">873</a></span>
<span class="normal"><a href="#__codelineno-0-874">874</a></span>
<span class="normal"><a href="#__codelineno-0-875">875</a></span>
<span class="normal"><a href="#__codelineno-0-876">876</a></span>
<span class="normal"><a href="#__codelineno-0-877">877</a></span>
<span class="normal"><a href="#__codelineno-0-878">878</a></span>
<span class="normal"><a href="#__codelineno-0-879">879</a></span>
<span class="normal"><a href="#__codelineno-0-880">880</a></span>
<span class="normal"><a href="#__codelineno-0-881">881</a></span>
<span class="normal"><a href="#__codelineno-0-882">882</a></span>
<span class="normal"><a href="#__codelineno-0-883">883</a></span>
<span class="normal"><a href="#__codelineno-0-884">884</a></span>
<span class="normal"><a href="#__codelineno-0-885">885</a></span>
<span class="normal"><a href="#__codelineno-0-886">886</a></span>
<span class="normal"><a href="#__codelineno-0-887">887</a></span>
<span class="normal"><a href="#__codelineno-0-888">888</a></span>
<span class="normal"><a href="#__codelineno-0-889">889</a></span>
<span class="normal"><a href="#__codelineno-0-890">890</a></span>
<span class="normal"><a href="#__codelineno-0-891">891</a></span>
<span class="normal"><a href="#__codelineno-0-892">892</a></span>
<span class="normal"><a href="#__codelineno-0-893">893</a></span>
<span class="normal"><a href="#__codelineno-0-894">894</a></span>
<span class="normal"><a href="#__codelineno-0-895">895</a></span>
<span class="normal"><a href="#__codelineno-0-896">896</a></span>
<span class="normal"><a href="#__codelineno-0-897">897</a></span>
<span class="normal"><a href="#__codelineno-0-898">898</a></span>
<span class="normal"><a href="#__codelineno-0-899">899</a></span>
<span class="normal"><a href="#__codelineno-0-900">900</a></span>
<span class="normal"><a href="#__codelineno-0-901">901</a></span>
<span class="normal"><a href="#__codelineno-0-902">902</a></span>
<span class="normal"><a href="#__codelineno-0-903">903</a></span>
<span class="normal"><a href="#__codelineno-0-904">904</a></span>
<span class="normal"><a href="#__codelineno-0-905">905</a></span>
<span class="normal"><a href="#__codelineno-0-906">906</a></span>
<span class="normal"><a href="#__codelineno-0-907">907</a></span>
<span class="normal"><a href="#__codelineno-0-908">908</a></span>
<span class="normal"><a href="#__codelineno-0-909">909</a></span>
<span class="normal"><a href="#__codelineno-0-910">910</a></span>
<span class="normal"><a href="#__codelineno-0-911">911</a></span>
<span class="normal"><a href="#__codelineno-0-912">912</a></span>
<span class="normal"><a href="#__codelineno-0-913">913</a></span>
<span class="normal"><a href="#__codelineno-0-914">914</a></span>
<span class="normal"><a href="#__codelineno-0-915">915</a></span>
<span class="normal"><a href="#__codelineno-0-916">916</a></span>
<span class="normal"><a href="#__codelineno-0-917">917</a></span>
<span class="normal"><a href="#__codelineno-0-918">918</a></span>
<span class="normal"><a href="#__codelineno-0-919">919</a></span>
<span class="normal"><a href="#__codelineno-0-920">920</a></span>
<span class="normal"><a href="#__codelineno-0-921">921</a></span>
<span class="normal"><a href="#__codelineno-0-922">922</a></span>
<span class="normal"><a href="#__codelineno-0-923">923</a></span>
<span class="normal"><a href="#__codelineno-0-924">924</a></span>
<span class="normal"><a href="#__codelineno-0-925">925</a></span>
<span class="normal"><a href="#__codelineno-0-926">926</a></span>
<span class="normal"><a href="#__codelineno-0-927">927</a></span>
<span class="normal"><a href="#__codelineno-0-928">928</a></span>
<span class="normal"><a href="#__codelineno-0-929">929</a></span>
<span class="normal"><a href="#__codelineno-0-930">930</a></span>
<span class="normal"><a href="#__codelineno-0-931">931</a></span>
<span class="normal"><a href="#__codelineno-0-932">932</a></span>
<span class="normal"><a href="#__codelineno-0-933">933</a></span>
<span class="normal"><a href="#__codelineno-0-934">934</a></span>
<span class="normal"><a href="#__codelineno-0-935">935</a></span>
<span class="normal"><a href="#__codelineno-0-936">936</a></span>
<span class="normal"><a href="#__codelineno-0-937">937</a></span>
<span class="normal"><a href="#__codelineno-0-938">938</a></span>
<span class="normal"><a href="#__codelineno-0-939">939</a></span>
<span class="normal"><a href="#__codelineno-0-940">940</a></span>
<span class="normal"><a href="#__codelineno-0-941">941</a></span>
<span class="normal"><a href="#__codelineno-0-942">942</a></span>
<span class="normal"><a href="#__codelineno-0-943">943</a></span>
<span class="normal"><a href="#__codelineno-0-944">944</a></span>
<span class="normal"><a href="#__codelineno-0-945">945</a></span>
<span class="normal"><a href="#__codelineno-0-946">946</a></span>
<span class="normal"><a href="#__codelineno-0-947">947</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-545" name="__codelineno-0-545"></a><span class="k">class</span><span class="w"> </span><span class="nc">TreeData</span><span class="p">:</span>
<a id="__codelineno-0-546" name="__codelineno-0-546"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-547" name="__codelineno-0-547"></a><span class="sd">    Store of data across the tree.</span>
<a id="__codelineno-0-548" name="__codelineno-0-548"></a><span class="sd">    This includes things like conversation history, actions, decisions, etc.</span>
<a id="__codelineno-0-549" name="__codelineno-0-549"></a><span class="sd">    These data are given to ALL agents, so every agent is aware of the stage of the decision processes.</span>
<a id="__codelineno-0-550" name="__codelineno-0-550"></a>
<a id="__codelineno-0-551" name="__codelineno-0-551"></a><span class="sd">    This also contains functions that process the data into an LLM friendly format,</span>
<a id="__codelineno-0-552" name="__codelineno-0-552"></a><span class="sd">    such as a string with extra description.</span>
<a id="__codelineno-0-553" name="__codelineno-0-553"></a><span class="sd">    E.g. the number of trees completed is converted into a string (i/N)</span>
<a id="__codelineno-0-554" name="__codelineno-0-554"></a><span class="sd">         and additional warnings if i is close to N.</span>
<a id="__codelineno-0-555" name="__codelineno-0-555"></a>
<a id="__codelineno-0-556" name="__codelineno-0-556"></a><span class="sd">    The TreeData has the following objects:</span>
<a id="__codelineno-0-557" name="__codelineno-0-557"></a>
<a id="__codelineno-0-558" name="__codelineno-0-558"></a><span class="sd">    - collection_data (CollectionData): The collection metadata/schema, which contains information about the collections used in the tree.</span>
<a id="__codelineno-0-559" name="__codelineno-0-559"></a><span class="sd">        This is the store of data that is saved by the `preprocess` function, and retrieved on initialisation of this object.</span>
<a id="__codelineno-0-560" name="__codelineno-0-560"></a><span class="sd">    - atlas (Atlas): The atlas, described in the Atlas class.</span>
<a id="__codelineno-0-561" name="__codelineno-0-561"></a><span class="sd">    - user_prompt (str): The user&#39;s prompt.</span>
<a id="__codelineno-0-562" name="__codelineno-0-562"></a><span class="sd">    - conversation_history (list[dict]): The conversation history stored in the current tree, of the form:</span>
<a id="__codelineno-0-563" name="__codelineno-0-563"></a><span class="sd">        ```python</span>
<a id="__codelineno-0-564" name="__codelineno-0-564"></a><span class="sd">        [</span>
<a id="__codelineno-0-565" name="__codelineno-0-565"></a><span class="sd">            {</span>
<a id="__codelineno-0-566" name="__codelineno-0-566"></a><span class="sd">                &quot;role&quot;: &quot;user&quot; | &quot;assistant&quot;,</span>
<a id="__codelineno-0-567" name="__codelineno-0-567"></a><span class="sd">                &quot;content&quot;: str,</span>
<a id="__codelineno-0-568" name="__codelineno-0-568"></a><span class="sd">            },</span>
<a id="__codelineno-0-569" name="__codelineno-0-569"></a><span class="sd">            ...</span>
<a id="__codelineno-0-570" name="__codelineno-0-570"></a><span class="sd">        ]</span>
<a id="__codelineno-0-571" name="__codelineno-0-571"></a><span class="sd">        ```</span>
<a id="__codelineno-0-572" name="__codelineno-0-572"></a><span class="sd">    - environment (Environment): The environment, described in the Environment class.</span>
<a id="__codelineno-0-573" name="__codelineno-0-573"></a><span class="sd">    - tasks_completed (list[dict]): The tasks completed as a list of dictionaries.</span>
<a id="__codelineno-0-574" name="__codelineno-0-574"></a><span class="sd">        This is separate from the environment, as it separates what tasks were completed in each prompt in which order.</span>
<a id="__codelineno-0-575" name="__codelineno-0-575"></a><span class="sd">    - num_trees_completed (int): The current level of the decision tree, how many iterations have been completed so far.</span>
<a id="__codelineno-0-576" name="__codelineno-0-576"></a><span class="sd">    - recursion_limit (int): The maximum number of iterations allowed in the decision tree.</span>
<a id="__codelineno-0-577" name="__codelineno-0-577"></a><span class="sd">    - errors (dict): A dictionary of self-healing errors that have occurred in the tree. Keyed by the function name that caused the error.</span>
<a id="__codelineno-0-578" name="__codelineno-0-578"></a>
<a id="__codelineno-0-579" name="__codelineno-0-579"></a><span class="sd">    In general, you should not initialise this class directly.</span>
<a id="__codelineno-0-580" name="__codelineno-0-580"></a><span class="sd">    But you can access the data in this class to access the relevant data from the tree (in e.g. tool construction/usage).</span>
<a id="__codelineno-0-581" name="__codelineno-0-581"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-582" name="__codelineno-0-582"></a>
<a id="__codelineno-0-583" name="__codelineno-0-583"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-584" name="__codelineno-0-584"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-585" name="__codelineno-0-585"></a>        <span class="n">collection_data</span><span class="p">:</span> <span class="n">CollectionData</span><span class="p">,</span>
<a id="__codelineno-0-586" name="__codelineno-0-586"></a>        <span class="n">atlas</span><span class="p">:</span> <span class="n">Atlas</span><span class="p">,</span>
<a id="__codelineno-0-587" name="__codelineno-0-587"></a>        <span class="n">user_prompt</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-588" name="__codelineno-0-588"></a>        <span class="n">conversation_history</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-589" name="__codelineno-0-589"></a>        <span class="n">environment</span><span class="p">:</span> <span class="n">Environment</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-590" name="__codelineno-0-590"></a>        <span class="n">tasks_completed</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-591" name="__codelineno-0-591"></a>        <span class="n">num_trees_completed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-592" name="__codelineno-0-592"></a>        <span class="n">recursion_limit</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-593" name="__codelineno-0-593"></a>        <span class="n">settings</span><span class="p">:</span> <span class="n">Settings</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-594" name="__codelineno-0-594"></a>    <span class="p">):</span>
<a id="__codelineno-0-595" name="__codelineno-0-595"></a>        <span class="k">if</span> <span class="n">settings</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-596" name="__codelineno-0-596"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">settings</span> <span class="o">=</span> <span class="n">environment_settings</span>
<a id="__codelineno-0-597" name="__codelineno-0-597"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-598" name="__codelineno-0-598"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">settings</span> <span class="o">=</span> <span class="n">settings</span>
<a id="__codelineno-0-599" name="__codelineno-0-599"></a>
<a id="__codelineno-0-600" name="__codelineno-0-600"></a>        <span class="c1"># -- Base Data --</span>
<a id="__codelineno-0-601" name="__codelineno-0-601"></a>        <span class="k">if</span> <span class="n">user_prompt</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-602" name="__codelineno-0-602"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">user_prompt</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-0-603" name="__codelineno-0-603"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-604" name="__codelineno-0-604"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">user_prompt</span> <span class="o">=</span> <span class="n">user_prompt</span>
<a id="__codelineno-0-605" name="__codelineno-0-605"></a>
<a id="__codelineno-0-606" name="__codelineno-0-606"></a>        <span class="k">if</span> <span class="n">conversation_history</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-607" name="__codelineno-0-607"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">conversation_history</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-608" name="__codelineno-0-608"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-609" name="__codelineno-0-609"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">conversation_history</span> <span class="o">=</span> <span class="n">conversation_history</span>
<a id="__codelineno-0-610" name="__codelineno-0-610"></a>
<a id="__codelineno-0-611" name="__codelineno-0-611"></a>        <span class="k">if</span> <span class="n">environment</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-612" name="__codelineno-0-612"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">environment</span> <span class="o">=</span> <span class="n">Environment</span><span class="p">()</span>
<a id="__codelineno-0-613" name="__codelineno-0-613"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-614" name="__codelineno-0-614"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">environment</span> <span class="o">=</span> <span class="n">environment</span>
<a id="__codelineno-0-615" name="__codelineno-0-615"></a>
<a id="__codelineno-0-616" name="__codelineno-0-616"></a>        <span class="k">if</span> <span class="n">tasks_completed</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-617" name="__codelineno-0-617"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">tasks_completed</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-618" name="__codelineno-0-618"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-619" name="__codelineno-0-619"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">tasks_completed</span> <span class="o">=</span> <span class="n">tasks_completed</span>
<a id="__codelineno-0-620" name="__codelineno-0-620"></a>
<a id="__codelineno-0-621" name="__codelineno-0-621"></a>        <span class="k">if</span> <span class="n">num_trees_completed</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-622" name="__codelineno-0-622"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">num_trees_completed</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-623" name="__codelineno-0-623"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-624" name="__codelineno-0-624"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">num_trees_completed</span> <span class="o">=</span> <span class="n">num_trees_completed</span>
<a id="__codelineno-0-625" name="__codelineno-0-625"></a>
<a id="__codelineno-0-626" name="__codelineno-0-626"></a>        <span class="k">if</span> <span class="n">recursion_limit</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-627" name="__codelineno-0-627"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">recursion_limit</span> <span class="o">=</span> <span class="mi">3</span>
<a id="__codelineno-0-628" name="__codelineno-0-628"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-629" name="__codelineno-0-629"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">recursion_limit</span> <span class="o">=</span> <span class="n">recursion_limit</span>
<a id="__codelineno-0-630" name="__codelineno-0-630"></a>
<a id="__codelineno-0-631" name="__codelineno-0-631"></a>        <span class="c1"># -- Atlas --</span>
<a id="__codelineno-0-632" name="__codelineno-0-632"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">atlas</span> <span class="o">=</span> <span class="n">atlas</span>
<a id="__codelineno-0-633" name="__codelineno-0-633"></a>
<a id="__codelineno-0-634" name="__codelineno-0-634"></a>        <span class="c1"># -- Collection Data --</span>
<a id="__codelineno-0-635" name="__codelineno-0-635"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">collection_data</span> <span class="o">=</span> <span class="n">collection_data</span>
<a id="__codelineno-0-636" name="__codelineno-0-636"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">collection_names</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-637" name="__codelineno-0-637"></a>
<a id="__codelineno-0-638" name="__codelineno-0-638"></a>        <span class="c1"># -- Errors --</span>
<a id="__codelineno-0-639" name="__codelineno-0-639"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-640" name="__codelineno-0-640"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current_task</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-641" name="__codelineno-0-641"></a>
<a id="__codelineno-0-642" name="__codelineno-0-642"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_property</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">property</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Any</span><span class="p">):</span>
<a id="__codelineno-0-643" name="__codelineno-0-643"></a>        <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="nb">property</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
<a id="__codelineno-0-644" name="__codelineno-0-644"></a>
<a id="__codelineno-0-645" name="__codelineno-0-645"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">update_string</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">property</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-646" name="__codelineno-0-646"></a>        <span class="k">if</span> <span class="nb">property</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">:</span>
<a id="__codelineno-0-647" name="__codelineno-0-647"></a>            <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="nb">property</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-0-648" name="__codelineno-0-648"></a>        <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="nb">property</span><span class="p">]</span> <span class="o">+=</span> <span class="n">value</span>
<a id="__codelineno-0-649" name="__codelineno-0-649"></a>
<a id="__codelineno-0-650" name="__codelineno-0-650"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">update_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">property</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Any</span><span class="p">):</span>
<a id="__codelineno-0-651" name="__codelineno-0-651"></a>        <span class="k">if</span> <span class="nb">property</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">:</span>
<a id="__codelineno-0-652" name="__codelineno-0-652"></a>            <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="nb">property</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-653" name="__codelineno-0-653"></a>        <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="nb">property</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<a id="__codelineno-0-654" name="__codelineno-0-654"></a>
<a id="__codelineno-0-655" name="__codelineno-0-655"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">update_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">property</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Any</span><span class="p">):</span>
<a id="__codelineno-0-656" name="__codelineno-0-656"></a>        <span class="k">if</span> <span class="nb">property</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">:</span>
<a id="__codelineno-0-657" name="__codelineno-0-657"></a>            <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="nb">property</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-658" name="__codelineno-0-658"></a>        <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="nb">property</span><span class="p">][</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
<a id="__codelineno-0-659" name="__codelineno-0-659"></a>
<a id="__codelineno-0-660" name="__codelineno-0-660"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">delete_from_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">property</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-661" name="__codelineno-0-661"></a>        <span class="k">if</span> <span class="nb">property</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span> <span class="ow">and</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="nb">property</span><span class="p">]:</span>
<a id="__codelineno-0-662" name="__codelineno-0-662"></a>            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="nb">property</span><span class="p">][</span><span class="n">key</span><span class="p">]</span>
<a id="__codelineno-0-663" name="__codelineno-0-663"></a>
<a id="__codelineno-0-664" name="__codelineno-0-664"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">soft_reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-665" name="__codelineno-0-665"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">previous_reasoning</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-666" name="__codelineno-0-666"></a>
<a id="__codelineno-0-667" name="__codelineno-0-667"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_update_task</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task_dict</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<a id="__codelineno-0-668" name="__codelineno-0-668"></a>        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-669" name="__codelineno-0-669"></a>            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">task_dict</span><span class="p">:</span>
<a id="__codelineno-0-670" name="__codelineno-0-670"></a>                <span class="c1"># If key already exists, append to it</span>
<a id="__codelineno-0-671" name="__codelineno-0-671"></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-672" name="__codelineno-0-672"></a>                    <span class="n">task_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">value</span>
<a id="__codelineno-0-673" name="__codelineno-0-673"></a>                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
<a id="__codelineno-0-674" name="__codelineno-0-674"></a>                    <span class="n">task_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">+=</span> <span class="n">value</span>
<a id="__codelineno-0-675" name="__codelineno-0-675"></a>                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
<a id="__codelineno-0-676" name="__codelineno-0-676"></a>                    <span class="n">task_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<a id="__codelineno-0-677" name="__codelineno-0-677"></a>                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
<a id="__codelineno-0-678" name="__codelineno-0-678"></a>                    <span class="n">task_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<a id="__codelineno-0-679" name="__codelineno-0-679"></a>                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
<a id="__codelineno-0-680" name="__codelineno-0-680"></a>                    <span class="n">task_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
<a id="__codelineno-0-681" name="__codelineno-0-681"></a>            <span class="k">elif</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">task_dict</span><span class="p">:</span>
<a id="__codelineno-0-682" name="__codelineno-0-682"></a>                <span class="c1"># If key does not exist, create it</span>
<a id="__codelineno-0-683" name="__codelineno-0-683"></a>                <span class="n">task_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
<a id="__codelineno-0-684" name="__codelineno-0-684"></a>
<a id="__codelineno-0-685" name="__codelineno-0-685"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">update_tasks_completed</span><span class="p">(</span>
<a id="__codelineno-0-686" name="__codelineno-0-686"></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">prompt</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">task</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">num_trees_completed</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
<a id="__codelineno-0-687" name="__codelineno-0-687"></a>    <span class="p">):</span>
<a id="__codelineno-0-688" name="__codelineno-0-688"></a>        <span class="c1"># search to see if the current prompt already has an entry for this task</span>
<a id="__codelineno-0-689" name="__codelineno-0-689"></a>        <span class="n">prompt_found</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-690" name="__codelineno-0-690"></a>        <span class="n">task_found</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-691" name="__codelineno-0-691"></a>        <span class="n">iteration_found</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-692" name="__codelineno-0-692"></a>
<a id="__codelineno-0-693" name="__codelineno-0-693"></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">task_prompt</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tasks_completed</span><span class="p">):</span>
<a id="__codelineno-0-694" name="__codelineno-0-694"></a>            <span class="k">if</span> <span class="n">task_prompt</span><span class="p">[</span><span class="s2">&quot;prompt&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">prompt</span><span class="p">:</span>
<a id="__codelineno-0-695" name="__codelineno-0-695"></a>                <span class="n">prompt_found</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-696" name="__codelineno-0-696"></a>                <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">task_j</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">task_prompt</span><span class="p">[</span><span class="s2">&quot;task&quot;</span><span class="p">]):</span>
<a id="__codelineno-0-697" name="__codelineno-0-697"></a>                    <span class="k">if</span> <span class="n">task_j</span><span class="p">[</span><span class="s2">&quot;task&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">task</span><span class="p">:</span>
<a id="__codelineno-0-698" name="__codelineno-0-698"></a>                        <span class="n">task_found</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-699" name="__codelineno-0-699"></a>                        <span class="n">task_i</span> <span class="o">=</span> <span class="n">j</span>  <span class="c1"># position of the task in the prompt</span>
<a id="__codelineno-0-700" name="__codelineno-0-700"></a>
<a id="__codelineno-0-701" name="__codelineno-0-701"></a>                    <span class="k">if</span> <span class="n">task_j</span><span class="p">[</span><span class="s2">&quot;iteration&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">num_trees_completed</span><span class="p">:</span>
<a id="__codelineno-0-702" name="__codelineno-0-702"></a>                        <span class="n">iteration_found</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-703" name="__codelineno-0-703"></a>
<a id="__codelineno-0-704" name="__codelineno-0-704"></a>        <span class="c1"># If the prompt is not found, add it to the list</span>
<a id="__codelineno-0-705" name="__codelineno-0-705"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">prompt_found</span><span class="p">:</span>
<a id="__codelineno-0-706" name="__codelineno-0-706"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">tasks_completed</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;prompt&quot;</span><span class="p">:</span> <span class="n">prompt</span><span class="p">,</span> <span class="s2">&quot;task&quot;</span><span class="p">:</span> <span class="p">[{}]})</span>
<a id="__codelineno-0-707" name="__codelineno-0-707"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">tasks_completed</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;task&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;task&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">task</span>
<a id="__codelineno-0-708" name="__codelineno-0-708"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">tasks_completed</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;task&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;iteration&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">num_trees_completed</span>
<a id="__codelineno-0-709" name="__codelineno-0-709"></a>            <span class="k">for</span> <span class="n">kwarg</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
<a id="__codelineno-0-710" name="__codelineno-0-710"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_update_task</span><span class="p">(</span>
<a id="__codelineno-0-711" name="__codelineno-0-711"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">tasks_completed</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;task&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">kwarg</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">kwarg</span><span class="p">]</span>
<a id="__codelineno-0-712" name="__codelineno-0-712"></a>                <span class="p">)</span>
<a id="__codelineno-0-713" name="__codelineno-0-713"></a>            <span class="k">return</span>
<a id="__codelineno-0-714" name="__codelineno-0-714"></a>
<a id="__codelineno-0-715" name="__codelineno-0-715"></a>        <span class="c1"># If the prompt is found but the task is not, add it to the list</span>
<a id="__codelineno-0-716" name="__codelineno-0-716"></a>        <span class="k">if</span> <span class="n">prompt_found</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">task_found</span><span class="p">:</span>
<a id="__codelineno-0-717" name="__codelineno-0-717"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">tasks_completed</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;task&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">({})</span>
<a id="__codelineno-0-718" name="__codelineno-0-718"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">tasks_completed</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;task&quot;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;task&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">task</span>
<a id="__codelineno-0-719" name="__codelineno-0-719"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">tasks_completed</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;task&quot;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;iteration&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">num_trees_completed</span>
<a id="__codelineno-0-720" name="__codelineno-0-720"></a>            <span class="k">for</span> <span class="n">kwarg</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
<a id="__codelineno-0-721" name="__codelineno-0-721"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_update_task</span><span class="p">(</span>
<a id="__codelineno-0-722" name="__codelineno-0-722"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">tasks_completed</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;task&quot;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">kwarg</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">kwarg</span><span class="p">]</span>
<a id="__codelineno-0-723" name="__codelineno-0-723"></a>                <span class="p">)</span>
<a id="__codelineno-0-724" name="__codelineno-0-724"></a>            <span class="k">return</span>
<a id="__codelineno-0-725" name="__codelineno-0-725"></a>
<a id="__codelineno-0-726" name="__codelineno-0-726"></a>        <span class="c1"># task already exists in this query, but the iteration is new</span>
<a id="__codelineno-0-727" name="__codelineno-0-727"></a>        <span class="k">if</span> <span class="n">prompt_found</span> <span class="ow">and</span> <span class="n">task_found</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">iteration_found</span><span class="p">:</span>
<a id="__codelineno-0-728" name="__codelineno-0-728"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">tasks_completed</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;task&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">({})</span>
<a id="__codelineno-0-729" name="__codelineno-0-729"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">tasks_completed</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;task&quot;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;task&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">task</span>
<a id="__codelineno-0-730" name="__codelineno-0-730"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">tasks_completed</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;task&quot;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;iteration&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">num_trees_completed</span>
<a id="__codelineno-0-731" name="__codelineno-0-731"></a>            <span class="k">for</span> <span class="n">kwarg</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
<a id="__codelineno-0-732" name="__codelineno-0-732"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_update_task</span><span class="p">(</span>
<a id="__codelineno-0-733" name="__codelineno-0-733"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">tasks_completed</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;task&quot;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">kwarg</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">kwarg</span><span class="p">]</span>
<a id="__codelineno-0-734" name="__codelineno-0-734"></a>                <span class="p">)</span>
<a id="__codelineno-0-735" name="__codelineno-0-735"></a>            <span class="k">return</span>
<a id="__codelineno-0-736" name="__codelineno-0-736"></a>
<a id="__codelineno-0-737" name="__codelineno-0-737"></a>        <span class="c1"># If the prompt is found and the task is found, update the task</span>
<a id="__codelineno-0-738" name="__codelineno-0-738"></a>        <span class="k">if</span> <span class="n">prompt_found</span> <span class="ow">and</span> <span class="n">task_found</span><span class="p">:</span>
<a id="__codelineno-0-739" name="__codelineno-0-739"></a>            <span class="k">for</span> <span class="n">kwarg</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
<a id="__codelineno-0-740" name="__codelineno-0-740"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_update_task</span><span class="p">(</span>
<a id="__codelineno-0-741" name="__codelineno-0-741"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">tasks_completed</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;task&quot;</span><span class="p">][</span><span class="n">task_i</span><span class="p">],</span> <span class="n">kwarg</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">kwarg</span><span class="p">]</span>
<a id="__codelineno-0-742" name="__codelineno-0-742"></a>                <span class="p">)</span>
<a id="__codelineno-0-743" name="__codelineno-0-743"></a>
<a id="__codelineno-0-744" name="__codelineno-0-744"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_current_task</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-745" name="__codelineno-0-745"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current_task</span> <span class="o">=</span> <span class="n">task</span>
<a id="__codelineno-0-746" name="__codelineno-0-746"></a>
<a id="__codelineno-0-747" name="__codelineno-0-747"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_errors</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-748" name="__codelineno-0-748"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_task</span> <span class="o">==</span> <span class="s2">&quot;elysia_decision_node&quot;</span><span class="p">:</span>
<a id="__codelineno-0-749" name="__codelineno-0-749"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">errors</span>
<a id="__codelineno-0-750" name="__codelineno-0-750"></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_task</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_task</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="p">:</span>
<a id="__codelineno-0-751" name="__codelineno-0-751"></a>            <span class="k">return</span> <span class="p">[]</span>
<a id="__codelineno-0-752" name="__codelineno-0-752"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-753" name="__codelineno-0-753"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">current_task</span><span class="p">]</span>
<a id="__codelineno-0-754" name="__codelineno-0-754"></a>
<a id="__codelineno-0-755" name="__codelineno-0-755"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">clear_error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-756" name="__codelineno-0-756"></a>        <span class="k">if</span> <span class="n">task</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="p">:</span>
<a id="__codelineno-0-757" name="__codelineno-0-757"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="p">[</span><span class="n">task</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-758" name="__codelineno-0-758"></a>
<a id="__codelineno-0-759" name="__codelineno-0-759"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">tasks_completed_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-760" name="__codelineno-0-760"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-761" name="__codelineno-0-761"></a><span class="sd">        Output a nicely formatted string of the tasks completed so far, designed to be used in the LLM prompt.</span>
<a id="__codelineno-0-762" name="__codelineno-0-762"></a><span class="sd">        This is where the outputs of the `llm_message` fields are displayed.</span>
<a id="__codelineno-0-763" name="__codelineno-0-763"></a><span class="sd">        You can use this if you are interfacing with LLMs in tools, to help it understand the context of the tasks completed so far.</span>
<a id="__codelineno-0-764" name="__codelineno-0-764"></a>
<a id="__codelineno-0-765" name="__codelineno-0-765"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-766" name="__codelineno-0-766"></a><span class="sd">            (str): A separated and formatted string of the tasks completed so far in an LLM-parseable format.</span>
<a id="__codelineno-0-767" name="__codelineno-0-767"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-768" name="__codelineno-0-768"></a>        <span class="n">out</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-0-769" name="__codelineno-0-769"></a>        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">task_prompt</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tasks_completed</span><span class="p">):</span>
<a id="__codelineno-0-770" name="__codelineno-0-770"></a>            <span class="n">out</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;&lt;prompt_</span><span class="si">{</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-771" name="__codelineno-0-771"></a>            <span class="n">out</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;Prompt: </span><span class="si">{</span><span class="n">task_prompt</span><span class="p">[</span><span class="s1">&#39;prompt&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-772" name="__codelineno-0-772"></a>
<a id="__codelineno-0-773" name="__codelineno-0-773"></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">task</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">task_prompt</span><span class="p">[</span><span class="s2">&quot;task&quot;</span><span class="p">]):</span>
<a id="__codelineno-0-774" name="__codelineno-0-774"></a>                <span class="n">out</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;&lt;task_</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-775" name="__codelineno-0-775"></a>
<a id="__codelineno-0-776" name="__codelineno-0-776"></a>                <span class="k">if</span> <span class="s2">&quot;action&quot;</span> <span class="ow">in</span> <span class="n">task</span> <span class="ow">and</span> <span class="n">task</span><span class="p">[</span><span class="s2">&quot;action&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-777" name="__codelineno-0-777"></a>                    <span class="n">out</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;Chosen action: </span><span class="si">{</span><span class="n">task</span><span class="p">[</span><span class="s1">&#39;task&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> (this does not mean it has been completed, only that it was chosen) &quot;</span>
<a id="__codelineno-0-778" name="__codelineno-0-778"></a>                    <span class="n">out</span> <span class="o">+=</span> <span class="s2">&quot;(Use the environment to judge if a task is completed)&quot;</span>
<a id="__codelineno-0-779" name="__codelineno-0-779"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-780" name="__codelineno-0-780"></a>                    <span class="n">out</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;Chosen subcategory: </span><span class="si">{</span><span class="n">task</span><span class="p">[</span><span class="s1">&#39;task&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> (this action has not been completed, this is only a subcategory)&quot;</span>
<a id="__codelineno-0-781" name="__codelineno-0-781"></a>
<a id="__codelineno-0-782" name="__codelineno-0-782"></a>                <span class="k">if</span> <span class="s2">&quot;error&quot;</span> <span class="ow">in</span> <span class="n">task</span> <span class="ow">and</span> <span class="n">task</span><span class="p">[</span><span class="s2">&quot;error&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-783" name="__codelineno-0-783"></a>                    <span class="n">out</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; (There was an error during this tool call)</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-784" name="__codelineno-0-784"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-785" name="__codelineno-0-785"></a>                    <span class="n">out</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; (Successfully completed)</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-786" name="__codelineno-0-786"></a>
<a id="__codelineno-0-787" name="__codelineno-0-787"></a>                <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">task</span><span class="p">:</span>
<a id="__codelineno-0-788" name="__codelineno-0-788"></a>                    <span class="k">if</span> <span class="n">key</span> <span class="o">!=</span> <span class="s2">&quot;task&quot;</span> <span class="ow">and</span> <span class="n">key</span> <span class="o">!=</span> <span class="s2">&quot;action&quot;</span><span class="p">:</span>
<a id="__codelineno-0-789" name="__codelineno-0-789"></a>                        <span class="n">out</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">task</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-790" name="__codelineno-0-790"></a>
<a id="__codelineno-0-791" name="__codelineno-0-791"></a>                <span class="n">out</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;&lt;/task_</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-792" name="__codelineno-0-792"></a>            <span class="n">out</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;&lt;/prompt_</span><span class="si">{</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-793" name="__codelineno-0-793"></a>
<a id="__codelineno-0-794" name="__codelineno-0-794"></a>        <span class="k">return</span> <span class="n">out</span>
<a id="__codelineno-0-795" name="__codelineno-0-795"></a>
<a id="__codelineno-0-796" name="__codelineno-0-796"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">set_collection_names</span><span class="p">(</span>
<a id="__codelineno-0-797" name="__codelineno-0-797"></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">collection_names</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">client_manager</span><span class="p">:</span> <span class="n">ClientManager</span>
<a id="__codelineno-0-798" name="__codelineno-0-798"></a>    <span class="p">):</span>
<a id="__codelineno-0-799" name="__codelineno-0-799"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">collection_names</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">collection_data</span><span class="o">.</span><span class="n">set_collection_names</span><span class="p">(</span>
<a id="__codelineno-0-800" name="__codelineno-0-800"></a>            <span class="n">collection_names</span><span class="p">,</span> <span class="n">client_manager</span>
<a id="__codelineno-0-801" name="__codelineno-0-801"></a>        <span class="p">)</span>
<a id="__codelineno-0-802" name="__codelineno-0-802"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">collection_names</span>
<a id="__codelineno-0-803" name="__codelineno-0-803"></a>
<a id="__codelineno-0-804" name="__codelineno-0-804"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">tree_count_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-805" name="__codelineno-0-805"></a>        <span class="n">out</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">num_trees_completed</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">recursion_limit</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-806" name="__codelineno-0-806"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_trees_completed</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">recursion_limit</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-807" name="__codelineno-0-807"></a>            <span class="n">out</span> <span class="o">+=</span> <span class="s2">&quot; (this is the last decision you can make before being cut off)&quot;</span>
<a id="__codelineno-0-808" name="__codelineno-0-808"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_trees_completed</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">recursion_limit</span><span class="p">:</span>
<a id="__codelineno-0-809" name="__codelineno-0-809"></a>            <span class="n">out</span> <span class="o">+=</span> <span class="s2">&quot; (recursion limit reached, write your full chat response accordingly - the decision process has been cut short, and it is likely the user&#39;s question has not been fully answered and you either haven&#39;t been able to do it or it was impossible)&quot;</span>
<a id="__codelineno-0-810" name="__codelineno-0-810"></a>        <span class="k">return</span> <span class="n">out</span>
<a id="__codelineno-0-811" name="__codelineno-0-811"></a>
<a id="__codelineno-0-812" name="__codelineno-0-812"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">output_collection_metadata</span><span class="p">(</span>
<a id="__codelineno-0-813" name="__codelineno-0-813"></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">collection_names</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">with_mappings</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-814" name="__codelineno-0-814"></a>    <span class="p">):</span>
<a id="__codelineno-0-815" name="__codelineno-0-815"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-816" name="__codelineno-0-816"></a><span class="sd">        Outputs the full metadata for the given collection names.</span>
<a id="__codelineno-0-817" name="__codelineno-0-817"></a>
<a id="__codelineno-0-818" name="__codelineno-0-818"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-819" name="__codelineno-0-819"></a><span class="sd">            with_mappings (bool): Whether to output the mappings for the collections as well as the other metadata.</span>
<a id="__codelineno-0-820" name="__codelineno-0-820"></a>
<a id="__codelineno-0-821" name="__codelineno-0-821"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-822" name="__codelineno-0-822"></a><span class="sd">            dict (dict[str, dict]): A dictionary of collection names to their metadata.</span>
<a id="__codelineno-0-823" name="__codelineno-0-823"></a><span class="sd">                The metadata are of the form:</span>
<a id="__codelineno-0-824" name="__codelineno-0-824"></a><span class="sd">                ```python</span>
<a id="__codelineno-0-825" name="__codelineno-0-825"></a><span class="sd">                {</span>
<a id="__codelineno-0-826" name="__codelineno-0-826"></a><span class="sd">                    # summary statistics of each field in the collection</span>
<a id="__codelineno-0-827" name="__codelineno-0-827"></a><span class="sd">                    &quot;fields&quot;: list = [</span>
<a id="__codelineno-0-828" name="__codelineno-0-828"></a><span class="sd">                        field_name_1: dict = {</span>
<a id="__codelineno-0-829" name="__codelineno-0-829"></a><span class="sd">                            &quot;description&quot;: str,</span>
<a id="__codelineno-0-830" name="__codelineno-0-830"></a><span class="sd">                            &quot;range&quot;: list[float],</span>
<a id="__codelineno-0-831" name="__codelineno-0-831"></a><span class="sd">                            &quot;type&quot;: str,</span>
<a id="__codelineno-0-832" name="__codelineno-0-832"></a><span class="sd">                            &quot;groups&quot;: dict[str, str],</span>
<a id="__codelineno-0-833" name="__codelineno-0-833"></a><span class="sd">                            &quot;mean&quot;: float</span>
<a id="__codelineno-0-834" name="__codelineno-0-834"></a><span class="sd">                        },</span>
<a id="__codelineno-0-835" name="__codelineno-0-835"></a><span class="sd">                        field_name_2: dict = {</span>
<a id="__codelineno-0-836" name="__codelineno-0-836"></a><span class="sd">                            ... # same fields as above</span>
<a id="__codelineno-0-837" name="__codelineno-0-837"></a><span class="sd">                        },</span>
<a id="__codelineno-0-838" name="__codelineno-0-838"></a><span class="sd">                        ...</span>
<a id="__codelineno-0-839" name="__codelineno-0-839"></a><span class="sd">                    ],</span>
<a id="__codelineno-0-840" name="__codelineno-0-840"></a>
<a id="__codelineno-0-841" name="__codelineno-0-841"></a><span class="sd">                    # mapping_1, mapping_2 etc refer to frontend-specific types that the AI has deemed appropriate for this data</span>
<a id="__codelineno-0-842" name="__codelineno-0-842"></a><span class="sd">                    # then the dict is to map the frontend fields to the data fields</span>
<a id="__codelineno-0-843" name="__codelineno-0-843"></a><span class="sd">                    &quot;mappings&quot;: dict = {</span>
<a id="__codelineno-0-844" name="__codelineno-0-844"></a><span class="sd">                        mapping_1: dict = {</span>
<a id="__codelineno-0-845" name="__codelineno-0-845"></a><span class="sd">                            &quot;frontend_field_1&quot;: &quot;data_field_1&quot;,</span>
<a id="__codelineno-0-846" name="__codelineno-0-846"></a><span class="sd">                            &quot;frontend_field_2&quot;: &quot;data_field_2&quot;,</span>
<a id="__codelineno-0-847" name="__codelineno-0-847"></a><span class="sd">                            ...</span>
<a id="__codelineno-0-848" name="__codelineno-0-848"></a><span class="sd">                        },</span>
<a id="__codelineno-0-849" name="__codelineno-0-849"></a><span class="sd">                        mapping_2: dict = {</span>
<a id="__codelineno-0-850" name="__codelineno-0-850"></a><span class="sd">                            ... # same fields as above</span>
<a id="__codelineno-0-851" name="__codelineno-0-851"></a><span class="sd">                        },</span>
<a id="__codelineno-0-852" name="__codelineno-0-852"></a><span class="sd">                        ...,</span>
<a id="__codelineno-0-853" name="__codelineno-0-853"></a><span class="sd">                    },</span>
<a id="__codelineno-0-854" name="__codelineno-0-854"></a>
<a id="__codelineno-0-855" name="__codelineno-0-855"></a><span class="sd">                    # number of items in collection (float but just for consistency)</span>
<a id="__codelineno-0-856" name="__codelineno-0-856"></a><span class="sd">                    &quot;length&quot;: float,</span>
<a id="__codelineno-0-857" name="__codelineno-0-857"></a>
<a id="__codelineno-0-858" name="__codelineno-0-858"></a><span class="sd">                    # AI generated summary of the dataset</span>
<a id="__codelineno-0-859" name="__codelineno-0-859"></a><span class="sd">                    &quot;summary&quot;: str,</span>
<a id="__codelineno-0-860" name="__codelineno-0-860"></a>
<a id="__codelineno-0-861" name="__codelineno-0-861"></a><span class="sd">                    # name of collection</span>
<a id="__codelineno-0-862" name="__codelineno-0-862"></a><span class="sd">                    &quot;name&quot;: str,</span>
<a id="__codelineno-0-863" name="__codelineno-0-863"></a>
<a id="__codelineno-0-864" name="__codelineno-0-864"></a><span class="sd">                    # what named vectors are available and their properties (if any)</span>
<a id="__codelineno-0-865" name="__codelineno-0-865"></a><span class="sd">                    &quot;named_vectors&quot;: list = [</span>
<a id="__codelineno-0-866" name="__codelineno-0-866"></a><span class="sd">                        {</span>
<a id="__codelineno-0-867" name="__codelineno-0-867"></a><span class="sd">                            &quot;name&quot;: str,</span>
<a id="__codelineno-0-868" name="__codelineno-0-868"></a><span class="sd">                            &quot;enabled&quot;: bool,</span>
<a id="__codelineno-0-869" name="__codelineno-0-869"></a><span class="sd">                            &quot;source_properties&quot;: list,</span>
<a id="__codelineno-0-870" name="__codelineno-0-870"></a><span class="sd">                            &quot;description&quot;: str # defaults to empty</span>
<a id="__codelineno-0-871" name="__codelineno-0-871"></a><span class="sd">                        },</span>
<a id="__codelineno-0-872" name="__codelineno-0-872"></a><span class="sd">                        ...</span>
<a id="__codelineno-0-873" name="__codelineno-0-873"></a><span class="sd">                    ],</span>
<a id="__codelineno-0-874" name="__codelineno-0-874"></a>
<a id="__codelineno-0-875" name="__codelineno-0-875"></a><span class="sd">                    # some config settings relevant for queries</span>
<a id="__codelineno-0-876" name="__codelineno-0-876"></a><span class="sd">                    &quot;index_properties&quot;: {</span>
<a id="__codelineno-0-877" name="__codelineno-0-877"></a><span class="sd">                        &quot;isNullIndexed&quot;: bool,</span>
<a id="__codelineno-0-878" name="__codelineno-0-878"></a><span class="sd">                        &quot;isLengthIndexed&quot;: bool,</span>
<a id="__codelineno-0-879" name="__codelineno-0-879"></a><span class="sd">                        &quot;isTimestampIndexed&quot;: bool,</span>
<a id="__codelineno-0-880" name="__codelineno-0-880"></a><span class="sd">                    },</span>
<a id="__codelineno-0-881" name="__codelineno-0-881"></a><span class="sd">                }</span>
<a id="__codelineno-0-882" name="__codelineno-0-882"></a><span class="sd">                ```</span>
<a id="__codelineno-0-883" name="__codelineno-0-883"></a><span class="sd">                If `with_mappings` is `False`, then the mappings are not included.</span>
<a id="__codelineno-0-884" name="__codelineno-0-884"></a><span class="sd">                Each key in the outer level dictionary is a collection name.</span>
<a id="__codelineno-0-885" name="__codelineno-0-885"></a>
<a id="__codelineno-0-886" name="__codelineno-0-886"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-887" name="__codelineno-0-887"></a>
<a id="__codelineno-0-888" name="__codelineno-0-888"></a>        <span class="k">if</span> <span class="n">collection_names</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-889" name="__codelineno-0-889"></a>            <span class="n">collection_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collection_names</span>
<a id="__codelineno-0-890" name="__codelineno-0-890"></a>
<a id="__codelineno-0-891" name="__codelineno-0-891"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">collection_data</span><span class="o">.</span><span class="n">output_full_metadata</span><span class="p">(</span>
<a id="__codelineno-0-892" name="__codelineno-0-892"></a>            <span class="n">collection_names</span><span class="p">,</span> <span class="n">with_mappings</span>
<a id="__codelineno-0-893" name="__codelineno-0-893"></a>        <span class="p">)</span>
<a id="__codelineno-0-894" name="__codelineno-0-894"></a>
<a id="__codelineno-0-895" name="__codelineno-0-895"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">output_collection_return_types</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
<a id="__codelineno-0-896" name="__codelineno-0-896"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-897" name="__codelineno-0-897"></a><span class="sd">        Outputs the return types for the collections in the tree data.</span>
<a id="__codelineno-0-898" name="__codelineno-0-898"></a><span class="sd">        Essentially, this is a list of the keys that can be used to map the objects to the frontend.</span>
<a id="__codelineno-0-899" name="__codelineno-0-899"></a>
<a id="__codelineno-0-900" name="__codelineno-0-900"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-901" name="__codelineno-0-901"></a><span class="sd">            (dict): A dictionary of collection names to their return types.</span>
<a id="__codelineno-0-902" name="__codelineno-0-902"></a><span class="sd">                ```python</span>
<a id="__codelineno-0-903" name="__codelineno-0-903"></a><span class="sd">                {</span>
<a id="__codelineno-0-904" name="__codelineno-0-904"></a><span class="sd">                    collection_name_1: list[str],</span>
<a id="__codelineno-0-905" name="__codelineno-0-905"></a><span class="sd">                    collection_name_2: list[str],</span>
<a id="__codelineno-0-906" name="__codelineno-0-906"></a><span class="sd">                    ...,</span>
<a id="__codelineno-0-907" name="__codelineno-0-907"></a><span class="sd">                }</span>
<a id="__codelineno-0-908" name="__codelineno-0-908"></a><span class="sd">                ```</span>
<a id="__codelineno-0-909" name="__codelineno-0-909"></a><span class="sd">                Each of these lists is a list of the keys that can be used to map the objects to the frontend.</span>
<a id="__codelineno-0-910" name="__codelineno-0-910"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-911" name="__codelineno-0-911"></a>        <span class="n">collection_return_types</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collection_data</span><span class="o">.</span><span class="n">output_mapping_lists</span><span class="p">()</span>
<a id="__codelineno-0-912" name="__codelineno-0-912"></a>        <span class="n">out</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-913" name="__codelineno-0-913"></a>            <span class="n">collection_name</span><span class="p">:</span> <span class="n">collection_return_types</span><span class="p">[</span><span class="n">collection_name</span><span class="p">]</span>
<a id="__codelineno-0-914" name="__codelineno-0-914"></a>            <span class="k">for</span> <span class="n">collection_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">collection_names</span>
<a id="__codelineno-0-915" name="__codelineno-0-915"></a>        <span class="p">}</span>
<a id="__codelineno-0-916" name="__codelineno-0-916"></a>        <span class="k">return</span> <span class="n">out</span>
<a id="__codelineno-0-917" name="__codelineno-0-917"></a>
<a id="__codelineno-0-918" name="__codelineno-0-918"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">to_json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">remove_unserialisable</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<a id="__codelineno-0-919" name="__codelineno-0-919"></a>        <span class="n">out</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-920" name="__codelineno-0-920"></a>            <span class="n">k</span><span class="p">:</span> <span class="n">v</span>
<a id="__codelineno-0-921" name="__codelineno-0-921"></a>            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
<a id="__codelineno-0-922" name="__codelineno-0-922"></a>            <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;collection_data&quot;</span><span class="p">,</span> <span class="s2">&quot;atlas&quot;</span><span class="p">,</span> <span class="s2">&quot;environment&quot;</span><span class="p">,</span> <span class="s2">&quot;settings&quot;</span><span class="p">]</span>
<a id="__codelineno-0-923" name="__codelineno-0-923"></a>        <span class="p">}</span>
<a id="__codelineno-0-924" name="__codelineno-0-924"></a>        <span class="n">out</span><span class="p">[</span><span class="s2">&quot;collection_data&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collection_data</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span>
<a id="__codelineno-0-925" name="__codelineno-0-925"></a>        <span class="n">out</span><span class="p">[</span><span class="s2">&quot;atlas&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atlas</span><span class="o">.</span><span class="n">model_dump</span><span class="p">()</span>
<a id="__codelineno-0-926" name="__codelineno-0-926"></a>        <span class="n">out</span><span class="p">[</span><span class="s2">&quot;environment&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="n">remove_unserialisable</span><span class="p">)</span>
<a id="__codelineno-0-927" name="__codelineno-0-927"></a>        <span class="n">out</span><span class="p">[</span><span class="s2">&quot;settings&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span>
<a id="__codelineno-0-928" name="__codelineno-0-928"></a>        <span class="k">return</span> <span class="n">out</span>
<a id="__codelineno-0-929" name="__codelineno-0-929"></a>
<a id="__codelineno-0-930" name="__codelineno-0-930"></a>    <span class="nd">@classmethod</span>
<a id="__codelineno-0-931" name="__codelineno-0-931"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">from_json</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">json_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
<a id="__codelineno-0-932" name="__codelineno-0-932"></a>        <span class="n">settings</span> <span class="o">=</span> <span class="n">Settings</span><span class="o">.</span><span class="n">from_json</span><span class="p">(</span><span class="n">json_data</span><span class="p">[</span><span class="s2">&quot;settings&quot;</span><span class="p">])</span>
<a id="__codelineno-0-933" name="__codelineno-0-933"></a>        <span class="n">logger</span> <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">logger</span>
<a id="__codelineno-0-934" name="__codelineno-0-934"></a>        <span class="n">collection_data</span> <span class="o">=</span> <span class="n">CollectionData</span><span class="o">.</span><span class="n">from_json</span><span class="p">(</span><span class="n">json_data</span><span class="p">[</span><span class="s2">&quot;collection_data&quot;</span><span class="p">],</span> <span class="n">logger</span><span class="p">)</span>
<a id="__codelineno-0-935" name="__codelineno-0-935"></a>        <span class="n">atlas</span> <span class="o">=</span> <span class="n">Atlas</span><span class="o">.</span><span class="n">model_validate</span><span class="p">(</span><span class="n">json_data</span><span class="p">[</span><span class="s2">&quot;atlas&quot;</span><span class="p">])</span>
<a id="__codelineno-0-936" name="__codelineno-0-936"></a>        <span class="n">environment</span> <span class="o">=</span> <span class="n">Environment</span><span class="o">.</span><span class="n">from_json</span><span class="p">(</span><span class="n">json_data</span><span class="p">[</span><span class="s2">&quot;environment&quot;</span><span class="p">])</span>
<a id="__codelineno-0-937" name="__codelineno-0-937"></a>
<a id="__codelineno-0-938" name="__codelineno-0-938"></a>        <span class="n">tree_data</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span>
<a id="__codelineno-0-939" name="__codelineno-0-939"></a>            <span class="n">collection_data</span><span class="o">=</span><span class="n">collection_data</span><span class="p">,</span>
<a id="__codelineno-0-940" name="__codelineno-0-940"></a>            <span class="n">atlas</span><span class="o">=</span><span class="n">atlas</span><span class="p">,</span>
<a id="__codelineno-0-941" name="__codelineno-0-941"></a>            <span class="n">environment</span><span class="o">=</span><span class="n">environment</span><span class="p">,</span>
<a id="__codelineno-0-942" name="__codelineno-0-942"></a>            <span class="n">settings</span><span class="o">=</span><span class="n">settings</span><span class="p">,</span>
<a id="__codelineno-0-943" name="__codelineno-0-943"></a>        <span class="p">)</span>
<a id="__codelineno-0-944" name="__codelineno-0-944"></a>        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">json_data</span><span class="p">:</span>
<a id="__codelineno-0-945" name="__codelineno-0-945"></a>            <span class="k">if</span> <span class="n">item</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;collection_data&quot;</span><span class="p">,</span> <span class="s2">&quot;atlas&quot;</span><span class="p">,</span> <span class="s2">&quot;environment&quot;</span><span class="p">,</span> <span class="s2">&quot;settings&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-946" name="__codelineno-0-946"></a>                <span class="n">tree_data</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">json_data</span><span class="p">[</span><span class="n">item</span><span class="p">])</span>
<a id="__codelineno-0-947" name="__codelineno-0-947"></a>        <span class="k">return</span> <span class="n">tree_data</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="elysia.tree.objects.TreeData.output_collection_metadata" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">output_collection_metadata</span><span class="p">(</span><span class="n">collection_names</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">with_mappings</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Outputs the full metadata for the given collection names.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>with_mappings</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to output the mappings for the collections as well as the other metadata.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dict</code></td>            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="dict">dict</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary of collection names to their metadata.
The metadata are of the form:
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="p">{</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="c1"># summary statistics of each field in the collection</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="s2">&quot;fields&quot;</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>        <span class="n">field_name_1</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>            <span class="s2">&quot;range&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>            <span class="s2">&quot;groups&quot;</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>            <span class="s2">&quot;mean&quot;</span><span class="p">:</span> <span class="nb">float</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>        <span class="p">},</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>        <span class="n">field_name_2</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>            <span class="o">...</span> <span class="c1"># same fields as above</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>        <span class="p">},</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>        <span class="o">...</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>    <span class="p">],</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>    <span class="c1"># mapping_1, mapping_2 etc refer to frontend-specific types that the AI has deemed appropriate for this data</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>    <span class="c1"># then the dict is to map the frontend fields to the data fields</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>    <span class="s2">&quot;mappings&quot;</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>        <span class="n">mapping_1</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a>            <span class="s2">&quot;frontend_field_1&quot;</span><span class="p">:</span> <span class="s2">&quot;data_field_1&quot;</span><span class="p">,</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a>            <span class="s2">&quot;frontend_field_2&quot;</span><span class="p">:</span> <span class="s2">&quot;data_field_2&quot;</span><span class="p">,</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a>            <span class="o">...</span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a>        <span class="p">},</span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a>        <span class="n">mapping_2</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a>            <span class="o">...</span> <span class="c1"># same fields as above</span>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a>        <span class="p">},</span>
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a>        <span class="o">...</span><span class="p">,</span>
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a>    <span class="p">},</span>
<a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a>
<a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a>    <span class="c1"># number of items in collection (float but just for consistency)</span>
<a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a>    <span class="s2">&quot;length&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<a id="__codelineno-0-33" name="__codelineno-0-33" href="#__codelineno-0-33"></a>
<a id="__codelineno-0-34" name="__codelineno-0-34" href="#__codelineno-0-34"></a>    <span class="c1"># AI generated summary of the dataset</span>
<a id="__codelineno-0-35" name="__codelineno-0-35" href="#__codelineno-0-35"></a>    <span class="s2">&quot;summary&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-36" name="__codelineno-0-36" href="#__codelineno-0-36"></a>
<a id="__codelineno-0-37" name="__codelineno-0-37" href="#__codelineno-0-37"></a>    <span class="c1"># name of collection</span>
<a id="__codelineno-0-38" name="__codelineno-0-38" href="#__codelineno-0-38"></a>    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-39" name="__codelineno-0-39" href="#__codelineno-0-39"></a>
<a id="__codelineno-0-40" name="__codelineno-0-40" href="#__codelineno-0-40"></a>    <span class="c1"># what named vectors are available and their properties (if any)</span>
<a id="__codelineno-0-41" name="__codelineno-0-41" href="#__codelineno-0-41"></a>    <span class="s2">&quot;named_vectors&quot;</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-42" name="__codelineno-0-42" href="#__codelineno-0-42"></a>        <span class="p">{</span>
<a id="__codelineno-0-43" name="__codelineno-0-43" href="#__codelineno-0-43"></a>            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-44" name="__codelineno-0-44" href="#__codelineno-0-44"></a>            <span class="s2">&quot;enabled&quot;</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
<a id="__codelineno-0-45" name="__codelineno-0-45" href="#__codelineno-0-45"></a>            <span class="s2">&quot;source_properties&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
<a id="__codelineno-0-46" name="__codelineno-0-46" href="#__codelineno-0-46"></a>            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="nb">str</span> <span class="c1"># defaults to empty</span>
<a id="__codelineno-0-47" name="__codelineno-0-47" href="#__codelineno-0-47"></a>        <span class="p">},</span>
<a id="__codelineno-0-48" name="__codelineno-0-48" href="#__codelineno-0-48"></a>        <span class="o">...</span>
<a id="__codelineno-0-49" name="__codelineno-0-49" href="#__codelineno-0-49"></a>    <span class="p">],</span>
<a id="__codelineno-0-50" name="__codelineno-0-50" href="#__codelineno-0-50"></a>
<a id="__codelineno-0-51" name="__codelineno-0-51" href="#__codelineno-0-51"></a>    <span class="c1"># some config settings relevant for queries</span>
<a id="__codelineno-0-52" name="__codelineno-0-52" href="#__codelineno-0-52"></a>    <span class="s2">&quot;index_properties&quot;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-0-53" name="__codelineno-0-53" href="#__codelineno-0-53"></a>        <span class="s2">&quot;isNullIndexed&quot;</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
<a id="__codelineno-0-54" name="__codelineno-0-54" href="#__codelineno-0-54"></a>        <span class="s2">&quot;isLengthIndexed&quot;</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
<a id="__codelineno-0-55" name="__codelineno-0-55" href="#__codelineno-0-55"></a>        <span class="s2">&quot;isTimestampIndexed&quot;</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
<a id="__codelineno-0-56" name="__codelineno-0-56" href="#__codelineno-0-56"></a>    <span class="p">},</span>
<a id="__codelineno-0-57" name="__codelineno-0-57" href="#__codelineno-0-57"></a><span class="p">}</span>
</code></pre></div>
If <code>with_mappings</code> is <code>False</code>, then the mappings are not included.
Each key in the outer level dictionary is a collection name.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>elysia/tree/objects.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-812">812</a></span>
<span class="normal"><a href="#__codelineno-0-813">813</a></span>
<span class="normal"><a href="#__codelineno-0-814">814</a></span>
<span class="normal"><a href="#__codelineno-0-815">815</a></span>
<span class="normal"><a href="#__codelineno-0-816">816</a></span>
<span class="normal"><a href="#__codelineno-0-817">817</a></span>
<span class="normal"><a href="#__codelineno-0-818">818</a></span>
<span class="normal"><a href="#__codelineno-0-819">819</a></span>
<span class="normal"><a href="#__codelineno-0-820">820</a></span>
<span class="normal"><a href="#__codelineno-0-821">821</a></span>
<span class="normal"><a href="#__codelineno-0-822">822</a></span>
<span class="normal"><a href="#__codelineno-0-823">823</a></span>
<span class="normal"><a href="#__codelineno-0-824">824</a></span>
<span class="normal"><a href="#__codelineno-0-825">825</a></span>
<span class="normal"><a href="#__codelineno-0-826">826</a></span>
<span class="normal"><a href="#__codelineno-0-827">827</a></span>
<span class="normal"><a href="#__codelineno-0-828">828</a></span>
<span class="normal"><a href="#__codelineno-0-829">829</a></span>
<span class="normal"><a href="#__codelineno-0-830">830</a></span>
<span class="normal"><a href="#__codelineno-0-831">831</a></span>
<span class="normal"><a href="#__codelineno-0-832">832</a></span>
<span class="normal"><a href="#__codelineno-0-833">833</a></span>
<span class="normal"><a href="#__codelineno-0-834">834</a></span>
<span class="normal"><a href="#__codelineno-0-835">835</a></span>
<span class="normal"><a href="#__codelineno-0-836">836</a></span>
<span class="normal"><a href="#__codelineno-0-837">837</a></span>
<span class="normal"><a href="#__codelineno-0-838">838</a></span>
<span class="normal"><a href="#__codelineno-0-839">839</a></span>
<span class="normal"><a href="#__codelineno-0-840">840</a></span>
<span class="normal"><a href="#__codelineno-0-841">841</a></span>
<span class="normal"><a href="#__codelineno-0-842">842</a></span>
<span class="normal"><a href="#__codelineno-0-843">843</a></span>
<span class="normal"><a href="#__codelineno-0-844">844</a></span>
<span class="normal"><a href="#__codelineno-0-845">845</a></span>
<span class="normal"><a href="#__codelineno-0-846">846</a></span>
<span class="normal"><a href="#__codelineno-0-847">847</a></span>
<span class="normal"><a href="#__codelineno-0-848">848</a></span>
<span class="normal"><a href="#__codelineno-0-849">849</a></span>
<span class="normal"><a href="#__codelineno-0-850">850</a></span>
<span class="normal"><a href="#__codelineno-0-851">851</a></span>
<span class="normal"><a href="#__codelineno-0-852">852</a></span>
<span class="normal"><a href="#__codelineno-0-853">853</a></span>
<span class="normal"><a href="#__codelineno-0-854">854</a></span>
<span class="normal"><a href="#__codelineno-0-855">855</a></span>
<span class="normal"><a href="#__codelineno-0-856">856</a></span>
<span class="normal"><a href="#__codelineno-0-857">857</a></span>
<span class="normal"><a href="#__codelineno-0-858">858</a></span>
<span class="normal"><a href="#__codelineno-0-859">859</a></span>
<span class="normal"><a href="#__codelineno-0-860">860</a></span>
<span class="normal"><a href="#__codelineno-0-861">861</a></span>
<span class="normal"><a href="#__codelineno-0-862">862</a></span>
<span class="normal"><a href="#__codelineno-0-863">863</a></span>
<span class="normal"><a href="#__codelineno-0-864">864</a></span>
<span class="normal"><a href="#__codelineno-0-865">865</a></span>
<span class="normal"><a href="#__codelineno-0-866">866</a></span>
<span class="normal"><a href="#__codelineno-0-867">867</a></span>
<span class="normal"><a href="#__codelineno-0-868">868</a></span>
<span class="normal"><a href="#__codelineno-0-869">869</a></span>
<span class="normal"><a href="#__codelineno-0-870">870</a></span>
<span class="normal"><a href="#__codelineno-0-871">871</a></span>
<span class="normal"><a href="#__codelineno-0-872">872</a></span>
<span class="normal"><a href="#__codelineno-0-873">873</a></span>
<span class="normal"><a href="#__codelineno-0-874">874</a></span>
<span class="normal"><a href="#__codelineno-0-875">875</a></span>
<span class="normal"><a href="#__codelineno-0-876">876</a></span>
<span class="normal"><a href="#__codelineno-0-877">877</a></span>
<span class="normal"><a href="#__codelineno-0-878">878</a></span>
<span class="normal"><a href="#__codelineno-0-879">879</a></span>
<span class="normal"><a href="#__codelineno-0-880">880</a></span>
<span class="normal"><a href="#__codelineno-0-881">881</a></span>
<span class="normal"><a href="#__codelineno-0-882">882</a></span>
<span class="normal"><a href="#__codelineno-0-883">883</a></span>
<span class="normal"><a href="#__codelineno-0-884">884</a></span>
<span class="normal"><a href="#__codelineno-0-885">885</a></span>
<span class="normal"><a href="#__codelineno-0-886">886</a></span>
<span class="normal"><a href="#__codelineno-0-887">887</a></span>
<span class="normal"><a href="#__codelineno-0-888">888</a></span>
<span class="normal"><a href="#__codelineno-0-889">889</a></span>
<span class="normal"><a href="#__codelineno-0-890">890</a></span>
<span class="normal"><a href="#__codelineno-0-891">891</a></span>
<span class="normal"><a href="#__codelineno-0-892">892</a></span>
<span class="normal"><a href="#__codelineno-0-893">893</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-812" name="__codelineno-0-812"></a><span class="k">def</span><span class="w"> </span><span class="nf">output_collection_metadata</span><span class="p">(</span>
<a id="__codelineno-0-813" name="__codelineno-0-813"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">collection_names</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">with_mappings</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-814" name="__codelineno-0-814"></a><span class="p">):</span>
<a id="__codelineno-0-815" name="__codelineno-0-815"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-816" name="__codelineno-0-816"></a><span class="sd">    Outputs the full metadata for the given collection names.</span>
<a id="__codelineno-0-817" name="__codelineno-0-817"></a>
<a id="__codelineno-0-818" name="__codelineno-0-818"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-819" name="__codelineno-0-819"></a><span class="sd">        with_mappings (bool): Whether to output the mappings for the collections as well as the other metadata.</span>
<a id="__codelineno-0-820" name="__codelineno-0-820"></a>
<a id="__codelineno-0-821" name="__codelineno-0-821"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-822" name="__codelineno-0-822"></a><span class="sd">        dict (dict[str, dict]): A dictionary of collection names to their metadata.</span>
<a id="__codelineno-0-823" name="__codelineno-0-823"></a><span class="sd">            The metadata are of the form:</span>
<a id="__codelineno-0-824" name="__codelineno-0-824"></a><span class="sd">            ```python</span>
<a id="__codelineno-0-825" name="__codelineno-0-825"></a><span class="sd">            {</span>
<a id="__codelineno-0-826" name="__codelineno-0-826"></a><span class="sd">                # summary statistics of each field in the collection</span>
<a id="__codelineno-0-827" name="__codelineno-0-827"></a><span class="sd">                &quot;fields&quot;: list = [</span>
<a id="__codelineno-0-828" name="__codelineno-0-828"></a><span class="sd">                    field_name_1: dict = {</span>
<a id="__codelineno-0-829" name="__codelineno-0-829"></a><span class="sd">                        &quot;description&quot;: str,</span>
<a id="__codelineno-0-830" name="__codelineno-0-830"></a><span class="sd">                        &quot;range&quot;: list[float],</span>
<a id="__codelineno-0-831" name="__codelineno-0-831"></a><span class="sd">                        &quot;type&quot;: str,</span>
<a id="__codelineno-0-832" name="__codelineno-0-832"></a><span class="sd">                        &quot;groups&quot;: dict[str, str],</span>
<a id="__codelineno-0-833" name="__codelineno-0-833"></a><span class="sd">                        &quot;mean&quot;: float</span>
<a id="__codelineno-0-834" name="__codelineno-0-834"></a><span class="sd">                    },</span>
<a id="__codelineno-0-835" name="__codelineno-0-835"></a><span class="sd">                    field_name_2: dict = {</span>
<a id="__codelineno-0-836" name="__codelineno-0-836"></a><span class="sd">                        ... # same fields as above</span>
<a id="__codelineno-0-837" name="__codelineno-0-837"></a><span class="sd">                    },</span>
<a id="__codelineno-0-838" name="__codelineno-0-838"></a><span class="sd">                    ...</span>
<a id="__codelineno-0-839" name="__codelineno-0-839"></a><span class="sd">                ],</span>
<a id="__codelineno-0-840" name="__codelineno-0-840"></a>
<a id="__codelineno-0-841" name="__codelineno-0-841"></a><span class="sd">                # mapping_1, mapping_2 etc refer to frontend-specific types that the AI has deemed appropriate for this data</span>
<a id="__codelineno-0-842" name="__codelineno-0-842"></a><span class="sd">                # then the dict is to map the frontend fields to the data fields</span>
<a id="__codelineno-0-843" name="__codelineno-0-843"></a><span class="sd">                &quot;mappings&quot;: dict = {</span>
<a id="__codelineno-0-844" name="__codelineno-0-844"></a><span class="sd">                    mapping_1: dict = {</span>
<a id="__codelineno-0-845" name="__codelineno-0-845"></a><span class="sd">                        &quot;frontend_field_1&quot;: &quot;data_field_1&quot;,</span>
<a id="__codelineno-0-846" name="__codelineno-0-846"></a><span class="sd">                        &quot;frontend_field_2&quot;: &quot;data_field_2&quot;,</span>
<a id="__codelineno-0-847" name="__codelineno-0-847"></a><span class="sd">                        ...</span>
<a id="__codelineno-0-848" name="__codelineno-0-848"></a><span class="sd">                    },</span>
<a id="__codelineno-0-849" name="__codelineno-0-849"></a><span class="sd">                    mapping_2: dict = {</span>
<a id="__codelineno-0-850" name="__codelineno-0-850"></a><span class="sd">                        ... # same fields as above</span>
<a id="__codelineno-0-851" name="__codelineno-0-851"></a><span class="sd">                    },</span>
<a id="__codelineno-0-852" name="__codelineno-0-852"></a><span class="sd">                    ...,</span>
<a id="__codelineno-0-853" name="__codelineno-0-853"></a><span class="sd">                },</span>
<a id="__codelineno-0-854" name="__codelineno-0-854"></a>
<a id="__codelineno-0-855" name="__codelineno-0-855"></a><span class="sd">                # number of items in collection (float but just for consistency)</span>
<a id="__codelineno-0-856" name="__codelineno-0-856"></a><span class="sd">                &quot;length&quot;: float,</span>
<a id="__codelineno-0-857" name="__codelineno-0-857"></a>
<a id="__codelineno-0-858" name="__codelineno-0-858"></a><span class="sd">                # AI generated summary of the dataset</span>
<a id="__codelineno-0-859" name="__codelineno-0-859"></a><span class="sd">                &quot;summary&quot;: str,</span>
<a id="__codelineno-0-860" name="__codelineno-0-860"></a>
<a id="__codelineno-0-861" name="__codelineno-0-861"></a><span class="sd">                # name of collection</span>
<a id="__codelineno-0-862" name="__codelineno-0-862"></a><span class="sd">                &quot;name&quot;: str,</span>
<a id="__codelineno-0-863" name="__codelineno-0-863"></a>
<a id="__codelineno-0-864" name="__codelineno-0-864"></a><span class="sd">                # what named vectors are available and their properties (if any)</span>
<a id="__codelineno-0-865" name="__codelineno-0-865"></a><span class="sd">                &quot;named_vectors&quot;: list = [</span>
<a id="__codelineno-0-866" name="__codelineno-0-866"></a><span class="sd">                    {</span>
<a id="__codelineno-0-867" name="__codelineno-0-867"></a><span class="sd">                        &quot;name&quot;: str,</span>
<a id="__codelineno-0-868" name="__codelineno-0-868"></a><span class="sd">                        &quot;enabled&quot;: bool,</span>
<a id="__codelineno-0-869" name="__codelineno-0-869"></a><span class="sd">                        &quot;source_properties&quot;: list,</span>
<a id="__codelineno-0-870" name="__codelineno-0-870"></a><span class="sd">                        &quot;description&quot;: str # defaults to empty</span>
<a id="__codelineno-0-871" name="__codelineno-0-871"></a><span class="sd">                    },</span>
<a id="__codelineno-0-872" name="__codelineno-0-872"></a><span class="sd">                    ...</span>
<a id="__codelineno-0-873" name="__codelineno-0-873"></a><span class="sd">                ],</span>
<a id="__codelineno-0-874" name="__codelineno-0-874"></a>
<a id="__codelineno-0-875" name="__codelineno-0-875"></a><span class="sd">                # some config settings relevant for queries</span>
<a id="__codelineno-0-876" name="__codelineno-0-876"></a><span class="sd">                &quot;index_properties&quot;: {</span>
<a id="__codelineno-0-877" name="__codelineno-0-877"></a><span class="sd">                    &quot;isNullIndexed&quot;: bool,</span>
<a id="__codelineno-0-878" name="__codelineno-0-878"></a><span class="sd">                    &quot;isLengthIndexed&quot;: bool,</span>
<a id="__codelineno-0-879" name="__codelineno-0-879"></a><span class="sd">                    &quot;isTimestampIndexed&quot;: bool,</span>
<a id="__codelineno-0-880" name="__codelineno-0-880"></a><span class="sd">                },</span>
<a id="__codelineno-0-881" name="__codelineno-0-881"></a><span class="sd">            }</span>
<a id="__codelineno-0-882" name="__codelineno-0-882"></a><span class="sd">            ```</span>
<a id="__codelineno-0-883" name="__codelineno-0-883"></a><span class="sd">            If `with_mappings` is `False`, then the mappings are not included.</span>
<a id="__codelineno-0-884" name="__codelineno-0-884"></a><span class="sd">            Each key in the outer level dictionary is a collection name.</span>
<a id="__codelineno-0-885" name="__codelineno-0-885"></a>
<a id="__codelineno-0-886" name="__codelineno-0-886"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-887" name="__codelineno-0-887"></a>
<a id="__codelineno-0-888" name="__codelineno-0-888"></a>    <span class="k">if</span> <span class="n">collection_names</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-889" name="__codelineno-0-889"></a>        <span class="n">collection_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collection_names</span>
<a id="__codelineno-0-890" name="__codelineno-0-890"></a>
<a id="__codelineno-0-891" name="__codelineno-0-891"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">collection_data</span><span class="o">.</span><span class="n">output_full_metadata</span><span class="p">(</span>
<a id="__codelineno-0-892" name="__codelineno-0-892"></a>        <span class="n">collection_names</span><span class="p">,</span> <span class="n">with_mappings</span>
<a id="__codelineno-0-893" name="__codelineno-0-893"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="elysia.tree.objects.TreeData.output_collection_return_types" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">output_collection_return_types</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Outputs the return types for the collections in the tree data.
Essentially, this is a list of the keys that can be used to map the objects to the frontend.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary of collection names to their return types.
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="p">{</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">collection_name_1</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">collection_name_2</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="o">...</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="p">}</span>
</code></pre></div>
Each of these lists is a list of the keys that can be used to map the objects to the frontend.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>elysia/tree/objects.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-895">895</a></span>
<span class="normal"><a href="#__codelineno-0-896">896</a></span>
<span class="normal"><a href="#__codelineno-0-897">897</a></span>
<span class="normal"><a href="#__codelineno-0-898">898</a></span>
<span class="normal"><a href="#__codelineno-0-899">899</a></span>
<span class="normal"><a href="#__codelineno-0-900">900</a></span>
<span class="normal"><a href="#__codelineno-0-901">901</a></span>
<span class="normal"><a href="#__codelineno-0-902">902</a></span>
<span class="normal"><a href="#__codelineno-0-903">903</a></span>
<span class="normal"><a href="#__codelineno-0-904">904</a></span>
<span class="normal"><a href="#__codelineno-0-905">905</a></span>
<span class="normal"><a href="#__codelineno-0-906">906</a></span>
<span class="normal"><a href="#__codelineno-0-907">907</a></span>
<span class="normal"><a href="#__codelineno-0-908">908</a></span>
<span class="normal"><a href="#__codelineno-0-909">909</a></span>
<span class="normal"><a href="#__codelineno-0-910">910</a></span>
<span class="normal"><a href="#__codelineno-0-911">911</a></span>
<span class="normal"><a href="#__codelineno-0-912">912</a></span>
<span class="normal"><a href="#__codelineno-0-913">913</a></span>
<span class="normal"><a href="#__codelineno-0-914">914</a></span>
<span class="normal"><a href="#__codelineno-0-915">915</a></span>
<span class="normal"><a href="#__codelineno-0-916">916</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-895" name="__codelineno-0-895"></a><span class="k">def</span><span class="w"> </span><span class="nf">output_collection_return_types</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
<a id="__codelineno-0-896" name="__codelineno-0-896"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-897" name="__codelineno-0-897"></a><span class="sd">    Outputs the return types for the collections in the tree data.</span>
<a id="__codelineno-0-898" name="__codelineno-0-898"></a><span class="sd">    Essentially, this is a list of the keys that can be used to map the objects to the frontend.</span>
<a id="__codelineno-0-899" name="__codelineno-0-899"></a>
<a id="__codelineno-0-900" name="__codelineno-0-900"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-901" name="__codelineno-0-901"></a><span class="sd">        (dict): A dictionary of collection names to their return types.</span>
<a id="__codelineno-0-902" name="__codelineno-0-902"></a><span class="sd">            ```python</span>
<a id="__codelineno-0-903" name="__codelineno-0-903"></a><span class="sd">            {</span>
<a id="__codelineno-0-904" name="__codelineno-0-904"></a><span class="sd">                collection_name_1: list[str],</span>
<a id="__codelineno-0-905" name="__codelineno-0-905"></a><span class="sd">                collection_name_2: list[str],</span>
<a id="__codelineno-0-906" name="__codelineno-0-906"></a><span class="sd">                ...,</span>
<a id="__codelineno-0-907" name="__codelineno-0-907"></a><span class="sd">            }</span>
<a id="__codelineno-0-908" name="__codelineno-0-908"></a><span class="sd">            ```</span>
<a id="__codelineno-0-909" name="__codelineno-0-909"></a><span class="sd">            Each of these lists is a list of the keys that can be used to map the objects to the frontend.</span>
<a id="__codelineno-0-910" name="__codelineno-0-910"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-911" name="__codelineno-0-911"></a>    <span class="n">collection_return_types</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collection_data</span><span class="o">.</span><span class="n">output_mapping_lists</span><span class="p">()</span>
<a id="__codelineno-0-912" name="__codelineno-0-912"></a>    <span class="n">out</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-913" name="__codelineno-0-913"></a>        <span class="n">collection_name</span><span class="p">:</span> <span class="n">collection_return_types</span><span class="p">[</span><span class="n">collection_name</span><span class="p">]</span>
<a id="__codelineno-0-914" name="__codelineno-0-914"></a>        <span class="k">for</span> <span class="n">collection_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">collection_names</span>
<a id="__codelineno-0-915" name="__codelineno-0-915"></a>    <span class="p">}</span>
<a id="__codelineno-0-916" name="__codelineno-0-916"></a>    <span class="k">return</span> <span class="n">out</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="elysia.tree.objects.TreeData.tasks_completed_string" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">tasks_completed_string</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Output a nicely formatted string of the tasks completed so far, designed to be used in the LLM prompt.
This is where the outputs of the <code>llm_message</code> fields are displayed.
You can use this if you are interfacing with LLMs in tools, to help it understand the context of the tasks completed so far.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A separated and formatted string of the tasks completed so far in an LLM-parseable format.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>elysia/tree/objects.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-759">759</a></span>
<span class="normal"><a href="#__codelineno-0-760">760</a></span>
<span class="normal"><a href="#__codelineno-0-761">761</a></span>
<span class="normal"><a href="#__codelineno-0-762">762</a></span>
<span class="normal"><a href="#__codelineno-0-763">763</a></span>
<span class="normal"><a href="#__codelineno-0-764">764</a></span>
<span class="normal"><a href="#__codelineno-0-765">765</a></span>
<span class="normal"><a href="#__codelineno-0-766">766</a></span>
<span class="normal"><a href="#__codelineno-0-767">767</a></span>
<span class="normal"><a href="#__codelineno-0-768">768</a></span>
<span class="normal"><a href="#__codelineno-0-769">769</a></span>
<span class="normal"><a href="#__codelineno-0-770">770</a></span>
<span class="normal"><a href="#__codelineno-0-771">771</a></span>
<span class="normal"><a href="#__codelineno-0-772">772</a></span>
<span class="normal"><a href="#__codelineno-0-773">773</a></span>
<span class="normal"><a href="#__codelineno-0-774">774</a></span>
<span class="normal"><a href="#__codelineno-0-775">775</a></span>
<span class="normal"><a href="#__codelineno-0-776">776</a></span>
<span class="normal"><a href="#__codelineno-0-777">777</a></span>
<span class="normal"><a href="#__codelineno-0-778">778</a></span>
<span class="normal"><a href="#__codelineno-0-779">779</a></span>
<span class="normal"><a href="#__codelineno-0-780">780</a></span>
<span class="normal"><a href="#__codelineno-0-781">781</a></span>
<span class="normal"><a href="#__codelineno-0-782">782</a></span>
<span class="normal"><a href="#__codelineno-0-783">783</a></span>
<span class="normal"><a href="#__codelineno-0-784">784</a></span>
<span class="normal"><a href="#__codelineno-0-785">785</a></span>
<span class="normal"><a href="#__codelineno-0-786">786</a></span>
<span class="normal"><a href="#__codelineno-0-787">787</a></span>
<span class="normal"><a href="#__codelineno-0-788">788</a></span>
<span class="normal"><a href="#__codelineno-0-789">789</a></span>
<span class="normal"><a href="#__codelineno-0-790">790</a></span>
<span class="normal"><a href="#__codelineno-0-791">791</a></span>
<span class="normal"><a href="#__codelineno-0-792">792</a></span>
<span class="normal"><a href="#__codelineno-0-793">793</a></span>
<span class="normal"><a href="#__codelineno-0-794">794</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-759" name="__codelineno-0-759"></a><span class="k">def</span><span class="w"> </span><span class="nf">tasks_completed_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-760" name="__codelineno-0-760"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-761" name="__codelineno-0-761"></a><span class="sd">    Output a nicely formatted string of the tasks completed so far, designed to be used in the LLM prompt.</span>
<a id="__codelineno-0-762" name="__codelineno-0-762"></a><span class="sd">    This is where the outputs of the `llm_message` fields are displayed.</span>
<a id="__codelineno-0-763" name="__codelineno-0-763"></a><span class="sd">    You can use this if you are interfacing with LLMs in tools, to help it understand the context of the tasks completed so far.</span>
<a id="__codelineno-0-764" name="__codelineno-0-764"></a>
<a id="__codelineno-0-765" name="__codelineno-0-765"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-766" name="__codelineno-0-766"></a><span class="sd">        (str): A separated and formatted string of the tasks completed so far in an LLM-parseable format.</span>
<a id="__codelineno-0-767" name="__codelineno-0-767"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-768" name="__codelineno-0-768"></a>    <span class="n">out</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-0-769" name="__codelineno-0-769"></a>    <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">task_prompt</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tasks_completed</span><span class="p">):</span>
<a id="__codelineno-0-770" name="__codelineno-0-770"></a>        <span class="n">out</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;&lt;prompt_</span><span class="si">{</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-771" name="__codelineno-0-771"></a>        <span class="n">out</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;Prompt: </span><span class="si">{</span><span class="n">task_prompt</span><span class="p">[</span><span class="s1">&#39;prompt&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-772" name="__codelineno-0-772"></a>
<a id="__codelineno-0-773" name="__codelineno-0-773"></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">task</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">task_prompt</span><span class="p">[</span><span class="s2">&quot;task&quot;</span><span class="p">]):</span>
<a id="__codelineno-0-774" name="__codelineno-0-774"></a>            <span class="n">out</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;&lt;task_</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-775" name="__codelineno-0-775"></a>
<a id="__codelineno-0-776" name="__codelineno-0-776"></a>            <span class="k">if</span> <span class="s2">&quot;action&quot;</span> <span class="ow">in</span> <span class="n">task</span> <span class="ow">and</span> <span class="n">task</span><span class="p">[</span><span class="s2">&quot;action&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-777" name="__codelineno-0-777"></a>                <span class="n">out</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;Chosen action: </span><span class="si">{</span><span class="n">task</span><span class="p">[</span><span class="s1">&#39;task&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> (this does not mean it has been completed, only that it was chosen) &quot;</span>
<a id="__codelineno-0-778" name="__codelineno-0-778"></a>                <span class="n">out</span> <span class="o">+=</span> <span class="s2">&quot;(Use the environment to judge if a task is completed)&quot;</span>
<a id="__codelineno-0-779" name="__codelineno-0-779"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-780" name="__codelineno-0-780"></a>                <span class="n">out</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;Chosen subcategory: </span><span class="si">{</span><span class="n">task</span><span class="p">[</span><span class="s1">&#39;task&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> (this action has not been completed, this is only a subcategory)&quot;</span>
<a id="__codelineno-0-781" name="__codelineno-0-781"></a>
<a id="__codelineno-0-782" name="__codelineno-0-782"></a>            <span class="k">if</span> <span class="s2">&quot;error&quot;</span> <span class="ow">in</span> <span class="n">task</span> <span class="ow">and</span> <span class="n">task</span><span class="p">[</span><span class="s2">&quot;error&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-783" name="__codelineno-0-783"></a>                <span class="n">out</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; (There was an error during this tool call)</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-784" name="__codelineno-0-784"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-785" name="__codelineno-0-785"></a>                <span class="n">out</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; (Successfully completed)</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-786" name="__codelineno-0-786"></a>
<a id="__codelineno-0-787" name="__codelineno-0-787"></a>            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">task</span><span class="p">:</span>
<a id="__codelineno-0-788" name="__codelineno-0-788"></a>                <span class="k">if</span> <span class="n">key</span> <span class="o">!=</span> <span class="s2">&quot;task&quot;</span> <span class="ow">and</span> <span class="n">key</span> <span class="o">!=</span> <span class="s2">&quot;action&quot;</span><span class="p">:</span>
<a id="__codelineno-0-789" name="__codelineno-0-789"></a>                    <span class="n">out</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">task</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-790" name="__codelineno-0-790"></a>
<a id="__codelineno-0-791" name="__codelineno-0-791"></a>            <span class="n">out</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;&lt;/task_</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-792" name="__codelineno-0-792"></a>        <span class="n">out</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;&lt;/prompt_</span><span class="si">{</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-793" name="__codelineno-0-793"></a>
<a id="__codelineno-0-794" name="__codelineno-0-794"></a>    <span class="k">return</span> <span class="n">out</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>







  
  






                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/weaviate/elysia" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://github.com/weaviate/elysia-frontend" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://github.com/dannyjameswilliams" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M202.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1M496 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2m-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3m-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://github.com/thomashacker" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M202.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1M496 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2m-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3m-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/in/dannyjameswilliams/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/in/edwardschmuhl/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.sections", "toc.integrate", "navigation.top", "search.suggest", "search.highlight", "content.tabs.link", "content.code.annotation", "content.code.copy"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.92b07e13.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>